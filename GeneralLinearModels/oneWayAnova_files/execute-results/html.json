{
  "hash": "bae3e767171d19e9aa3c3336cd840a28",
  "result": {
    "markdown": "---\ntitle: \"One Way ANOVA (incomplete)\"\nformat: html\neditor: visual\n---\n---\neditor: visual\n---\n\n::: {.callout-note collapse=\"false\"}\n## Course Overview\n\n```{dot}\n//| fig-height: 5\n//| fig-width: 10\ndigraph \"Course Overview\" {\n  rankdir=TB;\n  fontname=\"Helvetica,Arial,sans-serif\"\n\tnode [fontname=\"Helvetica,Arial,sans-serif\"]\n\tedge [fontname=\"Helvetica,Arial,sans-serif\"]\n\tgraph [\n\t\tnewrank = true,\n\t\tnodesep = 0.25,\n\t\tranksep = .5,\n\t\toverlap = false,\n\t\tsplines = curve,\n\t]\n\tnode [\n\t\tfixedsize = false,\n\t\tfillcolor = \"white\",\n\t\tfontsize = 24,\n\t\theight = 1,\n\t\tshape = box,\n\t\tstyle = \"filled,setlinewidth(5)\",\n\t\twidth = 3.75\n\t]\n\tedge [\n\t\tarrowhead = none,\n\t\tarrowsize = 0.5,\n\t\tlabelfontname = \"Ubuntu\",\n\t\tweight = 10,\n\t\tstyle = \"filled,setlinewidth(5)\"\n\t]\n\t\n\tsubgraph system {\n\t  \n\t\tnode [color = \"#006688\"]\n\t\tedge [color = \"#006688\"]\n\t\t\n\t\tancova[\n      label = \"ANCOVA\",\n      fillcolor = \"red\",\n      URL = \"../GeneralLinearModels/ancova.html\"\n    ]\n    between_anova[\n      label = \"One-way ANOVA\",\n      fillcolor = \"orange\",\n      URL = \"../GeneralLinearModels/oneWayAnova.html\"\n    ]\n\t\tbinomial [\n\t\t\tURL = \"../distributions/binomial.html\",\n\t\t\tfixedsize = true,\n\t\t\t# fillcolor = \"#d9e7ee\",\n\t\t\tlabel = \"Binomial Distribution\",\n\t\t]\n\t\tcontingency[\n\t\t  URL = \"../categorical/contingency.html\",\n\t\t\tfixedsize = true,\n\t\t#\tfillcolor = \"orange\",\n\t\t\tlabel = \"Contingency\"\n\t\t]\n\t\tcentral_tendency[\n\t\t  URL = \"../describingData/centralTendency.html\",\n\t\t\tfillcolor = white,\n\t\t\tfixedsize = true,\n\t\t\t#row = func,\n\t\t\tlabel= \"Central Tendency\"\n\t\t]\n\t\t#cooksd[\n\t\t#  label     = \"Cook's D\",\n\t\t#  URL       = \"\",\n\t\t#  fillcolor = red\n\t\t#]\n\t\tcorrelations[\n\t\t  URL = \"../distributions/correlations.html\",\n\t\t\tfixedsize = true,\n\t\t\tfillcolor = \"orange\",\n\t\t\tlabel= \"Correlations\"\n\t\t]\n\t\tdispersion[\n\t\t  URL       = \"../describingData/dispersion.html\",\n\t\t\tlabel     = \"Dispersion\",\n\t\t\t# fillcolor = \"orange\"\n\t\t]\n\t\tfdr[\n      URL = \"../multipleTesting/fdr.html\",\n      label = \"False Discovery Rate\"\n    ]\n\t  fwer[\n\t\t  URL = \"../multipleTesting/fwer.html\",\n\t\t  label = \"Family-Wise Error Rate\"\n    ]\n    fwer_vs_fdr[\n      label = \"FWER vs. FDR\",\n      URL = \"../multipleTesting/fwer_vs_fdr.html\"\n    ]\n    glm[\n      URL       = \"../GeneralLinearModels/generalLinearModels.html\",\n      label     = \"General Linear Models\",\n      fillcolor = \"white\"\n    ]\n    #kurtosis[\n    #  URL       = \"\",\n    #  label     = \"Kurtosis\",\n    #  fillcolor = \"red\"\n    #]\n    mediation[\n      URL = \"\",\n      fillcolor = \"red\",\n      label = \"Mediation\"\n    ]\n    mixed_anova[\n\t\t  label = \"Mixed ANOVA\",\n\t\t  fillcolor = \"orange\",\n\t\t  URL = \"../GeneralLinearModels/mixedAnova.html\",\n\t\t]\n\t\tmultiple_regression[\n\t\t  label     = \"Multiple Regression\",\n\t\t  URL       = \"../regressions/multipleRegressions.html\",\n\t\t  fillcolor = \"orange\"\n\t\t]\n\t\tnormal[\n\t\t  URL = \"../distributions/normal.html\",\n\t\t\tfillcolor = white,\n\t\t\tfixedsize = true,\n\t\t\t#row = func,\n\t\t\tlabel= \"Normal Distribution\"\n\t\t]\n\t\tpartial_correlations[\n\t\t    label =\"Partial Correlations\",\n\t\t    URL = \"../correlations/partialCorrelations.html\",\n\t\t]\n\t\tpermutation[\n\t\t  label = \"Permutations\",\n\t\t  fillcolor = \"white\",\n\t\t  URL = \"permutations.html\",\n\t\t  #width = 15,\n\t\t]\n\t\tprobability [\n\t\t\tlabel = \"Probability\",\n\t\t\tURL = \"../statsBasics/probability.html\",\n      #fillcolor = \"#d9e7ee\",\n\t\t\tfixedsize = true,\n\t\t\t# row = func,\n\t\t]\n\t\trepeated_measures_anova[\n\t\t  label = \"Repeated Measures\",\n\t\t  fillcolor = \"red\",\n\t\t  URL = \"../GeneralLinearModels/repeatedAnova.html\",\n\t\t]\n\t\tsimple_regression[\n\t\t  label=\"Simple Regression\",\n\t\t  URL = \"../regressions/simpleRegressions.html\",\n\t\t]\n\t\tskewness[\n\t\t  label = \"Skewness\",\n\t\t  URL   = \"../distributions/skewness.html\"\n\t\t]\n\t\tstats_basics[\n\t\t  label = \"Statistics Basics\",\n\t\t  URL   = \"../statsBasics/statsBasics.html\"\n\t\t]\n\t\ttransforming [\n\t\t\tfillcolor = \"white\",\n\t\t\tlabel     = \"Transforming Data\",\n\t\t\tURL       = \"../distributions/transforming.html\"\n\t\t\twidth = 4\n\t\t]\n\t\tttests [\n\t\t  label     = \"T-Tests\",\n\t\t  URL       = \"../GeneralLinearModels/TTests.html\",\n\t\t  fillcolor = \"white\"\n\t\t]\n\t}\n\t/* connections */\n\tbetween_anova -> ancova\n\tbinomial -> contingency\n\tbinomial -> normal[\n    #style = \"dashed\",\n    #row = func\n\t]\n\tcentral_tendency -> dispersion\n\t#correlations -> cooksd\n\tcorrelations -> partial_correlations\n\tcorrelations -> simple_regression\n\tdispersion -> normal\n\tfdr -> fwer_vs_fdr\n\tfwer -> fwer_vs_fdr\n\tglm -> ttests\n  mixed_anova -> ancova\n\tmultiple_regression -> mediation\n\tnormal -> correlations\n\tnormal -> contingency\n\tnormal -> glm\n\t#normal -> kurtosis\n\tnormal -> skewness[\n    #style = \"dashed\",\n    #row = func\n\t]\n\tsimple_regression -> multiple_regression\n\tskewness -> transforming\n\ttransforming -> correlations\n\tprobability -> contingency\n\tprobability -> fwer\n\tprobability -> fdr\n\trepeated_measures_anova -> ancova\n\tstats_basics -> central_tendency\n\tstats_basics -> probability\n\tttests -> mixed_anova\n\tttests -> between_anova\n\tttests -> repeated_measures_anova\n\t\n\t\n\t\n  # edge[ style = invis ];\n  ancova -> permutation\n  repeated_measures_anova -> permutation\n  between_anova -> permutation\n  correlations -> permutation\n  #mediation -> permutation  [\n  #  style = \"dashed\",\n    #row = func\n\t#] \n  #multiple_regression -> permutation  [\n  #  style = \"dashed\",\n  #  #row = func\n\t#] \n  #partial_correlations -> permutation\n  #simple_regression -> permutation  [\n  #  style = \"dashed\",\n  #  #row = func\n\t#] \n  ttests -> permutation\n}\n```\n\n[**Red**]{style=\"color:red\"} means that the page does not exist yet\n\n[**Orange**]{style=\"color:orange\"} means that the page is started\n:::\n\n\n\n## One Way ANOVA\n\nThe mathematics behind a one-way ANOVA is actually just an extension of the GLM approach to independent samples t-tests. To illustrate this, we will investigate if there are significant differences in life expectancy between Africa, the Americas and Europe using gapminder data. Let's first focus on the relevant contents in this dataset and then capture the sum of squares around the mean (i.e. the total sum of squares):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gapminder)\ngapminder_2007 <- subset(\n  gapminder,   # the data set\n  year == 2007\n)\n## Automatic calculation\ngapminder_3_continents <- subset(\n  gapminder_2007, \n  continent == \"Europe\" | continent == \"Americas\" | continent == \"Africa\"\n)\ntotal_ss = sum((gapminder_3_continents$lifeExp - mean(gapminder_3_continents$lifeExp))^2)\ntotal_ss\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17477.99\n```\n:::\n:::\n\n\nSo 1.7477987\\times 10^{4} is the all the variance to be explained. The general linear model we will run is to see how much variance is explained by the mean of each continent. The formula for this is:\n\n$$\nSS_{between} = \\sum_{group}{(\\sum_{item}\\bar{x}_{group} - \\mu)^2}\n$$\n\nOr, applied to our current data:\n\n$$\nSS_{between} = \\sum_{continent}{(\\sum_{country}(\\bar{x}_{continent} - \\mu)^2)}\n$$\n\n-   $\\mu$ represents the mean across all countries\n\n-   $\\bar{x}_{group}$ represents the mean of the group\n\n-   Similarly, $\\bar{x}_{continent}$ is the mean across all countries in a continent\n\nIn English, for each country the model predicts that the value will be the mean across its continent. So for Algeria, Angola and Botswana, the model predicts that the life expectancy will be 54.8060385. To capture all the variance that this model captures, we need to compare the predicted values to the group mean. We square these differences to make all the numbers positive so that when we sum then we don't get (close to) zero after all the values above the mean balance out those below the mean. In terms of how this looks manually in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Manual calculation\nss_between = (\n  # SS for mean of Europe compared to the grand mean across all countries\n  ((mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Europe\"])-mean(gapminder_3_continents$lifeExp))^2) * sum(gapminder_3_continents$continent==\"Europe\") +\n  # SS for mean of Americas compared to the grand mean across all countries\n  ((mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Americas\"])-mean(gapminder_3_continents$lifeExp))^2) * sum(gapminder_3_continents$continent==\"Americas\") +\n  # SS for mean of Africa compared to the grand mean across all countries\n  ((mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Africa\"])-mean(gapminder_3_continents$lifeExp))^2) * sum(gapminder_3_continents$continent==\"Africa\") \n)\nss_between\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 12016.81\n```\n:::\n:::\n\n\nSo, let's just confirm that our manual calculation is the same as what a package will give us:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(aov(lifeExp ~ factor(continent), data = gapminder_3_continents))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   Df Sum Sq Mean Sq F value Pr(>F)    \nfactor(continent)   2  12017    6008   114.4 <2e-16 ***\nResiduals         104   5461      53                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nLooks good, the R output is just a rounded version of our manually calculated version. Let's confirm what the effect size for this is next.\n\n##  $R^2$ and $R^2_{adj}$  \n\nThe variance explained by the GLM model is the $R^2$ value, which is:\n\n$$\nR^2 = \\frac{SS_{between}}{SS_{total}}\n$$\n\nIf we manually calculate it we get:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nss_between/total_ss\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6875397\n```\n:::\n:::\n\n\nLet's double check this with a function based calculation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(lifeExp ~ factor(continent), data = gapminder_3_continents))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = lifeExp ~ factor(continent), data = gapminder_3_continents)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-15.193  -3.934  -0.339   3.121  21.636 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                 54.806      1.005   54.54   <2e-16 ***\nfactor(continent)Americas   18.802      1.764   10.66   <2e-16 ***\nfactor(continent)Europe     22.843      1.661   13.75   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.246 on 104 degrees of freedom\nMultiple R-squared:  0.6875,\tAdjusted R-squared:  0.6815 \nF-statistic: 114.4 on 2 and 104 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nLovely. You may have noticed that there is also an **adjusted** **R-Squared** reported. There is a concern that an unadjusted R-Squared doesn't take into account inflation in effect size calculations that happens in samples compared to populations (see [degrees of freedom](../describingData/dispersion.html#degrees-of-freedom) for an explanation of this). To apply degrees of freedom to address this bias, we actually need to reconceptualise the previous formula to focus on the unexplained variance (i.e. error):\n\n$$\nSS_{between} = SS_{total}-SS_{error}\n$$\n\nThis means that we can reconstruct the above formula:\n\n$$\nR^2 = \\frac{SS_{between}}{SS_{total}} = \\frac{SS_{total}-SS_{error}}{SS_{total}} = 1 - \\frac{SS_{error}}{SS_{total}}\n$$\n\nThis is helpful because we need to adjust our calculation to increase the weighting of error to counterbalance bias. We do this by applying degrees of freedom to both $SS_{error}$ and $SS_{total}$ , but the adjustment will result in new value for error being proportionately higher than for total:\n\n$$\nR^2_{adj} = 1 - \\frac{SS_{error}/df_{error}}{SS_{total}/df_{total}}\n$$\n\n$$\ndf_{error} = N - 1 - (levels-1)\n$$\n\n$$\ndf_{total} = N-1\n$$\n\nIn fact, the above includes the **Mean Square Error (MSE)** and the **Mean Square Total (MST)**\n\n$$\nMSE = \\frac{SS_{error}}{df_{error}} = \\frac{SS_{error}}{N-1-(levels-1)}\n$$\n\n$$\nMST = \\frac{SS_{total}}{df_{total}} = \\frac{SS_{total}}{N-1}\n$$\n\nSo another way you can think of this is:\n\n$$\nR^2_{adj} = 1 - \\frac{SS_{error}/df_{error}}{SS_{total}/df_{total}} = \\frac{MSE}{MST}\n$$\n\nLet's see what we get when we calculate this manually\n\n\n::: {.cell}\n\n```{.r .cell-code}\nerror_ss = total_ss-ss_between\nmse =  error_ss/(\n  dim(gapminder_3_continents)[1] - # N\n    (3-1)                        - # levels - 1\n    1\n)\nmst = total_ss/(\n  dim(gapminder_3_continents)[1] - # N\n    1\n )\n\n1-(mse/mst)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6815309\n```\n:::\n:::\n\n\nSo is this value the same as you get when using a function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthis_summary = summary(lm(lifeExp ~ factor(continent), data = gapminder_3_continents))\nthis_summary$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6815309\n```\n:::\n:::\n\n\n##  Eta-Squared ($\\eta^2$) \n\nEta-squared ( $\\eta^2$ ) is actually the same as $R^2$, but is the terminology associated with ANOVAs rather than linear models. Let's confirm with a function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsr::etaSquared(lm(lifeExp ~ factor(continent), data = gapminder_3_continents))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                     eta.sq eta.sq.part\nfactor(continent) 0.6875397   0.6875397\n```\n:::\n:::\n\n\n## P-value calculation\n\nTo calculate the p-value we need to calculate the F-value and then compare it to an f-distribution. The F-value is basically the sum of squares of what can be explained divided by the sum of squares of what cannot be explained:\n\n$$\nF = \\frac{SS_{between}}{SS_{error}}\n$$\n\nIn our case, this is:\n\n\n::: {.cell}\n\n:::\n\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntotalSS = sum((gapminder_3_continents$lifeExp - mean(gapminder_3_continents$lifeExp))^2)\n\nshortcut_ss_within = totalSS - ss_between\n\nss_within_long = sum(\n  (gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Europe\"]-mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Europe\"]))^2,\n  (gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Americas\"]-mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Americas\"]))^2,\n  (gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Africa\"]-mean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Africa\"]))^2\n)\n\n(ss_between/2)/(ss_within_long/(length(gapminder_3_continents$lifeExp)-3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 114.4212\n```\n:::\n:::\n\n\n## Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\ngapminder_3_continents['continent'] = gapminder_3_continents['continent'].astype('category')\nmodel3 = ols('lifeExp ~ continent', data = gapminder_3_continents).fit()\naov_table3 = sm.stats.anova_lm(model3, typ=2)\naov_table3\n\nss_between = (gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Europe\"].mean() - gapminder_3_continents['lifeExp'].mean())**2 * sum(gapminder_3_continents['continent']==\"Europe\")+(gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Americas\"].mean() - gapminder_3_continents['lifeExp'].mean())**2 * sum(gapminder_3_continents['continent']==\"Americas\")+(gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Africa\"].mean() - gapminder_3_continents['lifeExp'].mean())**2 * sum(gapminder_3_continents['continent']==\"Africa\")\n\ntotalSS = sum((gapminder_3_continents['lifeExp'] - gapminder_3_continents['lifeExp'].mean())**2)\n\nwithin1_all=(gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Europe\"]-gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Europe\"].mean())**2\nwithin1= sum(within1_all)\n\nwithin2_all=(gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Americas\"]-gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Americas\"].mean())**2\nwithin2= sum(within2_all)\n\nwithin3_all=(gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Africa\"]-gapminder_3_continents['lifeExp'][gapminder_3_continents['continent']==\"Africa\"].mean())**2\nwithin3= sum(within3_all)\n\nss_within_long = within1 + within2 + within3\n\n(ss_between/2)/(ss_within_long/(len(gapminder_3_continents['lifeExp'])-3))\n```\n:::\n\n\n```         \n114.42116407168957\n```\n:::\n\nTo visualise this\n\n::: panel-tabset\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlm_3_continents <- summary(lm(lifeExp ~ factor(continent), data = gapminder_3_continents))\nlm_3_continents$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                          Estimate Std. Error  t value     Pr(>|t|)\n(Intercept)               54.80604   1.004904 54.53856 2.466786e-78\nfactor(continent)Americas 18.80208   1.763600 10.66119 2.243512e-18\nfactor(continent)Europe   22.84256   1.661388 13.74908 3.900175e-25\n```\n:::\n\n```{.r .cell-code}\nmean(gapminder_3_continents$lifeExp[gapminder_3_continents$continent==\"Europe\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 77.6486\n```\n:::\n\n```{.r .cell-code}\ngapminder_3_continents$continent_mean = lm_3_continents$coefficients[1,1] # intercept, which is mean for Africa as there are only \"Americas\" and \"Europe\" factors.\ngapminder_3_continents$continent_mean[gapminder_3_continents$continent == \"Americas\"] = gapminder_3_continents$continent_mean[gapminder_3_continents$continent == \"Americas\"] + lm_3_continents$coefficients[2,1]\n\ngapminder_3_continents$continent_mean[gapminder_3_continents$continent == \"Europe\"] = gapminder_3_continents$continent_mean[gapminder_3_continents$continent == \"Europe\"] + lm_3_continents$coefficients[3,1]\n\n\n\nggplot(gapminder_3_continents, aes(x = continent, y = lifeExp)) +\n  geom_segment(\n    position = \"jitter\",\n    #arrow = arrow(length = unit(0.01, \"npc\"),ends = \"first\"),\n    aes(\n      xend = continent,\n      yend = continent_mean,\n      color = \"resid\"\n    )\n  ) + \n  geom_segment(aes(\n    x = 0.55, \n    xend = 1.45, \n    y = lm_3_continents$coefficients[1,1],\n    yend = lm_3_continents$coefficients[1,1]),\n    color = \"blue\"\n  ) + \n  geom_segment(aes(\n    x = 1.55, \n    xend = 2.45, \n    y = lm_3_continents$coefficients[2,1] + lm_3_continents$coefficients[1,1],\n    yend = lm_3_continents$coefficients[2,1] + lm_3_continents$coefficients[1,1]),\n    color = \"blue\"\n  ) + \n  geom_segment(aes(\n    x = 2.55, \n    xend = 3.45, \n    y = lm_3_continents$coefficients[3,1] + lm_3_continents$coefficients[1,1],\n    yend = lm_3_continents$coefficients[3,1] + lm_3_continents$coefficients[1,1]),\n    color = \"blue\"\n  ) +\n  geom_segment(\n    aes(\n      x = 0.55,\n      xend = 3.45,\n      y = mean(gapminder_3_continents$lifeExp),\n      yend = mean(gapminder_3_continents$lifeExp),\n      color = \"Overall Mean\"\n    )\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Use of `gapminder_3_continents$lifeExp` is discouraged.\nℹ Use `lifeExp` instead.\nUse of `gapminder_3_continents$lifeExp` is discouraged.\nℹ Use `lifeExp` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](oneWayAnova_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport seaborn as sns\n\nspec = dict(x=\"continent\", y=\"lifeExp\", data=gapminder_3_continents)\nfig, ax = plt.subplots(figsize =(7, 5))\nsns.stripplot(**spec, size=4, palette=\"deep\")\nsns.pointplot(**spec, join=False, ci=0, capsize=.7, scale=0, palette=\"deep\")\nplt.axhline(y=gapminder_3_continents[\"lifeExp\"].mean(), color='red', ls='-')\nplt.show()\n```\n:::\n\n:::\n\n*Fig. XXX.* Our model in the figure above considers the distance from each of the continent's mean to the overall mean as part of the explained variance. For each data point, the squared distance from the the mean line to the overall mean line is part of the sum of squares at the top of the formula.\n",
    "supporting": [
      "oneWayAnova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}