cronbach.alpha(positemspre)
#cronbach's alpha >.7 and <.9
#items have acceptable reliability
##post-test positive items-Cronbach's alpha
positemspost<-dfq1 [ , c("panas2_1","panas2_3", "panas2_5","panas2_9","panas2_10","panas2_12","panas2_14","panas2_16","panas2_17", "panas2_19")]
cronbach.alpha(positemspost)
#cronbach's alpha >.9
#items might be redundant
##cronbach's alpha for both pre and post-tests of positive affect items##
positems<-dfq1 [ , c("panas1_1","panas2_1","panas1_3","panas2_3" ,"panas1_5","panas2_5","panas1_9","panas2_9","panas1_10","panas2_10","panas1_12","panas2_12","panas1_14", "panas2_14","panas1_16", "panas2_16","panas1_17", "panas2_17", "panas1_19","panas2_19")]
library(psych)
psych::alpha(positems)
library(ltm)
cronbach.alpha(positems)
#cronbach's alpha >.7 and <.9
#items have acceptable reliability
corr.test(positemspre,positemspost)
#Question 1.1.b: Cronbach's Alpha for negative affect items of PANAS
##pre-test negative items-Cronbach's alpha
negitemspre<-dfq1 [ , c("panas1_2","panas1_4", "panas1_6","panas1_7","panas1_8","panas1_11","panas1_13","panas1_15", "panas1_18","panas1_20")]
library(psych)
corr.test(negitemspre)
library(ltm)
cronbach.alpha(negitemspre)
#cronbach's alpha >.7 and <.9
#items have acceptable reliability
##post-test negative items-Cronbach's alpha
negitemspost<-dfq1 [ , c("panas2_2","panas2_4", "panas2_6","panas2_7","panas2_8","panas2_11","panas2_13","panas2_15", "panas2_18", "panas2_20")]
cronbach.alpha(negitemspost)
#cronbach's alpha >.7 and <.9
#items have acceptable reliability
##cronbach's alpha for both pre and post-tests of negative affect items##
negitems<-dfq1 [ , c("panas1_2","panas2_2","panas1_4","panas2_4" ,"panas1_6","panas2_6","panas1_7","panas2_7","panas1_8","panas2_8","panas1_11","panas2_11","panas1_13", "panas2_13","panas1_15", "panas2_15","panas1_18", "panas2_18", "panas1_20","panas2_20")]
library(psych)
psych::alpha(negitems)
cronbach.alpha(negitems)
#cronbach's alpha >.7 and <.9
#items have acceptable reliability
psych::alpha(negitems)
cronbach.alpha(negitems)
#Question 1.2: run analyses to address if engaging in exercise changes positive affect
#dependent variable is positive affect, we need overall score for both pre and post test measures
dfq1$postotalpre<-(dfq1$panas1_1+dfq1$panas1_3+dfq1$panas1_5+dfq1$panas1_9+dfq1$panas1_10+dfq1$panas1_12+dfq1$panas1_14+dfq1$panas1_16+dfq1$panas1_17+dfq1$panas1_19)
dfq1$postotalpre
dfq1$postotalpost<-(dfq1$panas2_1+dfq1$panas2_3+dfq1$panas2_5+dfq1$panas2_9+dfq1$panas2_10+dfq1$panas2_12+dfq1$panas2_14+dfq1$panas2_16+dfq1$panas2_17+dfq1$panas2_19)
options (scipen = 999)
dfq1$postotalpost
#ANCOVA will be used, post-test data in control and experimental groups will be compared while controlling for pre-scores.
library(psych)
describeBy(dfq1$postotalpost,dfq1$condition)#descriptive statistics for post-test of both conditions
describeBy(dfq1$postotalpre,dfq1$condition)#descriptive statistics for pre-test of both conditions
#assumptions of ancova-normality
hist(dfq1$postotalpost)
hist(dfq1$postotalpre)
shapiro.test(dfq1$postotalpost)#p value is <.05, indicating that the data is not normally distributed.
shapiro.test(dfq1$postotalpre)#p value is >.05, indicating that the data is normally distributed.
#residuals should be normally distributed
shapiro.test(resid(aov(postotalpost ~ condition + postotalpre, data = dfq1)))#p value is <.05, indicating that the residuals are not normally distributed.
library(car)
leveneTest(postotalpost ~ condition, data = dfq1)#p value is >.05, indicating that assumption of homogeneity of variances is met.
#assumption of homogeneity of regression slopes
ancovaregslop<- lm(postotalpost~condition * postotalpre, dfq1)
summary(ancovaregslop)#p value is >.05, indicating that there is not a significant interaction between pre-test score and groups.
#The relationship between the covariate and at each group of the independent variable should be linear:
library(ggplot2)
ggplot(dfq1, aes(postotalpre, postotalpost, colour = condition)) + geom_point(size = 3) +
geom_smooth(method = "lm", aes(fill = condition), alpha = 0.1) + theme(legend.position="top")+theme_classic()
#the data points should lie on the straight line to meet the linearity assumption, which does as can be seen on the plot.
#ANCOVA
ancovaposexercise <- lm(postotalpost~condition + postotalpre, dfq1)
summary(ancovaposexercise)#after controlling for pre-test scores, post scores significantly different between experiment and control group.
figq1.2<-ggplot(dfq1,aes(y=postotalpost, x=condition, fill=condition))+
stat_summary(fun="mean", geom="bar",position="dodge")+
stat_summary(fun.data = mean_se, geom = "errorbar", position="dodge",width=.8)+theme_classic()
print(figq1.2+ labs(y="Wellbeing",x="condition"))
unique(1,1,2,3)
unique(c(1,1,2,3))
length(c(1,1,2,3)[T,T,F,F])
c(1,1,2,3)[T,T,F,F]
c(1,1,2,3)
a = c(1,1,2,3)
a[c(T,T,F,F)]
length(c(1,1,2,3)[c(T,T,F,F)])
View(figq1.2)
data2 <- read.csv("Documents/UoR/2022-2023/PYM0S2/Assessment/Q2_data.csv")
View(data2)
##Question 2: Effects of age on wellbeing and health
#Q.2.1: examine whether levels of individuals’ wellbeing are different depending on their age.We have 4 age groups and a continuous dependent variable, therefore we will use ANOVA.
dfq2<-read.csv(file = "Q2_data.csv", header = TRUE)
dfq2 <- data2
#overall well-being
dfq2$welltotal<- (dfq2$MCZ_1+dfq2$MCZ_2+dfq2$MCZ_8+dfq2$MCZ_10+dfq2$MCZ_17)
dfq2$welltotal
#dependent variable should be numeric and independent variable should be factor for ANOVA
class(dfq2$welltotal)
dfq2$welltotal<-as.numeric(dfq2$welltotal)
class(dfq2$welltotal)
dfq2$Age<-as.factor(dfq2$Age)
class(dfq2$Age)
#descriptive statistics for each group
library(psych)
describeBy(dfq2$welltotal,dfq2$Age)
describeBy(dfq2$welltotal, dfq2$RSEX)
#removing the outliers:
abs(dfq2$welltotal-mean(dfq2$welltotal))#absolute distance of all data points to mean
welltotal_outliers <- abs(dfq2$welltotal-mean(dfq2$welltotal)) > 3 * sd(dfq2$welltotal)
valid_rows = !welltotal_outliers
valid_rows
dfq2_reduced<-dfq2[valid_rows, ]
dfq2_reduced
plot(dfq2_reduced$welltotal)
describeBy(dfq2_reduced$welltotal, dfq2_reduced$RSEX)#to see how many participants we excluded from each gender.
#checking the assumptions of normality
#analysing residuals for normality assumption, drawing linear model
modelwell  <- lm(welltotal ~ Age, data = dfq2_reduced)
#shapiro test for checking if the residuals are normally distributed.
shapiro.test(residuals(modelwell))#normality assumption for residuals is violated, p<.05
hist(dfq2_reduced$welltotal)
shapiro.test(dfq2_reduced$welltotal)#data is not normally distributed.
#residuals should be normally distributed, alternatively can be checked through following code as well as the one above:
shapiro.test(resid(aov(welltotal ~ Age, data = dfq2_reduced)))
#for the assumption of homogeneity of the variances, as the distribution is not normal, we use Levene test.
library(car)
leveneTest(welltotal ~ Age, data = dfq2_reduced)#p<.05, assumption of homogeneity of variances is violated.
#running ANOVA
anova_well<-aov(welltotal~Age,dfq2_reduced)
summary(anova_well)#p<.05, wellbeing score of age groups are significantly different from each other. We do not know where exactly this difference exist, therefore we need posthoc tests.
pairwise.t.test(dfq2_reduced$welltotal, dfq2_reduced$Age, p.adjust.method = "bonf", paired=FALSE)
#alternatively, we can use regression approach which gives use the same results with significance values between groups and we will now create figures to better present data.
reg_welltotal <- lm(welltotal~Age, dfq2_reduced)
summary(reg_welltotal)
#obtain the means
mean1_16<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"])
mean1_16
mean2_25<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"])
mean3_45<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"])
mean3_45
mean4_65<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"])
mean4_65
all_means_q2<-c(mean1_16, mean2_25, mean3_45, mean4_65)
all_means_q2
#number of participants in each group
n1_16 <- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"])
n2_25 <- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"])
n3_45<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"])
n4_65 <- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"])
#standard deviation of each group
sd1_16 <- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"])
sd1_16
sd2_25 <- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"])
sd3_45 <- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"])
sd3_45
sd4_65 <- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"])
sd4_65
#standard errors
se1_16<-sd1_16/sqrt(n1_16)
se2_25<-sd2_25/sqrt(n2_25)
se3_45<-sd3_45/sqrt(n3_45)
se4_65<-sd4_65/sqrt(n4_65)
all_se_q2<-c(se1_16,se2_25,se3_45,se4_65)
all_se_q2
fig.frame_q2<-data.frame(all_means_q2,all_se_q2)
fig.frame_q2$name[1]<-"16 to 24"
fig.frame_q2$name[2]<-"25 to 44"
fig.frame_q2$name[3]<-"45 to 65"
fig.frame_q2$name[4]<-"65 and over"
head(fig.frame_q2)
library(ggplot2)
fig_q2<-ggplot(fig.frame_q2,aes(x=name,y=all_means_q2))+geom_point(size=6)
print(fig_q2)
fig2_q2<-ggplot(fig.frame_q2,aes(x=name,y=all_means_q2))+geom_point(size=6) +geom_errorbar(aes(ymin=all_means_q2-all_se_q2,ymax=all_means_q2+all_se_q2))+theme_classic()
print(fig2_q2)
#running ANOVA
anova_well<-aov(welltotal~Age,dfq2_reduced)
summary(anova_well)#p<.05, wellbeing score of age groups are significantly different from each other. We do not know where exactly this difference exist, therefore we need posthoc tests.
pairwise.t.test(dfq2_reduced$welltotal, dfq2_reduced$Age, p.adjust.method = "bonf", paired=FALSE)
##Q2.2:The effects of age may be different depending on sex. Run an additional analysis or a set of additional analyses to address this possibility.
#The mean of a quantitative variable (DV=Wellbeing) changes according to the levels of two categorical variables (age with 4 levels and gender with two levels). Hence, two-way ANOVA will be used.
#check the variable type for gender
class(dfq2_reduced$RSEX)
dfq2_reduced$RSEX<-as.factor(dfq2_reduced$RSEX)#form it as factor.
anova_gender_age<-aov(welltotal~Age*RSEX,dfq2_reduced)
anova_gender_age
summary(anova_gender_age)
reg_gender_age<-lm(welltotal~Age*RSEX, data = dfq2_reduced)
summary(reg_gender_age)#both analyses show that there is no significant effect of gender and no interaction between age and gender, p>.05.
#visualising the results:
#obtain means:
mean1_16_female<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="2"])
mean2_16_male<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="1"])
mean3_25_female<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"&dfq2_reduced$RSEX=="2"])
mean4_25_male<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44 "&dfq2_reduced$RSEX=="1"])
mean5_45_female<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"&dfq2_reduced$RSEX=="2"])
mean6_45_male<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64 "&dfq2_reduced$RSEX=="1"])
mean7_65_female<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="2"])
mean8_65_male<- mean(dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="1"])
#combine means
all_means_gender<-c(mean1_16_female,mean2_16_male,mean3_25_female,mean4_25_male,mean5_45_female,mean6_45_male,mean7_65_female, mean8_65_male)
all_means_gender
#obtain number of participants
n1_16_female<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="2"])
n2_16_male<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="1"])
n3_25_female<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"&dfq2_reduced$RSEX=="2"])
n4_25_male<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"&dfq2_reduced$RSEX=="1"])
n5_45_female<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 65"&dfq2_reduced$RSEX=="2"])
n6_45_male<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 65"&dfq2_reduced$RSEX=="1"])
n7_65_female<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="2"])
n8_65_male<- length (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="1"])
#obtain standard deviation for each groups
sd1_16_female<- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="2"])
sd2_16_male<- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="16 to 24"&dfq2_reduced$RSEX=="1"])
sd3_25_female<-sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"&dfq2_reduced$RSEX=="2"])
sd4_25_male<-sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="25 to 44"&dfq2_reduced$RSEX=="1"])
sd5_45_female<-sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"&dfq2_reduced$RSEX=="2"])
sd6_45_male<- sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="45 to 64"&dfq2_reduced$RSEX=="1"])
sd7_65_female<-sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="2"])
sd8_65_male<-sd (dfq2_reduced$welltotal[dfq2_reduced$Age=="65 and over"&dfq2_reduced$RSEX=="1"])
#compute standard errors for each group
se1_16_female<-sd1_16_female/sqrt(n1_16_female)
se2_16_male<-sd2_16_male/sqrt(n2_16_male)
se3_25_female<-sd3_25_female/sqrt(n3_25_female)
se4_25_male<-sd4_25_male/sqrt(n4_25_male)
se5_45_female<-sd5_45_female/sqrt(n5_45_female)
se6_45_male<-sd6_45_male/sqrt(n6_45_male)
se7_65_female<-sd7_65_female/sqrt(n7_65_female)
se8_65_male<-sd8_65_male/sqrt(n8_65_male)
all_se_gender<-c(se1_16_female, se2_16_male, se3_25_female, se4_25_male, se5_45_female,se6_45_male,se7_65_female,se8_65_male)
all_se_gender
dfq2_fig2way<-data.frame(all_means_gender,all_se_gender)
dfq2_fig2way
dfq2_fig2way$Age[1]<-"16 to 24"
dfq2_fig2way$Age[2]<-"16 to 24"
dfq2_fig2way$Age[3]<-"25 to 44"
dfq2_fig2way$Age[4]<-"25 to 44"
dfq2_fig2way$Age[5]<-"45 to 65"
dfq2_fig2way$Age[6]<-"45 to 65"
dfq2_fig2way$Age[7]<-"65 and over"
dfq2_fig2way$Age[8]<-"65 and over"
dfq2_fig2way$RSEX[1]<-"1"
dfq2_fig2way$RSEX[2]<-"2"
dfq2_fig2way$RSEX[3]<-"1"
dfq2_fig2way$RSEX[4]<-"2"
dfq2_fig2way$RSEX[5]<-"1"
dfq2_fig2way$RSEX[6]<-"2"
dfq2_fig2way$RSEX[7]<-"1"
dfq2_fig2way$RSEX[8]<-"2"
dfq2_fig2way
library(ggplot2)
fig1_gender<-ggplot(dfq2_fig2way,aes(x=Age,y=all_means_gender,fill=RSEX))+geom_bar(stat="identity")
print(fig1_gender)
fig2_gender<-ggplot(dfq2_fig2way,aes(x=Age,y=all_means_gender,fill=RSEX))+geom_bar(stat="identity",position=position_dodge())
print(fig2_gender)
panas_df <- read.csv("Q1_PANAS_wide.csv")
no_permutations <- 100000
pb = txtProgressBar(min = 0, max = no_permutations, initial = 0)
permutations <- rep(0, no_permutations)
for(i in 1:no_permutations) {
setTxtProgressBar(pb,i)
set.seed(i)
wellbeing_permutations <- sample(dfq2$TOTAL, items, replace = F)
permutations[i] <- anova(aov(wellbeing_permutations ~ Age, dfq2))$F[1]
}
dfq2 <- read.csv(file = "Q2_data.csv", header = TRUE)
dfq2$TOTAL<-(dfq2$MCZ_1 +dfq2$MCZ_2 +dfq2$MCZ_8+ dfq2$MCZ_10+ dfq2$MCZ_17)
dfq2 <- dfq2[dfq2$TOTAL <= 50,]
items <-length(dfq2$Casenew)
anova_wellbeing <- aov(TOTAL ~ Age, dfq2)
actual_F <- anova(anova_wellbeing)$F[1]
no_permutations <- 100000
pb = txtProgressBar(min = 0, max = no_permutations, initial = 0)
permutations <- rep(0, no_permutations)
for(i in 1:no_permutations) {
setTxtProgressBar(pb,i)
set.seed(i)
wellbeing_permutations <- sample(dfq2$TOTAL, items, replace = F)
permutations[i] <- anova(aov(wellbeing_permutations ~ Age, dfq2))$F[1]
}
min(permutations)
max(permutations)
actual_F
no_permutations <- 1000000
pb = txtProgressBar(min = 0, max = no_permutations, initial = 0)
permutations <- rep(0, no_permutations)
for(i in 1:no_permutations) {
setTxtProgressBar(pb,i)
set.seed(i)
wellbeing_permutations <- sample(dfq2$TOTAL, items, replace = F)
permutations[i] <- anova(aov(wellbeing_permutations ~ Age, dfq2))$F[1]
}
mean(permutations >= actual_F)
min(permutations)
max(permutations)
sample(dfq2$TOTAL, items, replace = F)
length(sample(dfq2$TOTAL, items, replace = F) )
2898.11/8694
2898.11/536.78
df3 <- read.csv("Documents/UoR/2022-2023/PYM0S2/Assessment/Q2_data.csv")
df3$Age
spread(df3, Age, row_median)
library(tidyverse)
spread(df3, Age, row_median)
library(dplyr)
spread(df3, Age, row_median)
df3_data <- dfq2 %>% select(Casenew,row_median,Age1)
df3_data <- dfq2 %>% select(Casenew,row_median,Age)
df3_data <- dfq2 %>% select(Casenew,Total,Age)
dfq2
df3_data_wide <- spread(df3, Age, Total)
df3_data_wide <- spread(dfq2, Age, Total)
df3_data_wide <- spread(dfq2, Age, TOTAL)
df3_data_wide
df3_data_wide["16 to 24"][is.na(df3_data_wide["16 to 24"])] <- 0
df3_data_wide
df3_data_wide["65 and above"][is.na(df3_data_wide["65 and above"])]
df3_data_wide["65 and over"][is.na(df3_data_wide["65 and over"])]
df3_data_wide["16 to 24"][is.na(df3_data_wide["16 to 24"])] <- 0
df3_data_wide["25 to 44"][is.na(df3_data_wide["25 to 44"])] <- 0
df3_data_wide["44 to 64"][is.na(df3_data_wide["44 to 64"])] <- 0
df3_data_wide["45 to 64"][is.na(df3_data_wide["45 to 64"])] <- 0
df3_data_wide["65 and over"][is.na(df3_data_wide["65 and over"])] <- 0
data_12 <- df3_data_wide[,c("Casenew","1","2")]
data_12 <- df3_data_wide[,c("Casenew","16 to 24","25 to 44")]
data_12['diff'] = data_12['16 to 24'] - data_12['25 to 44']
data_12['diff']
i = 1
sampledID_12 <- sample(data_12$Casenew, 955)
sample(c(1,2,3,4))
sample(c(1,2,3,4))
sample(c(1,2,3,4))
sample(c(1,2,3,4))
#Q2.3: Using permutation testing, please retest the hypothesis that levels of individuals’ wellbeing are different depending on their age.
library(RVAideMemoire)
perm.anova(welltotal~Age, nest.f2 = c("fixed", "random"), dfq2_reduced, nperm = 999,
progress = TRUE)
#alternatively;
#to see the number of participants in each group:
table(dfq2_reduced$Age)
#data frame with two columns, age and total wellbeing scores, 147 cells for each group:
dfq2.3<-data.frame("Age"=rep(c("16 to 24", "25 to 44","45 to 64","65 and over"), each=147), "welltotal"=rep(NA,times=147*4))
#number of permutation samples
replication<-10000
#assigning zero to anova_well that is going to be populated with permutation values through anova simulations
permanov<-numeric(replication)
for (i in 1:replication){
firstsample<-dfq2_reduced[dfq2_reduced$Age=="16 to 24", "welltotal"]
sample2<-dfq2_reduced[dfq2_reduced$Age=="24 to 44", "welltotal"][sample(1:603,147)]
sample3<-dfq2_reduced[dfq2_reduced$Age=="44 to 64", "welltotal"][sample(1:680,147)]
sample4<-dfq2_reduced[dfq2_reduced$Age=="65 and over", "welltotal"][sample(1:601,147)]
}
#in a novel data frame, populating NA cells
dfq2.3$welltotal[dfq2.3$Age=="16 to 24"]<-firstsample
dfq2.3$welltotal[dfq2.3$Age=="24 to 44"]<-sample2
dfq2.3$welltotal[dfq2.3$Age=="44 to 64"]<-sample3
dfq2.3$welltotal[dfq2.3$Age=="65 and over"]<-sample4
#extracting p-value:
permanov[i]<-summary(aov(welltotal~Age, data=dfq2.3))[[1]][["Pr(>F)"]][[1]]
a<-aov(welltotal~Age,data=dfq2.3)
a<-summary(aov(data=dfq2.3, welltotal~Age))
a
a[[1]][["Pr(>F)"]][[1]]
#histogram;
hist(permanov, main="Well-being & Age Permutation Analysis of Variance", xlab="pvalue", ylab="Frequency")
abline(v=0.05, col="blue", lwd=2)
View(dfq2)
df_wellbeing <- dfq2
sampled_ID1 <- sample(df_wellbeing$Casenew, 1000, replace = FALSE)
# Creating a sample of 1000 case IDs for the second two groups
sampled_ID2 <- sample(df_wellbeing$Casenew, 1000, replace = FALSE)
uniquec(c(sampled_ID1, sampled_ID2))
unique(c(sampled_ID1, sampled_ID2))
length(unique(c(sampled_ID1, sampled_ID2)))
df_wellbeing[c(group16to24_ID, group25to44_ID, group45to64_ID, group65plus_ID),
"MCZ_total"]
group16to24_ID <- df_wellbeing$Casenew %in% sampled_ID1
group25to44_ID <- !(df_wellbeing$Casenew %in% sampled_ID1)
group45to64_ID <- df_wellbeing$Casenew %in% sampled_ID2
group65plus_ID <- !(df_wellbeing$Casenew %in% sampled_ID2)
df_wellbeing[c(group16to24_ID, group25to44_ID, group45to64_ID, group65plus_ID),
"MCZ_total"]
?random
sample(dataPwellbeing)
age1 <- wellbeing_reduced2$wellbeing_mean[wellbeing_reduced2$Age == "16 to 24"]
age1 <- dfq2$wellbeing_mean[dfq2$Age == "16 to 24"]
age2 <- dfq2$wellbeing_mean[dfq2$Age == "25 to 44"]
age3 <- dfq2$wellbeing_mean[dfq2$Age == "45 to 64"]
age4 <- dfq2$wellbeing_mean[dfq2$Age == "65 and over"]
age1
dfq2$Age
age1
dfq2$Age == "16 to 24"
age1 <- dfq2$TOTAL[dfq2$Age == "16 to 24"]
age2 <- dfq2$TOTAL[dfq2$Age == "25 to 44"]
age3 <- dfq2$TOTAL[dfq2$Age == "45 to 64"]
age4 <- dfq2$TOTAL[dfq2$Age == "65 and over"]
age1
dfq3
dfq3 <- read.csv("Documents/UoR/2022-2023/PYM0S2/Assessment/OSF Data File.csv")
dfq3$Target_Dom
dfq3$calc_dum <- sum(dfq3$IASR1,-dfq3$IASR2,-dfq3$IASR3,dfq3$IASR4,dfq3$IASR5,-dfq3$IASR6,-dfq3$IASR7,dfq3$IASR8,dfq3$IASR9,-dfq3$IASR10,-dfq3$IASR11,dfq3$IASR12,dfq3$IASR13,-dfq3$IASR14,-dfq3$IASR15)
correl(dfq3$calc_dum,dfq3$Target_Dom)
cor.test(dfq3$calc_dum,dfq3$Target_Dom)
dfq3$calc_dum
dfq3$calc_dum <- (dfq3$IASR1,-dfq3$IASR2,-dfq3$IASR3,dfq3$IASR4,dfq3$IASR5,-dfq3$IASR6,-dfq3$IASR7,dfq3$IASR8,dfq3$IASR9,-dfq3$IASR10,-dfq3$IASR11,dfq3$IASR12,dfq3$IASR13,-dfq3$IASR14,-dfq3$IASR15)
dfq3$calc_dum <- dfq3$IASR1 -dfq3$IASR2 -dfq3$IASR3 + dfq3$IASR4 + dfq3$IASR5 -dfq3$IASR6 -dfq3$IASR7 + dfq3$IASR8 + dfq3$IASR9 -dfq3$IASR10 -dfq3$IASR11 + dfq3$IASR12 + dfq3$IASR13 -dfq3$IASR14 -dfq3$IASR15
cor.test(dfq3$calc_dum,dfq3$Target_Dom)
dfq3$calc_dum <- dfq3$IASR1 -dfq3$IASR2 -dfq3$IASR3 + dfq3$IASR4 + dfq3$IASR5 -dfq3$IASR6 -dfq3$IASR7 + dfq3$IASR8 + dfq3$IASR9 -dfq3$IASR10 -dfq3$IASR11 + dfq3$IASR12 + dfq3$IASR13 -dfq3$IASR14 -dfq3$IASR15
dfq3$calc_dum
dfq3$calc_dum <- dfq3$IASR1 -dfq3$IASR2 -dfq3$IASR3 + dfq3$IASR4 + dfq3$IASR5 -dfq3$IASR6 -dfq3$IASR7 + dfq3$IASR8 + dfq3$IASR9 -dfq3$IASR10 -dfq3$IASR11 + dfq3$IASR12 + dfq3$IASR13 -dfq3$IASR14 -dfq3$IASR15
dfq3$calc_neuroticism <- dfq3$BFI4 - dfq3$BFI9 + dfq3$BFI14 + dfq3$BFI19 - dfq3$BFI24 + dfq3$BFI29 - dfq3$BFI34 +dfq3$BFI39
cor.test(dfq3$calc_neuroticism,dfq3$Target_Neu)
dfq3$TargetLabel
View(df3)
View(dfq3)
dfq3$TotalFNES
mediation::mediate?
?mediation::mediate
knitr::opts_chunk$set(echo = TRUE)
orth.df <- read.csv("orthorexia.csv")
lm(ORTO.R.Total ~ GNKQ.Total + SMDS.Total + EAI.Total)
lm(ORTO.R.Total ~ GNKQ.Total + SMDS.Total + EAI.Total, orth.df)
summary(lm(ORTO.R.Total ~ GNKQ.Total + SMDS.Total + EAI.Total, orth.df))
summary(lm(ORTO.R.Total ~ GNKQ.Total * SMDS.Total + EAI.Total, orth.df))
summary(lm(ORTO.R.Total ~ GNKQ.Total + SMDS.Total + EAI.Total, orth.df))
summary(lm(ORTO.R.Total ~ GNKQ.Total * SMDS.Total + EAI.Total, orth.df))
summary(lm(ORTO.R.Total ~ GNKQ.Total + SMDS.Total * EAI.Total, orth.df))
summary(lm(ORTO.R.Total ~ GNKQ.Total * SMDS.Total + EAI.Total, orth.df))
?cohensD
# Confirming with a package
cohensD(gapminder_2007$lifeExp, mu=50)
# Confirming with a package
library(psych)
cohens(gapminder_2007$lifeExp, mu=50)
lsr::cohe]
lsr::cohensD()
lsr::cohensD
# Confirming with a package
library(lsr)
cohens(gapminder_2007$lifeExp, mu=50)
cohensD(gapminder_2007$lifeExp, mu=50)
# load the gapminder data
library(gapminder)
# create a new data frame that only focuses on data from 2007
gapminder_2007 <- subset(
gapminder,   # the data set
year == 2007
)
min(gapminder_2007$lifeExp)
max(gapminder_2007$lifeExp)
life_expectancy_variance_table <- data.frame(
life_expectancy = gapminder_2007$lifeExp,
diff_from_mean  = gapminder_2007$lifeExp - mean(gapminder_2007$lifeExp)
)
rmarkdown::paged_table(life_expectancy_variance_table)
mean(life_expectancy_variance_table$diff_from_mean)
life_expectancy_variance_table$diff_squared = life_expectancy_variance_table$diff_from_mean^2
rmarkdown::paged_table(life_expectancy_variance_table)
mean(life_expectancy_variance_table$diff_squared)
sum_of_squares = sum(life_expectancy_variance_table$diff_squared)
this_variance  = sum_of_squares/length(life_expectancy_variance_table$diff_squared)
this_variance
three_heights = c(150,160,170)
population_height_mean = mean(three_heights)
population_height_variance = sum((three_heights - population_height_mean)^2)/3
#sample participants in pairs
sample_heights = data.frame(
pp1 = c(150,150,NA),
pp2 = c(160,NA,160),
pp3 = c(NA,170,170),
pair = c(
"1 and 2",
"1 and 3",
"2 and 3"
)
)
sample_heights$mean = c(
mean(c(three_heights[1], three_heights[2])),
mean(c(three_heights[1], three_heights[3])),
mean(c(three_heights[2], three_heights[3]))
)
sample_heights$pop_var = c(
sum((c(three_heights[1], three_heights[2]) - mean(c(three_heights[1], three_heights[2])))^2)/3,
sum((c(three_heights[1], three_heights[3]) - mean(c(three_heights[1], three_heights[3])))^2)/3,
sum((c(three_heights[2], three_heights[3]) - mean(c(three_heights[2], three_heights[3])))^2)/3
)
sample_heights$sample_var = c(
sum((c(three_heights[1], three_heights[2]) - mean(c(three_heights[1], three_heights[2])))^2)/(3-1),
sum((c(three_heights[1], three_heights[3]) - mean(c(three_heights[1], three_heights[3])))^2)/(3-1),
sum((c(three_heights[2], three_heights[3]) - mean(c(three_heights[2], three_heights[3])))^2)/(3-1)
)
rmarkdown::paged_table(sample_heights)
mean_sample_mean <- mean(sample_heights$mean)
mean_sample_variance <- mean(sample_heights$sample_var)
mean_population_variance <- mean(sample_heights$pop_var)
population_height_mean
mean_sample_mean
population_height_variance
mean_population_variance
population_height_variance
mean_sample_variance
# Manually calculated
(mean(gapminder_2007$lifeExp) - 50)/sd(gapminder_2007$lifeExp)
# Confirming with a package
library(lsr)
cohensD(gapminder_2007$lifeExp, mu=50)
reticulate::repl_python()
# Manually calculated
mean(gapminder_2007$lifeExp)
sd(gapminder_2007$lifeExp)
(mean(gapminder_2007$lifeExp) - 50)/sd(gapminder_2007$lifeExp)
reticulate::repl_python()
gapminder_2002
reticulate::repl_python()
