<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - T-Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document" rel="" target="">
 <span class="menu-text">Report an error</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications" rel="" target="">
 <span class="menu-text">Request a clarification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content" rel="" target="">
 <span class="menu-text">Suggest Content</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../GeneralLinearModels/generalLinearModels.html">General Linear Models</a></li><li class="breadcrumb-item"><a href="../GeneralLinearModels/TTests.html">T-Tests</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Welcome</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installing R(Studio)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">R Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Types of Scripts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Logic</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Statistics Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scientific Notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Describing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Central Tendency (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dispersion (R,Python)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binomial Distribution (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normal Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Skewness (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforming Data (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Correlation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlations (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/partialCorrelations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Partial Correlations (R,Python)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Regressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple regression (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regressions (R, incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">General Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Linear Models and Sum of Squares (R, Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/TTests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">T-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/oneWayAnova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">One Way ANOVA (incomplete)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/repeatedAnova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repeated Measures ANOVAs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/mixedAnova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed ANOVA (incomplete)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANCOVA (incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Categorical</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../categorical/contingency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contingency (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Item analyses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../itemAnalyses/cronbachsAlpha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cronbachâ€™s Alpha (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Multiple testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Family-Wise Error (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fdr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">False Discovery Rate(R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer_vs_fdr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FWER, FDR, Positive and Negative effects(R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
 <span class="menu-text">Permutations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permutations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Permutations (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permVsTtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Permutation vs.&nbsp;t tests (incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
 <span class="menu-text">Excel tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/formulas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/if.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">If function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/count.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Count and countifs function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/sum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sum and SumIf</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/averageIfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Averageifs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/anchoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anchoring</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
 <span class="menu-text">Test yourself</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/allQuestions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">All questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/questionMaker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Maker</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#one-sample-t-tests" id="toc-one-sample-t-tests" class="nav-link active" data-scroll-target="#one-sample-t-tests">One-Sample t-tests</a>
  <ul class="collapse">
  <li><a href="#glm-approach" id="toc-glm-approach" class="nav-link" data-scroll-target="#glm-approach">GLM approach</a></li>
  <li><a href="#glm-vs.-conventional-formula" id="toc-glm-vs.-conventional-formula" class="nav-link" data-scroll-target="#glm-vs.-conventional-formula">GLM vs.&nbsp;conventional formula</a></li>
  </ul></li>
  <li><a href="#paired-samples-t-tests" id="toc-paired-samples-t-tests" class="nav-link" data-scroll-target="#paired-samples-t-tests">Paired samples t-tests</a></li>
  <li><a href="#independent-samples-t-tests" id="toc-independent-samples-t-tests" class="nav-link" data-scroll-target="#independent-samples-t-tests">Independent Samples t-tests</a>
  <ul class="collapse">
  <li><a href="#glm-approach-1" id="toc-glm-approach-1" class="nav-link" data-scroll-target="#glm-approach-1">GLM approach</a></li>
  <li><a href="#glm-approach-vs-conventional-formula" id="toc-glm-approach-vs-conventional-formula" class="nav-link" data-scroll-target="#glm-approach-vs-conventional-formula">GLM approach vs conventional formula</a></li>
  </ul></li>
  <li><a href="#calculating-p-values-from-t-distributions" id="toc-calculating-p-values-from-t-distributions" class="nav-link" data-scroll-target="#calculating-p-values-from-t-distributions">Calculating p-values from t-distributions</a></li>
  <li><a href="#calculating-p-values-from-f-distributions" id="toc-calculating-p-values-from-f-distributions" class="nav-link" data-scroll-target="#calculating-p-values-from-f-distributions">Calculating p-values from f-distributions</a></li>
  <li><a href="#effect-sizes" id="toc-effect-sizes" class="nav-link" data-scroll-target="#effect-sizes">Effect sizes</a>
  <ul class="collapse">
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests">T-tests</a>
  <ul class="collapse">
  <li><a href="#one-sample-t-tests-1" id="toc-one-sample-t-tests-1" class="nav-link" data-scroll-target="#one-sample-t-tests-1">One Sample T-tests</a></li>
  <li><a href="#paired-sample-t-tests" id="toc-paired-sample-t-tests" class="nav-link" data-scroll-target="#paired-sample-t-tests">Paired sample T-tests</a></li>
  <li><a href="#independent-sample-t-tests" id="toc-independent-sample-t-tests" class="nav-link" data-scroll-target="#independent-sample-t-tests">Independent Sample T-tests</a></li>
  </ul></li>
  <li><a href="#f-tests" id="toc-f-tests" class="nav-link" data-scroll-target="#f-tests">F-tests</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">T-Tests</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Course Overview
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-fig-height="5" data-fig-width="10">
<div class="cell-output-display">
<div>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 1654.00 1052.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1048)">
<title>
Course Overview
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1048 1650,-1048 1650,4 -4,4"></polygon> <!-- ancova --> <g id="node1" class="node">
<title>
ancova
</title>
<g id="a_node1"><a href="../GeneralLinearModels/ancova.html" title="ANCOVA"> <polygon fill="red" stroke="#006688" stroke-width="5" points="1107,-288 837,-288 837,-216 1107,-216 1107,-288"></polygon> <text text-anchor="middle" x="972" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">ANCOVA</text> </a> </g> </g> <!-- permutation --> <g id="node17" class="node">
<title>
permutation
</title>
<g id="a_node17"><a href="permutations.html" title="Permutations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1107,-180 837,-180 837,-108 1107,-108 1107,-180"></polygon> <text text-anchor="middle" x="972" y="-136.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Permutations</text> </a> </g> </g> <!-- ancova&#45;&gt;permutation --> <g id="edge29" class="edge">
<title>
ancova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-216C972,-204.54 972,-191.81 972,-180.33"></path> </g> <!-- between_anova --> <g id="node2" class="node">
<title>
between_anova
</title>
<g id="a_node2"><a href="../GeneralLinearModels/oneWayAnova.html" title="One-way ANOVA"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="1395,-396 1125,-396 1125,-324 1395,-324 1395,-396"></polygon> <text text-anchor="middle" x="1260" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">One-way ANOVA</text> </a> </g> </g> <!-- between_anova&#45;&gt;ancova --> <g id="edge1" class="edge">
<title>
between_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1164.9,-324C1133.61,-312.48 1098.82,-299.68 1067.49,-288.15"></path> </g> <!-- between_anova&#45;&gt;permutation --> <g id="edge31" class="edge">
<title>
between_anova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1230.67,-324C1203.3,-292.87 1160.16,-247.53 1116,-216 1097.17,-202.56 1075.41,-190.37 1054.61,-180.03"></path> </g> <!-- binomial --> <g id="node3" class="node">
<title>
binomial
</title>
<g id="a_node3"><a href="../distributions/binomial.html" title="Binomial Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1032,-828 762,-828 762,-756 1032,-756 1032,-828"></polygon> <text text-anchor="middle" x="897" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Binomial Distribution</text> </a> </g> </g> <!-- contingency --> <g id="node4" class="node">
<title>
contingency
</title>
<g id="a_node4"><a href="../categorical/contingency.html" title="Contingency"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1154,-612 884,-612 884,-540 1154,-540 1154,-612"></polygon> <text text-anchor="middle" x="1019" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Contingency</text> </a> </g> </g> <!-- binomial&#45;&gt;contingency --> <g id="edge2" class="edge">
<title>
binomial-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M917.15,-755.66C939.82,-715.89 976.43,-651.68 999.03,-612.03"></path> </g> <!-- normal --> <g id="node15" class="node">
<title>
normal
</title>
<g id="a_node15"><a href="../distributions/normal.html" title="Normal Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="825,-720 555,-720 555,-648 825,-648 825,-720"></polygon> <text text-anchor="middle" x="690" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Normal Distribution</text> </a> </g> </g> <!-- binomial&#45;&gt;normal --> <g id="edge3" class="edge">
<title>
binomial-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M828.65,-756C806.15,-744.48 781.15,-731.68 758.63,-720.15"></path> </g> <!-- central_tendency --> <g id="node5" class="node">
<title>
central_tendency
</title>
<g id="a_node5"><a href="../describingData/centralTendency.html" title="Central Tendency"> <polygon fill="white" stroke="#006688" stroke-width="5" points="907,-936 637,-936 637,-864 907,-864 907,-936"></polygon> <text text-anchor="middle" x="772" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Central Tendency</text> </a> </g> </g> <!-- dispersion --> <g id="node7" class="node">
<title>
dispersion
</title>
<g id="a_node7"><a href="../describingData/dispersion.html" title="Dispersion"> <polygon fill="white" stroke="#006688" stroke-width="5" points="744,-828 474,-828 474,-756 744,-756 744,-828"></polygon> <text text-anchor="middle" x="609" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Dispersion</text> </a> </g> </g> <!-- central_tendency&#45;&gt;dispersion --> <g id="edge4" class="edge">
<title>
central_tendency-&gt;dispersion
</title>
<path fill="none" stroke="black" stroke-width="5" d="M718.18,-864C700.46,-852.48 680.77,-839.68 663.05,-828.15"></path> </g> <!-- correlations --> <g id="node6" class="node">
<title>
correlations
</title>
<g id="a_node6"><a href="../distributions/correlations.html" title="Correlations"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="531,-396 261,-396 261,-324 531,-324 531,-396"></polygon> <text text-anchor="middle" x="396" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Correlations</text> </a> </g> </g> <!-- partial_correlations --> <g id="node16" class="node">
<title>
partial_correlations
</title>
<g id="a_node16"><a href="../correlations/partialCorrelations.html" title="Partial Correlations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="558,-288 288,-288 288,-216 558,-216 558,-288"></polygon> <text text-anchor="middle" x="423" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Partial Correlations</text> </a> </g> </g> <!-- correlations&#45;&gt;partial_correlations --> <g id="edge5" class="edge">
<title>
correlations-&gt;partial_correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M404.92,-324C407.83,-312.54 411.08,-299.81 414,-288.33"></path> </g> <!-- correlations&#45;&gt;permutation --> <g id="edge32" class="edge">
<title>
correlations-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M480.51,-323.93C575.21,-284.7 718.97,-225.38 745,-216 779.86,-203.43 818.18,-190.95 853.25,-180.04"></path> </g> <!-- simple_regression --> <g id="node20" class="node">
<title>
simple_regression
</title>
<g id="a_node20"><a href="../regressions/simpleRegressions.html" title="Simple Regression"> <polygon fill="white" stroke="#006688" stroke-width="5" points="270,-288 0,-288 0,-216 270,-216 270,-288"></polygon> <text text-anchor="middle" x="135" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Simple Regression</text> </a> </g> </g> <!-- correlations&#45;&gt;simple_regression --> <g id="edge6" class="edge">
<title>
correlations-&gt;simple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M309.82,-324C281.46,-312.48 249.93,-299.68 221.54,-288.15"></path> </g> <!-- dispersion&#45;&gt;normal --> <g id="edge7" class="edge">
<title>
dispersion-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M635.75,-756C644.5,-744.54 654.23,-731.81 663,-720.33"></path> </g> <!-- fdr --> <g id="node8" class="node">
<title>
fdr
</title>
<g id="a_node8"><a href="../multipleTesting/fdr.html" title="False Discovery Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1358,-828 1088,-828 1088,-756 1358,-756 1358,-828"></polygon> <text text-anchor="middle" x="1223" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">False Discovery Rate</text> </a> </g> </g> <!-- fwer_vs_fdr --> <g id="node10" class="node">
<title>
fwer_vs_fdr
</title>
<g id="a_node10"><a href="../multipleTesting/fwer_vs_fdr.html" title="FWER vs. FDR"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1502,-720 1232,-720 1232,-648 1502,-648 1502,-720"></polygon> <text text-anchor="middle" x="1367" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">FWER vs.&nbsp;FDR</text> </a> </g> </g> <!-- fdr&#45;&gt;fwer_vs_fdr --> <g id="edge8" class="edge">
<title>
fdr-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1270.55,-756C1286.12,-744.54 1303.41,-731.81 1319.01,-720.33"></path> </g> <!-- fwer --> <g id="node9" class="node">
<title>
fwer
</title>
<g id="a_node9"><a href="../multipleTesting/fwer.html" title="Family-Wise Error Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1646,-828 1376,-828 1376,-756 1646,-756 1646,-828"></polygon> <text text-anchor="middle" x="1511" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Family-Wise Error Rate</text> </a> </g> </g> <!-- fwer&#45;&gt;fwer_vs_fdr --> <g id="edge9" class="edge">
<title>
fwer-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1463.45,-756C1447.88,-744.54 1430.59,-731.81 1414.99,-720.33"></path> </g> <!-- glm --> <g id="node11" class="node">
<title>
glm
</title>
<g id="a_node11"><a href="../GeneralLinearModels/generalLinearModels.html" title="General Linear Models"> <polygon fill="white" stroke="#006688" stroke-width="5" points="866,-612 596,-612 596,-540 866,-540 866,-612"></polygon> <text text-anchor="middle" x="731" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">General Linear Models</text> </a> </g> </g> <!-- ttests --> <g id="node24" class="node">
<title>
ttests
</title>
<g id="a_node24"><a href="../GeneralLinearModels/TTests.html" title="T-Tests"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1107,-504 837,-504 837,-432 1107,-432 1107,-504"></polygon> <text text-anchor="middle" x="972" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">T-Tests</text> </a> </g> </g> <!-- glm&#45;&gt;ttests --> <g id="edge10" class="edge">
<title>
glm-&gt;ttests
</title>
<path fill="none" stroke="black" stroke-width="5" d="M810.58,-540C836.77,-528.48 865.88,-515.68 892.09,-504.15"></path> </g> <!-- mediation --> <g id="node12" class="node">
<title>
mediation
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="270,-72 0,-72 0,0 270,0 270,-72"></polygon> <text text-anchor="middle" x="135" y="-28.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Mediation</text> </g> <!-- mixed_anova --> <g id="node13" class="node">
<title>
mixed_anova
</title>
<g id="a_node13"><a href="../GeneralLinearModels/mixedAnova.html" title="Mixed ANOVA"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="1107,-396 837,-396 837,-324 1107,-324 1107,-396"></polygon> <text text-anchor="middle" x="972" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Mixed ANOVA</text> </a> </g> </g> <!-- mixed_anova&#45;&gt;ancova --> <g id="edge11" class="edge">
<title>
mixed_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-324C972,-312.54 972,-299.81 972,-288.33"></path> </g> <!-- multiple_regression --> <g id="node14" class="node">
<title>
multiple_regression
</title>
<g id="a_node14"><a href="../regressions/multipleRegressions.html" title="Multiple Regression"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="270,-180 0,-180 0,-108 270,-108 270,-180"></polygon> <text text-anchor="middle" x="135" y="-136.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Multiple Regression</text> </a> </g> </g> <!-- multiple_regression&#45;&gt;mediation --> <g id="edge12" class="edge">
<title>
multiple_regression-&gt;mediation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M135,-108C135,-96.54 135,-83.81 135,-72.33"></path> </g> <!-- normal&#45;&gt;contingency --> <g id="edge14" class="edge">
<title>
normal-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M798.64,-648C834.48,-636.45 874.34,-623.61 910.19,-612.06"></path> </g> <!-- normal&#45;&gt;correlations --> <g id="edge13" class="edge">
<title>
normal-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M622.95,-647.82C609.28,-637.89 596.27,-625.92 587,-612 541.67,-543.95 599.91,-495.98 549,-432 537.33,-417.34 521.93,-405.57 505.4,-396.16"></path> </g> <!-- normal&#45;&gt;glm --> <g id="edge15" class="edge">
<title>
normal-&gt;glm
</title>
<path fill="none" stroke="black" stroke-width="5" d="M703.54,-648C707.97,-636.54 712.89,-623.81 717.34,-612.33"></path> </g> <!-- skewness --> <g id="node21" class="node">
<title>
skewness
</title>
<g id="a_node21"><a href="../distributions/skewness.html" title="Skewness"> <polygon fill="white" stroke="#006688" stroke-width="5" points="536,-612 266,-612 266,-540 536,-540 536,-612"></polygon> <text text-anchor="middle" x="401" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Skewness</text> </a> </g> </g> <!-- normal&#45;&gt;skewness --> <g id="edge16" class="edge">
<title>
normal-&gt;skewness
</title>
<path fill="none" stroke="black" stroke-width="5" d="M594.57,-648C563.17,-636.48 528.26,-623.68 496.82,-612.15"></path> </g> <!-- probability --> <g id="node18" class="node">
<title>
probability
</title>
<g id="a_node18"><a href="../statsBasics/probability.html" title="Probability"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1276,-936 1006,-936 1006,-864 1276,-864 1276,-936"></polygon> <text text-anchor="middle" x="1141" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Probability</text> </a> </g> </g> <!-- probability&#45;&gt;contingency --> <g id="edge20" class="edge">
<title>
probability-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1104.47,-863.94C1094.99,-853.19 1085.6,-840.8 1079,-828 1042.23,-756.72 1027.55,-662.41 1022.04,-612.12"></path> </g> <!-- probability&#45;&gt;fdr --> <g id="edge22" class="edge">
<title>
probability-&gt;fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1168.08,-864C1176.94,-852.54 1186.79,-839.81 1195.67,-828.33"></path> </g> <!-- probability&#45;&gt;fwer --> <g id="edge21" class="edge">
<title>
probability-&gt;fwer
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1263.18,-864C1303.49,-852.45 1348.31,-839.61 1388.64,-828.06"></path> </g> <!-- repeated_measures_anova --> <g id="node19" class="node">
<title>
repeated_measures_anova
</title>
<g id="a_node19"><a href="../GeneralLinearModels/repeatedAnova.html" title="Repeated Measures"> <polygon fill="red" stroke="#006688" stroke-width="5" points="819,-396 549,-396 549,-324 819,-324 819,-396"></polygon> <text text-anchor="middle" x="684" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Repeated Measures</text> </a> </g> </g> <!-- repeated_measures_anova&#45;&gt;ancova --> <g id="edge23" class="edge">
<title>
repeated_measures_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M779.1,-324C810.39,-312.48 845.18,-299.68 876.51,-288.15"></path> </g> <!-- repeated_measures_anova&#45;&gt;permutation --> <g id="edge30" class="edge">
<title>
repeated_measures_anova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M713.33,-324C740.7,-292.87 783.84,-247.53 828,-216 846.83,-202.56 868.59,-190.37 889.39,-180.03"></path> </g> <!-- simple_regression&#45;&gt;multiple_regression --> <g id="edge17" class="edge">
<title>
simple_regression-&gt;multiple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M135,-216C135,-204.54 135,-191.81 135,-180.33"></path> </g> <!-- transforming --> <g id="node23" class="node">
<title>
transforming
</title>
<g id="a_node23"><a href="../distributions/transforming.html" title="Transforming Data"> <polygon fill="white" stroke="#006688" stroke-width="5" points="540,-504 252,-504 252,-432 540,-432 540,-504"></polygon> <text text-anchor="middle" x="396" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Transforming Data</text> </a> </g> </g> <!-- skewness&#45;&gt;transforming --> <g id="edge18" class="edge">
<title>
skewness-&gt;transforming
</title>
<path fill="none" stroke="black" stroke-width="5" d="M399.35,-540C398.81,-528.54 398.21,-515.81 397.67,-504.33"></path> </g> <!-- stats_basics --> <g id="node22" class="node">
<title>
stats_basics
</title>
<g id="a_node22"><a href="../statsBasics/statsBasics.html" title="Statistics Basics"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1051,-1044 781,-1044 781,-972 1051,-972 1051,-1044"></polygon> <text text-anchor="middle" x="916" y="-1000.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Statistics Basics</text> </a> </g> </g> <!-- stats_basics&#45;&gt;central_tendency --> <g id="edge24" class="edge">
<title>
stats_basics-&gt;central_tendency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M868.45,-972C852.88,-960.54 835.59,-947.81 819.99,-936.33"></path> </g> <!-- stats_basics&#45;&gt;probability --> <g id="edge25" class="edge">
<title>
stats_basics-&gt;probability
</title>
<path fill="none" stroke="black" stroke-width="5" d="M990.3,-972C1014.75,-960.48 1041.93,-947.68 1066.4,-936.15"></path> </g> <!-- transforming&#45;&gt;correlations --> <g id="edge19" class="edge">
<title>
transforming-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M396,-432C396,-420.54 396,-407.81 396,-396.33"></path> </g> <!-- ttests&#45;&gt;between_anova --> <g id="edge27" class="edge">
<title>
ttests-&gt;between_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1067.1,-432C1098.39,-420.48 1133.18,-407.68 1164.51,-396.15"></path> </g> <!-- ttests&#45;&gt;mixed_anova --> <g id="edge26" class="edge">
<title>
ttests-&gt;mixed_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-432C972,-420.54 972,-407.81 972,-396.33"></path> </g> <!-- ttests&#45;&gt;permutation --> <g id="edge33" class="edge">
<title>
ttests-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1107.25,-463.29C1219.41,-457.03 1366.37,-440.32 1404,-396 1501.55,-281.11 1267.68,-206.55 1107.33,-170.5"></path> </g> <!-- ttests&#45;&gt;repeated_measures_anova --> <g id="edge28" class="edge">
<title>
ttests-&gt;repeated_measures_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M876.9,-432C845.61,-420.48 810.82,-407.68 779.49,-396.15"></path> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p><span style="color:red"><strong>Red</strong></span> means that the page does not exist yet</p>
<p><span style="color:orange"><strong>Orange</strong></span> means that the page is started</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
T-values and F-Values
</div>
</div>
<div class="callout-body-container callout-body">
<p>As youâ€™ll see below, weâ€™ll discuss t-values and F-values you can calculate. T-values are from t-tests, in which there are only 2 conditions or 2 groups of participants you are comparing between. F-values are from a variety of tests and are not restricted to comparisons between 2 conditions or 2 groups. For example, you can run ANOVAs to get F-Values on 2 or more conditions. The underlying statistics between calculating T and F-Values is similar when comparing 2 conditions/groups, which is why <span class="math inline">\(t = \sqrt{F}\)</span> and <span class="math inline">\(F = t^2\)</span> .</p>
<p>When describing a GLM approach, this is more aligned with how you would calculate an F-value.</p>
</div>
</div>
<p>In all general linear models you are trying to compare how much of the variance is explained by a model compared to whatâ€™s not being explained by a model. In short</p>
<p><span class="math display">\[
\frac{var_{explained}}{var_{unexplained}} = \frac{SS_{explained}}{SS_{unexplained}}
\]</span></p>
<p>For each type of t-test, the way we calculate this is slightly different:</p>
<section id="one-sample-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-tests">One-Sample t-tests</h2>
<section id="glm-approach" class="level3">
<h3 class="anchored" data-anchor-id="glm-approach">GLM approach</h3>
<p>One sample t-tests try to explain whether variance of data is better explained around one specific value (sample mean) compared to another (previously assumed value). For example, imagine that you wanted to test whether life expectancy is higher than 55 across the world:</p>
<ul>
<li><p>Your <span class="math inline">\(\mu\)</span> would be 55. This can be thought of as the assumed population mean that we want to use our sample to test.</p></li>
<li><p>Your <span class="math inline">\(\bar{x}\)</span> would be the sample mean.</p></li>
</ul>
<p>Letâ€™s visualise these values using gapminder data from 2007:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_2007, <span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>lifeExp)) <span class="sc">+</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">55</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">55</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Mu"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Sample Mean"</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the gapminder module and import the gapminder dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gapminder <span class="im">import</span> gapminder</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new data frame that only focuses on data from 2007</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="op">=</span> gapminder.loc[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create the scatterplot with some jitter</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">"year"</span>, y<span class="op">=</span><span class="st">'lifeExp'</span>, data<span class="op">=</span>gapminder_2007, dodge<span class="op">=</span><span class="va">True</span>, jitter<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for Mu</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">55</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Mu'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for the mean of 'lifeExp'</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_2007[<span class="st">'lifeExp'</span>].mean(), color<span class="op">=</span><span class="st">'g'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the label on the x-axis</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">""</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the tick on the x-axis</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># add the legend </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># show the plot</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure1.png" class="img-fluid figure-img" width="650"></p>
<figcaption class="figure-caption">Scatterplot with Mu and Sample Mean of â€˜Life expectancyâ€™</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>We want to create a model that explains any variance around the population mean (mu or <span class="math inline">\(\mu\)</span>). The sample mean could be modeled as such:</p>
<p><span class="math display">\[
y = \bar{y} + e
\]</span></p>
<ul>
<li><p>Y is the data point value you are trying to predict. Note that for this formula you will <strong>always</strong> have the same predicted outcome (the mean).</p></li>
<li><p><span class="math inline">\(\bar{y}\)</span> is mean of all y data points. You are only interested in whether predicting y based on yâ€™s mean captures a significant amount of the variance of the y-values around the <span class="math inline">\(\mu\)</span>.</p></li>
<li><p><span class="math inline">\(e\)</span> is the error, i.e.&nbsp;the residuals that the module do not predict effectively.</p></li>
</ul>
<p>If the sample mean is a useful model, then it will explain a large proportion of the variance around the â€œpopulationâ€ mean (and will also suggested that there is significant reason to reject the population mean). The total variance using sum of squares is thus:</p>
<p><span class="math display">\[
SS_{total} = \sum(x_i-\mu)^2
\]</span></p>
<p>Which for the above data would give us:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="dv">55</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41025.16</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the squared dfference</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> <span class="dv">55</span>) <span class="op">**</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>41025.157014</code></pre>
</div>
</div>
</div>
<p>So your explained variance by this model is any difference between the Mu (<span class="math inline">\(\mu\)</span>) and the sample mean (<span class="math inline">\(\bar{x}\)</span>). To summarise this using sum of squares, for each data point you subtract the two from each other and square them, as this difference is what we can explain of variance away from the MU:</p>
<p><span class="math display">\[
SS_{explained} = N * (\mu - \bar{x})^2
\]</span></p>
<p>Which for the above data would give us:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20473.3</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span>( <span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean())<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>20473.303823352093</code></pre>
</div>
</div>
</div>
<p>Unexplained variance would be the residuals around the sample mean, as this is variance that is not explained by the model. Conveniently, we can calculate the sum of squared around the sample mean quite elegantly:</p>
<p><span class="math display">\[
SS_{unexplained} = \sum(x_i-\bar{x})^2
\]</span></p>
<p>Which for the above data would give us</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20551.85</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>20551.853190647882</code></pre>
</div>
</div>
</div>
<p>In general linear models we calculate <span class="math inline">\(F\)</span>-values as a statistic of how effective a model is at explaining the variance. These <span class="math inline">\(F\)</span>-values use degrees of freedom (see <a href="../describingData/dispersion.html#degrees-of-freedom">here</a> for a reminder) to adjust for</p>
<p>So the F-value should be:</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{20473.3/(Predictors)}{20551.85/(N-1)} = \frac{20473.3/1}{20551.85/141}
\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>f_value <span class="ot">=</span> (<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>f_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 140.4611</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences between each value in 'lifeExp' and the mean</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span> (<span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences within groups</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the degrees of freedom for between groups and within groups</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>df_between <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>df_within <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the F-statistic</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>f_value <span class="op">=</span> (ss_between <span class="op">/</span> df_between) <span class="op">/</span> (ss_within <span class="op">/</span> df_within)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>140.46109673488004</code></pre>
</div>
</div>
</div>
<p>F-values are squares of t-values, so letâ€™s see if this is true here also:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.85163</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="at">mu=</span><span class="dv">55</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  gapminder_2007$lifeExp
t = 11.852, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 55
95 percent confidence interval:
 65.00450 69.01034
sample estimates:
mean of x 
 67.00742 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the square root of the F-value</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>np.sqrt(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>11.851628442323022</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2007[<span class="st">'lifeExp'</span>], popmean<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>t-statistic: 11.851628442323024
p-value: 6.463174215427706e-23</code></pre>
</div>
</div>
</div>
</section>
<section id="glm-vs.-conventional-formula" class="level3">
<h3 class="anchored" data-anchor-id="glm-vs.-conventional-formula">GLM vs.&nbsp;conventional formula</h3>
<p>Great. So now that weâ€™ve highlighted the GLM approach works for t-tests, can we see how our formula for a GLM simplifies to the formula we usually use for one-sample t-tests:</p>
<p><span class="math display">\[
T = \sqrt{F} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \sqrt{\frac{N * (\mu - \bar{x})^2/(levelsOfPredictors - 1)}{\sum(x_i-\bar{x})^2/(N-1)}} =
\]</span></p>
<p><span class="math display">\[
\sqrt{\frac{N * (\mu - \bar{x})^2/(2-1)}{\sigma^2}} = \frac{\sqrt{N * (\mu - \bar{x})^2}}{\sqrt{\sigma^2}} = \frac{\sqrt{(\mu - \bar{x})^2}}{\sigma/\sqrt{N}} = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}
\]</span> where:</p>
<ul>
<li>T is the t-value</li>
<li>F is the f-value</li>
<li><span class="math inline">\(SS_{exp}\)</span> is the sum of squares of the data explained by the model</li>
<li><span class="math inline">\(SS_{unexp}\)</span> is the sum of squares of the data not explained by the model (i.e.&nbsp;the residuals)</li>
<li><span class="math inline">\(df_{exp}\)</span> is the degrees of freedom for the model. As there is only one predictor (the sample mean) and itâ€™s only got 2 levels (1 or 0, however, in all cases the model is comparing the data to the mean, so itâ€™s less intuitive that there are 2 levels).</li>
</ul>
<p>To confirm, the formula for a one-sample t-test is just:</p>
<p><span class="math display">\[
T = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}
\]</span></p>
</section>
</section>
<section id="paired-samples-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples-t-tests">Paired samples t-tests</h2>
<p>Paired samples t-tests can be approached like 1-sample t-tests, but you first of all need to collapse the data to have a single variable to compare to a <span class="math inline">\(\mu\)</span> of zero. Letâ€™s do this for gapminder data, comparing life expectancies between 2002 and 2007:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>] <span class="sc">-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2002_2007_life_exp, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  gapminder_2002_2007_life_exp
t = 14.665, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 1.135561 1.489439
sample estimates:
mean of x 
   1.3125 </code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="op">=</span> life_exp_2007.reset_index(drop<span class="op">=</span><span class="va">True</span>) <span class="op">-</span> life_exp_2002.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2002_2007_life_exp, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>t-statistic: 14.664513524875451
p-value: 3.738316746290281e-30</code></pre>
</div>
</div>
</div>
<p>The above suggests that life expectancy was significanctly different. Letâ€™s see if we get the exact same value when we use a paired t-test in R:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>],gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>], <span class="at">paired=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  gapminder$lifeExp[gapminder$year == 2007] and gapminder$lifeExp[gapminder$year == 2002]
t = 14.665, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 1.135561 1.489439
sample estimates:
mean difference 
         1.3125 </code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2007</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>life_exp_2007 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2002</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>life_exp_2002 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2002</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a paired t-test</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_rel(life_exp_2007, life_exp_2002)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"T-statistic:"</span>, t_statistic)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"P-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>t-statistic: 14.664513524875451
p-value: 3.738316746290281e-30</code></pre>
</div>
</div>
</div>
<p>Looks identical. Letâ€™s compare formulas to see why this is ( <span class="math inline">\(\mu\)</span> = 0 , and so it isnâ€™t written) :</p>
<p><span class="math display">\[
t_{paired} = \frac{\bar{x_1} - \bar{x_2}}{\sigma_{pooled}/\sqrt{N}} = \frac{\bar{x_3}}{\sigma_{pooled}/\sqrt{N}}
\]</span></p>
<p>Where</p>
<ul>
<li><p><span class="math inline">\(\bar{x_1}\)</span> is the mean of condition 1</p></li>
<li><p><span class="math inline">\(\bar{x_2}\)</span> is the mean of condition 2</p></li>
<li><p><span class="math inline">\(\bar{x_3}\)</span> is the mean of the result you get when you subtract condition 2 from condition 1 for each participant, i.e.&nbsp;<span class="math inline">\(mean(x_1-x_2)\)</span>.</p></li>
<li><p><span class="math display">\[
\sigma_{pooled}  = \sqrt{\frac{\sigma_1^2 + \sigma_2^2}{2}} OR \frac{\sum(x_1 - x_2)^2}{N-1}
\]</span> One way effectively gets the average of the standard deviations of condition and 1. The second way gets the standard deviation of the differences between conditions 1 and 2. Both give you the same outcome.</p></li>
<li><p><span class="math inline">\(N\)</span> is the number of participants</p></li>
</ul>
<p>You can rewrite the above formula to compare <span class="math inline">\(\bar{x_3}\)</span> to <span class="math inline">\(\mu\)</span>, as we know <span class="math inline">\(\mu\)</span> is zero, which would make this formula (effectively) identical to the one above for one-sample t-tests: $$</p>
<p><span class="math display">\[
\frac{\bar{x_3} - \mu}{\sigma_{pooled}/\sqrt{N}}
\]</span></p>
</section>
<section id="independent-samples-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="independent-samples-t-tests">Independent Samples t-tests</h2>
<section id="glm-approach-1" class="level3">
<h3 class="anchored" data-anchor-id="glm-approach-1">GLM approach</h3>
<p>T-tests are restricted to comparisons between 2 conditions/groups, so we will restrict the Gapminder data to allow a comparison between 2 continents. To see if life expectancy was different if you are born in Europe compared to the Americas, letâ€™s first check what the sum of squares is when you just use the <strong>mean</strong> as the model of life expectancy <strong>across</strong> these contents (so weâ€™re <strong>not</strong> separating by continent yet):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007,   <span class="co"># the data set</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mean-life-exp-resid-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-mean-life-exp-resid-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The errors around the mean of life expectancy across Europe and American countries</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>].rank()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], gapminder_americas_europe[<span class="st">"lifeExp"</span>], color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'blue'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>], ymax<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure2.png" width="700" height="500" class="figure-img"></p>
<figcaption class="figure-caption"><em>Fig. 3.</em> The errors around the mean of life expectancy across Europe and American countries.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Once we square the errors in the pink lines above, weâ€™ll get the <strong>squares:</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 953.4478</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-mean-life-exp-resid-squared-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-mean-life-exp-resid-squared-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The squared errors around the mean of life expectancy across Europe and American countries</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], (gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"(Life Expectancy - mean(Life Expectancy))^2"</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure3.png" width="700" height="500" class="figure-img"></p>
<figcaption class="figure-caption">The squared errors around the mean of life expectancy across Europe and American countries</figcaption>
</figure>
</div>
<pre><code>953.4477649818183</code></pre>
</div>
</div>
</div>
<p>And when you add all of these together:</p>
<p><span class="math display">\[
SumOfSquares = \sum(Y_i-\bar{Y})^2 = 953.4478
\]</span></p>
<p>So if the model we create for a t-test would result in a smaller <strong>sum of squares</strong> then that suggests itâ€™s a more precise model for estimating life expectancy than simply using the <strong>mean</strong> as a model. This is because this would mean thereâ€™s less <strong>error</strong> in this model. Letâ€™s model this using a t-test. For this we will need to effect code continent:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a column to place 1 or -1 for each row dependent on the country</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>contEffect <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">=</span> <span class="fu">cbind</span>(contEffect,gapminder_americas_europe)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contEffect"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["country"],"name":[2],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[6],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"Albania","3":"Europe","4":"2007","5":"76.423","6":"3600523","7":"5937.030","_rn_":"1"},{"1":"-1","2":"Argentina","3":"Americas","4":"2007","5":"75.320","6":"40301927","7":"12779.380","_rn_":"2"},{"1":"1","2":"Austria","3":"Europe","4":"2007","5":"79.829","6":"8199783","7":"36126.493","_rn_":"3"},{"1":"1","2":"Belgium","3":"Europe","4":"2007","5":"79.441","6":"10392226","7":"33692.605","_rn_":"4"},{"1":"-1","2":"Bolivia","3":"Americas","4":"2007","5":"65.554","6":"9119152","7":"3822.137","_rn_":"5"},{"1":"1","2":"Bosnia and Herzegovina","3":"Europe","4":"2007","5":"74.852","6":"4552198","7":"7446.299","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> cols[<span class="bu">len</span>(cols)<span class="op">-</span><span class="dv">1</span>:<span class="bu">len</span>(cols):<span class="dv">1</span>]<span class="op">+</span>cols[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">1</span>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_americas_europe[cols]</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(gapminder_americas_europe[:<span class="dv">6</span>], headers<span class="op">=</span>gapminder_americas_europe.head(), tablefmt<span class="op">=</span><span class="st">"fancy_grid"</span>,showindex<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table2.png" height="300" class="figure-img"></p>
<figcaption class="figure-caption">Table</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Now that we have effect coded the continent, we can create a new model to try to predict an individualâ€™s life expectancy based on which continent they are from</p>
<p><span class="math display">\[
Y = intercept + \beta * effectVariable + Error
\]</span></p>
<p>Which in our case means:</p>
<p><span class="math display">\[
lifeExp = mean(lifeExp) + \beta * contEffect + Error
\]</span></p>
<ul>
<li><p>Y being the predicted life expectancy.</p></li>
<li><p><span class="math inline">\(\bar{Y}\)</span> being the mean life expectancy regardless of continent. For a t-test this is also the <span class="math inline">\(intercept\)</span>.</p></li>
<li><p><span class="math inline">\(\beta\)</span> being how much to adjust the prediction based on which continent the person is from</p></li>
<li><p><span class="math inline">\(contEffect\)</span> being 1 (Europe) or -1 (Americas) to reflect which continent the participant is from</p></li>
<li><p><span class="math inline">\(Error\)</span> being any error in the prediction not captured by the model</p></li>
</ul>
<p>To get the <span class="math inline">\(intercept\)</span> and <span class="math inline">\(\beta\)</span> for the above formula letâ€™s use linear model functions:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   75.62836 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>contEffect 
   2.02024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_fit <span class="ot">=</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> <span class="co"># intercept</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]                       <span class="sc">*</span> <span class="co"># gradient</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>contEffect</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x =</span> contEffect, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> contEffect,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> t_fit,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.9</span>, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>, </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">-</span> <span class="fl">1.9</span>,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"dark green"</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model-life-exp-mean-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-model-life-exp-mean-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Plot with the errors around the mean of life expectancy across Europe and American countries.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'contEffect' to type category</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">'contEffect'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lm 'contEffect' ~ 'lifeExp'</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="op">=</span> stats.linregress(gapminder_americas_europe[<span class="st">'contEffect'</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>])</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show results of lm</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>continent_ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>LinregressResult(slope=2.020240000000001, intercept=75.62836, rvalue=0.4832076439158285, pvalue=0.00018637488941351192, stderr=0.502794193121279, intercept_stderr=0.5027941931212789)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_fit'</span>] <span class="op">=</span> continent_ttest.intercept <span class="op">+</span>continent_ttest.slope <span class="op">*</span> gapminder_americas_europe[<span class="st">'contEffect'</span>]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_res_square'</span>] <span class="op">=</span> (gapminder_americas_europe[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_americas_europe[<span class="st">'t_fit'</span>])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span>np.repeat(m1, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span>np.repeat(m2, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==-1</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.98</span>, <span class="op">-</span><span class="fl">.05</span>, <span class="fl">0.08</span>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==1</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="fl">0.05</span>, <span class="fl">1.98</span>, <span class="fl">0.065</span>)</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="dv">60</span>, <span class="dv">85</span>])</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'green'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m1,xmin<span class="op">=-</span><span class="fl">1.99</span>, xmax<span class="op">=-</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m2,xmin<span class="op">=</span><span class="fl">1.99</span>, xmax<span class="op">=</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x1,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>], ymax<span class="op">=</span>m11, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x2,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>], ymax<span class="op">=</span>m22, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"contEffect"</span>)</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure4.png" width="700" height="500" class="figure-img"></p>
<figcaption class="figure-caption">Plot with the errors around the mean of life expectancy across Europe and American countries</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Countries in the americas are dummy coded as -1 and countries in Europe are dummy coded as 1. Note that jittering has been used to help visualise variation within continents, and so all countries in Americas had a <span class="math inline">\(contEffect\)</span> score of -1, even if the jittering above makes it look like participants from Europe had slightly different <span class="math inline">\(contEffect\)</span> values to each other.</p>
<p>So now that weâ€™ve visualised the predictions and the error, lets summarise these errors with their sum of squares:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#temp_summary &lt;- summary(lm(lifeExp ~ contEffect, data = gapminder_americas_europe))</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(lifeExp <span class="sc">~</span> contEffect, <span class="at">data =</span> gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
contEffect   1  222.6  222.62   16.14 0.000186 ***
Residuals   53  730.8   13.79                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>america_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>ss_between <span class="ot">&lt;-</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">*</span> (europe_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> (america_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>top_half <span class="ot">=</span> ss_between</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>ss_within <span class="ot">=</span> (</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> europe_mean)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> america_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">=</span> (ss_within<span class="sc">/</span>(<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>top_half<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.14453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  gapminder_americas_europe$lifeExp[gapminder_americas_europe$contEffect == 1] and gapminder_americas_europe$lifeExp[gapminder_americas_europe$contEffect == -1]
t = 4.018, df = 53, p-value = 0.0001864
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 2.023525 6.057435
sample estimates:
mean of x mean of y 
 77.64860  73.60812 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span><span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.14432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at a t-distribution compared to an f-distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a table for the model</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>aov_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># display the table</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>aov_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table3.png" height="100" class="figure-img"></p>
<figcaption class="figure-caption">Table</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>].mean()</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>america_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span>(<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">*</span> (europe_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> (<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (america_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>top_half <span class="op">=</span> ss_between</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> (<span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>] <span class="op">-</span> europe_mean)<span class="op">**</span><span class="dv">2</span>)<span class="op">+</span> <span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> america_mean)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="op">=</span> (ss_within<span class="op">/</span>(<span class="bu">len</span>(gapminder_americas_europe[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>top_half<span class="op">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>16.14453</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>t_test <span class="op">=</span> ttest_ind(gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>t_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>Ttest_indResult(statistic=4.018025720342183, pvalue=0.00018637488941352037)</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span> <span class="op">**</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>16.144530689331322</code></pre>
</div>
</div>
</div>
<p>So the new unexplained variance (AKA residual) is 730.8276, which is smaller than it was when we just used the mean regardless of continent (953.4478; 935.4478 is also the <strong>total variance</strong> around the mean).</p>
<p>The sum of squares for the effect of continent can be calculated by subtracting the residuals from the total sum of squares (SS):</p>
<p><span class="math display">\[
effect_{SS} = total_{SS} - residual_{SS} = 953.4478 - 730.8276 = 222.6202
\]</span></p>
<p>The <span class="math inline">\(effect_{SS}\)</span> can also be thought of our explained variance! So we can actually calculate how much of the model is explained by the model (<span class="math inline">\(r^2\)</span>):</p>
<p><span class="math display">\[
r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335
\]</span></p>
<p>Letâ€™s confirm that this is correct by comparing a manual calculation and a function:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="sc">/</span><span class="fl">953.4478</span> <span class="co"># should be  0.2335 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334897</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334896</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="op">/</span><span class="fl">953.4478</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>0.23348965722087775</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get the r squared from the model</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> model.rsquared</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the R-squared value</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R-squared:"</span>, r_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>0.2334896271386857</code></pre>
</div>
</div>
</div>
<p>Great, the difference reflects a rounding error.</p>
<p>Note that the above formula is similar to the formula for <span class="math inline">\(r\)</span> from <a href="../regressions/simpleRegressions.html#proportion-of-variance-explained">simple regressions</a>. Variance is the square root of the Sum of Squares (or Sum of Squares is the <strong>square</strong> of variance!):</p>
<p><span class="math display">\[
r = \sqrt{\frac{SS_{explained}}{SS_{total}}} = \frac{\sqrt{SS_{explained}}}{\sqrt{SS_{total}}} =\frac{var_{explained}}{var_{total}}
\]</span></p>
</section>
<section id="glm-approach-vs-conventional-formula" class="level3">
<h3 class="anchored" data-anchor-id="glm-approach-vs-conventional-formula">GLM approach vs conventional formula</h3>
<p>The main formula for an independent samples t-test is:</p>
<p><span class="math display">\[
t =  \frac{\bar{X_1} - \bar{X_2}}{SE}
\]</span></p>
<p>However, this is a simplification of the GLM mathematics weâ€™ve been doing above (although <span class="math inline">\(df\)</span> is the same for the denominator and numerator, so we ignored them as they cancelled out)</p>
<p><span class="math display">\[
t= \sqrt{f} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \frac{(\sum{\bar{X_1} - \mu)/(N_1-1) - (\sum{\bar{X_2} - \mu)}/(N_2-1)}}{
((\sum{X_{1i} - \bar{X_1}}) +  (\sum{X_{2i} - \bar{X_2}}) )/(N-1)}= \frac{\sum{\bar{X_1}/N_1 - \sum{\bar{X_2}}/N_2}}{SE} =  \frac{\bar{X_1} - \bar{X_2}}{SE}
\]</span></p>
</section>
</section>
<section id="calculating-p-values-from-t-distributions" class="level2">
<h2 class="anchored" data-anchor-id="calculating-p-values-from-t-distributions">Calculating p-values from t-distributions</h2>
<p>Similar to the <a href="../distributions/normal.html#z-scores-and-the-z-distribution">normal distribution</a>, we can calculate how likely it is that you would get a t-value or higher (or lower) by drawing a t-distribution. A t-distribution is like a normal distribution (itâ€™s a bell curve), but also takes into account the number of participants using degrees of freedom (N-1). Here are the t-distributions you would get for 101, 21 and 6 participants:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">100</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">20</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">5</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="dv">4</span>, .<span class="dv">3</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"df=5"</span>, <span class="st">"df=20"</span>, <span class="st">"df=100"</span>),</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x values</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density curves for different degrees of freedom</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'df=100'</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'df=20'</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'df=5'</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set axis labels and plot title</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'T-Distribution Density Curves'</span>)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure5.png" class="img-fluid figure-img" width="650"></p>
<figcaption class="figure-caption">T-Distribution Density Curvesâ€™</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>We can see that the slopes get steeper the higher the <span class="math inline">\(df\)</span> is (i.e.&nbsp;the more participants you have). This means that the results become more significant even with the same t-value. Not convinced? Letâ€™s use a t-value of 2 to illustrate this. In the following figure you can see that the area under the curve for a t-value of 2 or more gets visually smaller the more participants/the higher the <span class="math inline">\(df\)</span> value is:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt,   <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">geom =</span> <span class="st">"area"</span>) <span class="sc">+</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">20</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">100</span>), <span class="at">color =</span> <span class="st">"green"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, xlim, geom_area, geom_line</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame with x values</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the  plot</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>), fill<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure6.png" class="img-fluid figure-img" width="650"></p>
<figcaption class="figure-caption">Figure with the area under the curve for a t-value of 2â€™</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Remember, area under the curve <strong>IS</strong> the p-value, so the area under the curve for a t-value of 2 or above for each degrees of freedom is:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># area under the curve for 2 and above</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">5</span>, </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05096974</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">20</span>, </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02963277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">100</span>, </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02410609</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>0.050969739414929105</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>0.02963276772328527</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>0.024106089365566796</code></pre>
</div>
</div>
</div>
<p>Note that if you wanted a 2-tailed test (i.e.&nbsp;you didnâ€™t have an expected direction of your finding) you would double the area under the curve/p-value.</p>
<p>Similar principles apply for an F-distribution, described next.</p>
</section>
<section id="calculating-p-values-from-f-distributions" class="level2">
<h2 class="anchored" data-anchor-id="calculating-p-values-from-f-distributions">Calculating p-values from f-distributions</h2>
<p>As F-values are based on the <strong>sum of squares</strong>, which are always positive, they cannot be negative. Also, F distributions can reflect more complex designs than t-distributions, such as comparisons of more than 2 levels. This means that they can have a variety of shapes. First, letâ€™s look at some distributions for designs with 2 conditions but differing numbers of participants:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">20</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label =</span> <span class="st">"df1 = 5, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 20, df2=1"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> f</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">5</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">20</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=5, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=20, df2=1"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure7.png" class="img-fluid figure-img" width="650"></p>
<figcaption class="figure-caption">F-Distribution Density Curvesâ€™</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The shape is roughly the same, but shifts slightly as you get more people. What happens if we look at distributions where there are about 100 people but 2 or more conditions (df2 = 2 or more).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">3</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=2"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=3"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">3</span>),</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=100, df2=2"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=3"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure8.png" class="img-fluid figure-img" width="650"></p>
<figcaption class="figure-caption">F-Distribution Density Curvesâ€™</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>In all cases, you get your p-value from calculating the area under the curve for that F-value or above.</p>
</section>
<section id="effect-sizes" class="level1">
<h1>Effect sizes</h1>
<section id="t-tests" class="level2">
<h2 class="anchored" data-anchor-id="t-tests">T-tests</h2>
<p>To capture how large the effect is, there are slightly different calculations when doing a within subject design (1 or 2 conditions that all participants complete) vs.&nbsp;a between subject design. In all cases these are Cohen <span class="math inline">\(d\)</span> calculations.</p>
<section id="one-sample-t-tests-1" class="level3">
<h3 class="anchored" data-anchor-id="one-sample-t-tests-1">One Sample T-tests</h3>
<p>The size of an effect is how big the difference is between the mean and the <span class="math inline">\(\mu\)</span> that you are comparing it to, compared to the standard deviation:</p>
<p><span class="math display">\[
d = \frac{\bar{x} - \mu}{SD(x)}
\]</span></p>
<p>The general benchmarks for how big or small a Cohenâ€™s <span class="math inline">\(d\)</span> value are as follows:</p>
<ul>
<li><p>.01 and below is very small (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
<li><p>.2 and below is small (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>.5 is medium (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>.8 is large (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>1.2 is very large (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
<li><p>2 is huge (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
</ul>
</section>
<section id="paired-sample-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="paired-sample-t-tests">Paired sample T-tests</h3>
<p>The size of an effect is how big the difference is between the conditions, compared to the standard deviation:</p>
<p><span class="math display">\[
d = \frac{\bar{x_1} - \bar{x_2}}{SD(x_1-x_2)}
\]</span></p>
<p>This actually can be thought of the same as one-sample t-tests after you take the step to calculate the difference between each value in <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> to make <span class="math inline">\(x_3\)</span> to compare to a <span class="math inline">\(\mu\)</span> of 0:</p>
<p><span class="math display">\[
x_3 = x_1 - x_2
\]</span> <span class="math display">\[
\mu = 0
\]</span> <span class="math display">\[
d = \frac{\bar{x_1}-\bar{x_2}}{SD(\bar{x_1}-\bar{x_2})} = \frac{\bar{x_3}}{SD(x_3)} = \frac{\bar{x_3}-\mu}{SD(x_3)}
\]</span></p>
</section>
<section id="independent-sample-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="independent-sample-t-tests">Independent Sample T-tests</h3>
<p>The formula for this is somewhat similar to that for a paired samples t-test, but because you are comparing between groups of participants you canâ€™t collapse the values between conditions because there are no pairings. So, you need to calculate the <em>pooled</em> standard deviation.</p>
<p><span class="math display">\[
SD_{pooled} = \sqrt{(SD(x_1)^2 + SD(x_1)^2)/2}
\]</span></p>
<p><span class="math display">\[
d = \frac{\bar{x_1}-\bar{x_2}}{SD_{pooled}}
\]</span></p>
</section>
</section>
<section id="f-tests" class="level2">
<h2 class="anchored" data-anchor-id="f-tests">F-tests</h2>
<p>The effect sizes for F-tests are based on how much variance is explained by the model, which sometimes is exactly the same as <span class="math inline">\(r^2\)</span>. Letâ€™s review some of the calculations above to confirm this:<br>
<span class="math display">\[
r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335
\]</span></p>
<p>If we run a linear model on the data we should also confirm the <span class="math inline">\(r^2\)</span> is .2335:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ contEffect, data = gapminder_americas_europe)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.6921  -2.1364   0.4494   2.5671   7.0449 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  75.6284     0.5028 150.416  &lt; 2e-16 ***
contEffect    2.0202     0.5028   4.018 0.000186 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.713 on 53 degrees of freedom
Multiple R-squared:  0.2335,    Adjusted R-squared:  0.219 
F-statistic: 16.14 on 1 and 53 DF,  p-value: 0.0001864</code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table4.png" height="300" class="figure-img"></p>
<figcaption class="figure-caption">Table</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Weâ€™ll use a function to confirm that this is the same for eta squared also:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">etaSquared</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              eta.sq eta.sq.part
contEffect 0.2334896   0.2334896</code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eta-squared</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> anova_lm(results)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>eta_squared <span class="op">=</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">/</span> (anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">+</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">1</span>])</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eta-squared (Î·Â²):"</span>, eta_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>Eta-squared (Î·Â²): 0.2334896271386854</code></pre>
</div>
</div>
</div>
<p>Boom, you got effect sizes for F-tests like ANOVAs.</p>
<p>If you have understood this page it will set you up for the pages on each type of ANOVA as it uses the same concepts again and again.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>