<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - T-Tests (R, Python incomplete)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../site_libs/viz-1.8.2/viz.js"></script>
<link href="../site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="../site_libs/grViz-binding-1.0.10/grViz.js"></script>
<link href="../site_libs/tippyjs-3.2.0/themes/google.css" rel="stylesheet">
<link href="../site_libs/tippyjs-3.2.0/themes/light-border.css" rel="stylesheet">
<link href="../site_libs/tippyjs-3.2.0/themes/light.css" rel="stylesheet">
<link href="../site_libs/tippyjs-3.2.0/themes/translucent.css" rel="stylesheet">
<script src="../site_libs/tippyjs-3.2.0/tippy.all.min.js"></script>
<script src="../site_libs/tippy-binding-0.1.0/tippy.js"></script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document">
 <span class="menu-text">Report an error</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications">
 <span class="menu-text">Request a clarification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content">
 <span class="menu-text">Suggest Content</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">T-Tests (R, Python incomplete)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Welcome</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">Installing R(Studio)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">R Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">Types of Scripts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">R Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">R Logic</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Statistics Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">Statistics Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">Scientific Notation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/probability.html" class="sidebar-item-text sidebar-link">Probability (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Describing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">Central Tendency (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">Dispersion (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Distributions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/binomial.html" class="sidebar-item-text sidebar-link">Binomial Distribution (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">Normal Distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">Skewness (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">Transforming Data (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Correlation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">Correlations (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/partialCorrelations.html" class="sidebar-item-text sidebar-link">Partial Correlations (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Regressions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">Simple regression (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">Multiple Regressions (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">General Linear Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link">General Linear Models and Sum of Squares (R, Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/TTests.html" class="sidebar-item-text sidebar-link active">T-Tests (R, Python incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/oneWayAnova.html" class="sidebar-item-text sidebar-link">One Way ANOVA (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/repeatedAnova.html" class="sidebar-item-text sidebar-link">Repeated Measures ANOVAs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/mixedAnova.html" class="sidebar-item-text sidebar-link">Mixed ANOVA (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/ancova.html" class="sidebar-item-text sidebar-link">ANCOVA (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Categorical</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../categorical/contingency.html" class="sidebar-item-text sidebar-link">Contingency (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">Item analyses</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../itemAnalyses/cronbachsAlpha.html" class="sidebar-item-text sidebar-link">Cronbach’s Alpha (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">Multiple testing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer.html" class="sidebar-item-text sidebar-link">Family-Wise Error (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fdr.html" class="sidebar-item-text sidebar-link">False Discovery Rate(R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer_vs_fdr.html" class="sidebar-item-text sidebar-link">FWER, FDR, Positive and Negative effects(R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">Permutations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permutations.html" class="sidebar-item-text sidebar-link">Permutations (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permVsTtest.html" class="sidebar-item-text sidebar-link">Permutation vs.&nbsp;t tests (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">Excel tutorial</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/formulas.html" class="sidebar-item-text sidebar-link">Formulas</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/if.html" class="sidebar-item-text sidebar-link">If function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/count.html" class="sidebar-item-text sidebar-link">Count and countifs function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/sum.html" class="sidebar-item-text sidebar-link">Sum and SumIf</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/averageIfs.html" class="sidebar-item-text sidebar-link">Averageifs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/anchoring.html" class="sidebar-item-text sidebar-link">Anchoring</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">Test yourself</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/allQuestions.html" class="sidebar-item-text sidebar-link">All questions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/questionMaker.html" class="sidebar-item-text sidebar-link">Question Maker</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#t-tests-and-anovas" id="toc-t-tests-and-anovas" class="nav-link active" data-scroll-target="#t-tests-and-anovas">T-tests and ANOVAs</a></li>
  <li><a href="#one-sample-t-tests" id="toc-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sample-t-tests">One-sample t-tests</a></li>
  <li><a href="#t-values-calculating-p-values-from-t-distributions" id="toc-t-values-calculating-p-values-from-t-distributions" class="nav-link" data-scroll-target="#t-values-calculating-p-values-from-t-distributions">T-values Calculating p-values from t-distributions</a></li>
  <li><a href="#calculating-p-values-from-f-distributions" id="toc-calculating-p-values-from-f-distributions" class="nav-link" data-scroll-target="#calculating-p-values-from-f-distributions">Calculating p-values from F-distributions</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a>
  <ul class="collapse">
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#anvoa-vs.-t-test-formula" id="toc-anvoa-vs.-t-test-formula" class="nav-link" data-scroll-target="#anvoa-vs.-t-test-formula">ANVOA vs.&nbsp;T-test formula</a></li>
  </ul></li>
  <li><a href="#paired-samples-t-tests" id="toc-paired-samples-t-tests" class="nav-link" data-scroll-target="#paired-samples-t-tests">Paired samples t-tests</a></li>
  <li><a href="#independent-samples-t-tests" id="toc-independent-samples-t-tests" class="nav-link" data-scroll-target="#independent-samples-t-tests">Independent Samples t-tests</a>
  <ul class="collapse">
  <li><a href="#anova-approach" id="toc-anova-approach" class="nav-link" data-scroll-target="#anova-approach">ANOVA approach</a></li>
  </ul></li>
  <li><a href="#this-should-be-brought-earlierxs" id="toc-this-should-be-brought-earlierxs" class="nav-link" data-scroll-target="#this-should-be-brought-earlierxs">this should be brought earlier!xs</a>
  <ul class="collapse">
  <li><a href="#anova-approach-vs-conventional-formula" id="toc-anova-approach-vs-conventional-formula" class="nav-link" data-scroll-target="#anova-approach-vs-conventional-formula">ANOVA approach vs conventional formula</a></li>
  <li><a href="#glm-approach-optional" id="toc-glm-approach-optional" class="nav-link" data-scroll-target="#glm-approach-optional">GLM approach (optional)</a>
  <ul class="collapse">
  <li><a href="#dummy-coding" id="toc-dummy-coding" class="nav-link" data-scroll-target="#dummy-coding">Dummy coding</a></li>
  <li><a href="#effect-coding" id="toc-effect-coding" class="nav-link" data-scroll-target="#effect-coding">Effect coding</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#effect-sizes" id="toc-effect-sizes" class="nav-link" data-scroll-target="#effect-sizes">Effect sizes</a>
  <ul class="collapse">
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests">T-tests</a>
  <ul class="collapse">
  <li><a href="#one-sample-t-tests-1" id="toc-one-sample-t-tests-1" class="nav-link" data-scroll-target="#one-sample-t-tests-1">One Sample T-tests</a></li>
  <li><a href="#paired-sample-t-tests" id="toc-paired-sample-t-tests" class="nav-link" data-scroll-target="#paired-sample-t-tests">Paired sample T-tests</a></li>
  <li><a href="#independent-sample-t-tests" id="toc-independent-sample-t-tests" class="nav-link" data-scroll-target="#independent-sample-t-tests">Independent Sample T-tests</a></li>
  </ul></li>
  <li><a href="#f-tests" id="toc-f-tests" class="nav-link" data-scroll-target="#f-tests">F-tests</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">T-Tests (R, Python incomplete)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<style>
#hide_show_button{
  position:fixed;
  right: 10px;
  top: 80px;
}
</style>
<button class="btn bi bi-arrows-angle-expand" id="hide_show_button" style="color: white; background-color:#006599">
Show/Hide all
</button>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Course Overview
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In this website you can choose to expand or shrink the page to match the level of understanding you want.</p>
<ul>
<li>If you do not expand any (green) subsections then you will only see the most superficial level of description about the statistics. If you expand the green subsections you will get details that are required to complete the tests, but perhaps not all the explanations for why the statistics work.</li>
</ul>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
An example of a green subsection
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<ul>
<li>If you expand the orange subsections you will also see some explanations that will give you a more complete understanding. If you are completing MSc-level statistics you would be expected to understand all the orange subsections.</li>
</ul>
<div class="callout-caution callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
An example of an orange subsection
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<ul>
<li>Red subsections will go deeper than what is expected at MSc level, such as testing higher level concepts.</li>
</ul>
<div class="callout-warning callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
An example of a red subsection
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b1fd0915f75bdd1e9f25" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b1fd0915f75bdd1e9f25">{"x":{"diagram":"\n  digraph \"Course Overview\" {\n  rankdir=TB;\n  fontname=\"Helvetica,Arial,sans-serif\"\n\tnode [fontname=\"Helvetica,Arial,sans-serif\"]\n\tedge [fontname=\"Helvetica,Arial,sans-serif\"]\n\tgraph [ newrank = true, nodesep = 0.25, ranksep = .5, overlap = false, splines = curve,]\n\tnode [ fixedsize = false, fillcolor = \"white\", fontsize = 24, height = 1, shape = box, style = \"filled,setlinewidth(5)\", width = 4]\n\tedge [arrowhead = none,arrowsize = 0.5,labelfontname = \"Ubuntu\",weight = 10,style = \"filled,setlinewidth(5)\"]\n\t\n\tsubgraph system {\n\t  \n\t\tnode [color = \"#006688\"]\n\t\tedge [color = \"#006688\"]\n\t\t\n\t\tancova              [fillcolor=\"white\",fontcolor=\"black\"label = \"ANCOVA\", URL = \"../GeneralLinearModels/ancova.html\"]\n    between_anova       [fillcolor=\"orange\",fontcolor=\"black\"label = \"One-way ANOVA\", URL = \"../GeneralLinearModels/oneWayAnova.html\"]\n\t\tbinomial            [fillcolor=\"white\",fontcolor=\"black\"URL = \"../distributions/binomial.html\", label = \"Binomial Distribution\"]\n\t\tcentral_tendency    [fillcolor=\"white\",fontcolor=\"black\"URL = \"../describingData/centralTendency.html\", fixedsize = true, label= \"Central Tendency\"]\n\t\t#cooksd[ label     = \"Cooks D\", URL       = \"\", fillcolor = red]\n\t\tcontingency         [fillcolor=\"white\",fontcolor=\"black\"URL = \"../categorical/contingency.html\", fixedsize = true, label = \"Contingency\"]\n\t\tcorrelations        [fillcolor=\"white\",fontcolor=\"black\"URL = \"../correlations/correlations.html\", fixedsize = true, label= \"Correlations\"]\n\t\tdispersion          [fillcolor=\"white\",fontcolor=\"black\"URL       = \"../describingData/dispersion.html\",label     = \"Dispersion\"]\n\t\tdummy_effect        [fillcolor=\"white\",fontcolor=\"black\"URL       = \"../describingData/dispersion.html\",label     = \"Dummy and Effect Coding\"]\n\t\tfdr                 [fillcolor=\"white\",fontcolor=\"black\"URL = \"../multipleTesting/fdr.html\",label = \"False Discovery Rate\"]\n\t  fwer                [fillcolor=\"white\",fontcolor=\"black\"URL = \"../multipleTesting/fwer.html\",label = \"Family-Wise Error Rate\"]\n    fwer_vs_fdr         [fillcolor=\"white\",fontcolor=\"black\"label = \"FWER vs. FDR\",URL = \"../multipleTesting/fwer_vs_fdr.html\"]\n    glm                 [fillcolor=\"white\",fontcolor=\"black\"URL       = \"../GeneralLinearModels/generalLinearModels.html\",label     = \"General Linear Models\"]\n    #kurtosis            [fillcolor=\"red\",fontcolor=\"black\"URL       = \"\",label     = \"Kurtosis\",fillcolor = \"red\"]\n    mediation           [fillcolor=\"red\",fontcolor=\"black\"URL = \"\",fillcolor = \"red\",label = \"Mediation\"]\n    mixed_anova         [fillcolor=\"orange\",fontcolor=\"black\"label = \"Mixed ANOVA\",URL = \"../GeneralLinearModels/mixedAnova.html\",]\n\t\tmultiple_regression [fillcolor=\"white\",fontcolor=\"black\"label     = \"Multiple Regression\",URL       = \"../regressions/multipleRegressions.html\"]\n\t\tnormal              [fillcolor=\"white\",fontcolor=\"black\"URL = \"../distributions/normal.html\", label= \"Normal Distribution\"]\n\t\tpartial_correlations[fillcolor=\"white\",fontcolor=\"black\"label =\"Partial Correlations\",URL = \"../correlations/partialCorrelations.html\",]\n\t\tpermutation         [fillcolor=\"white\",fontcolor=\"black\"label = \"Permutations\",URL = \"../permutations/permutations.html\",]\n\t\tprobability         [fillcolor=\"white\",fontcolor=\"black\"label = \"Probability\",URL = \"../statsBasics/probability.html\",fixedsize = true]\n\t\trep_measures_anova  [fillcolor=\"red\",fontcolor=\"black\"label = \"Repeated Measures\",URL = \"../GeneralLinearModels/repeatedAnova.html\",]\n\t\tsimple_regression   [fillcolor=\"white\",fontcolor=\"black\"label=\"Simple Regression\", URL = \"../regressions/simpleRegressions.html\",]\n\t\tskewness            [fillcolor=\"white\",fontcolor=\"black\"label = \"Skewness\", URL   = \"../distributions/skewness.html\"]\n\t\tstats_basics        [fillcolor=\"white\",fontcolor=\"black\"label = \"Statistics Basics\",URL   = \"../statsBasics/statsBasics.html\"]\n\t\ttransforming        [fillcolor=\"white\",fontcolor=\"black\" label = \"Transforming Data\", URL = \"../distributions/transforming.html\"]\n\t\tttests              [fillcolor=\"blue\",fontcolor=\"white\", label = \"T-Tests\", URL = \"../GeneralLinearModels/TTests.html\",]\n\t}\n\t/* connections */\n\tbetween_anova -> ancova\n\tbinomial -> contingency\n\tbinomial -> normal[\n    #style = \"dashed\",\n    #row = func\n\t]\n\tcentral_tendency -> dispersion\n\t#correlations -> cooksd\n\tcorrelations -> partial_correlations\n\tcorrelations -> simple_regression\n\tdispersion -> normal\n\tdummy_effect -> multiple_regression\n\tdummy_effect -> ttests\n\tfdr -> fwer_vs_fdr\n\tfwer -> fwer_vs_fdr\n\tglm -> ttests\n  mixed_anova -> ancova\n\tmultiple_regression -> mediation\n\tnormal -> correlations\n\tnormal -> contingency\n\tnormal -> glm\n\t#normal -> kurtosis\n\tnormal -> skewness[\n    #style = \"dashed\",\n    #row = func\n\t]\n\tsimple_regression -> multiple_regression\n\tsimple_regression -> dummy_effect\n\tskewness -> transforming\n\ttransforming -> correlations\n\tprobability -> contingency\n\tprobability -> fwer\n\tprobability -> fdr\n\trep_measures_anova -> ancova\n\tstats_basics -> central_tendency\n\tstats_basics -> probability\n\tttests -> mixed_anova\n\tttests -> between_anova\n\tttests -> rep_measures_anova\n\t\n\t\n\t\n  # edge[ style = invis ];\n  ancova -> permutation\n  rep_measures_anova -> permutation\n  between_anova -> permutation\n  correlations -> permutation\n  #mediation -> permutation  [\n  #  style = \"dashed\",\n    #row = func\n\t#] \n  #multiple_regression -> permutation  [\n  #  style = \"dashed\",\n  #  #row = func\n\t#] \n  #partial_correlations -> permutation\n  #simple_regression -> permutation  [\n  #  style = \"dashed\",\n  #  #row = func\n\t#] \n  ttests -> permutation\n}\n  ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><span style="color:red"><strong>Red</strong></span> means that the page does not exist yet</p>
<p><span style="color:orange"><strong>Orange</strong></span> means that the page is started</p>
</div>
</div>
</div>
<script>
document.getElementById("hide_show_button").onclick = function(){
  //alert('hi');
  // select all elements with the data-bs-toggle attribute
  const elements = document.querySelectorAll('[data-bs-toggle]');

  // loop through the elements and toggle their collapsed state
  elements.forEach(element => {
    const isCollapsed = element.classList.contains('collapsed');
    //if (!isCollapsed) {
      element.click();
    //}
  });
}
</script>
<section id="t-tests-and-anovas" class="level2">
<h2 class="anchored" data-anchor-id="t-tests-and-anovas">T-tests and ANOVAs</h2>
<p>T-tests use the same underlying mathematics as ANOVAs. There is an argument that it’s better to just use the ANOVA mathematics as this will allow you more flexibility in future to do more complex analyses. Expand this for insights into the ANOVA concepts and how they overlap with t-tests.</p>
<div class="callout-caution callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand this for insights into the ANOVA concepts and how they overlap with t-tests.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the tests below we will frequently come across the following concepts:</p>
<p><strong>Total sum of squares</strong> represents all the variance around the mean. We create models to try to explain why data points are different to the mean.</p>
<p><strong>Explained sum of squares</strong> represents the variance around the mean that is explained by your model.</p>
<p><strong>Unexplained variance</strong> represents whatever variance around the mean that isn’t explained by your model. Sometimes the word <strong>residual</strong> or <strong>error</strong> is used to capture the difference between the predicted value of a data point (i.e.&nbsp;what would be <strong>explained</strong> by the model) and the actual data point (the difference being <strong>unexplained</strong>).</p>
<p>We summarise this ratio of <strong>explained</strong> vs.&nbsp;<strong>unexplained</strong> variance using an F value:</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}}
\]</span></p>
<ul>
<li><p><span class="math inline">\(SS_{explained}\)</span> is explained sum of squares</p></li>
<li><p><span class="math inline">\(SS_{unexplained}\)</span> is the unexplained sum of squares</p></li>
<li><p><span class="math inline">\(df_{explained}\)</span> is the <strong>degrees of freedom (df)</strong> for the model explaining the variance. This is generally the number of levels in your model minus 1. For example, if you were testing if life expectancy is explained by which continent a country is in, then the number of levels is the number of continents in your analysis (e.g.&nbsp;5 continents), and the <strong>df</strong> would be 5-1=4. The <strong>df</strong> is used to address <a href="../describingData/dispersion.html#degrees-of-freedom">uncertainty because we are using a sample to estimate a population</a>, but you don’t need to understand this to continue on this page.</p></li>
<li><p><span class="math inline">\(df_{unexplained}\)</span> is the <strong>degrees of freedom (df)</strong> that is not addressed by the model. Generally this is the number of subjects minus 1. Using the above example about continents and life expectancy, each subject could be one of 142 countries in your analysis, and so the <strong>df</strong> would be 142-1=141.</p></li>
</ul>
<p>The key points in the above formula are:</p>
<ul>
<li><p>The better your model is the more Sum of Squares will be explained, which will increase F</p></li>
<li><p>The more data points (e.g.&nbsp;subjects) you have, the higher your <span class="math inline">\(df_{unexplained}\)</span> will be, which will also increase F</p></li>
</ul>
</div>
</div>
</div>
<div class="callout-warning callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
How F-values for a test with 2 levels can be simplified to calculate a t-value
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>On this page we will be focusing on simpler analyses that only compare between 2 conditions, which means <span class="math inline">\(df_{explained}\)</span> will be (2-1=) 1, which simplifies the above formula:</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{SS_{explained}/1}{SS_{unexplained}/df_{unexplained}} = \frac{SS_{explained}}{SS_{unexplained}/df_{unexplained}}
\]</span></p>
<p>This allows us to complete simpler analyses to calculate <span class="math inline">\(t\)</span> values, which are the square root of <span class="math inline">\(F\)</span>:</p>
<p><span class="math display">\[
t = \sqrt{F} = \sqrt{\frac{SS_{explained}}{SS_{unexplained}/df_{unexplained}}}
\]</span></p>
</div>
</div>
</div>
<p><span class="math inline">\(t\)</span> values are used for <span class="math inline">\(t\)</span>-tests, which we’ll address below.</p>
</section>
<section id="one-sample-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-tests">One-sample t-tests</h2>
<p>One-sample t-tests test whether your sample’s values are significantly higher or lower than a pre-specified value (<span class="math inline">\(\mu\)</span>). You can do this by seeing how big the difference is between the <strong>mean in your sample</strong> (<span class="math inline">\(\bar{x}\)</span>) and the <span class="math inline">\(\mu\)</span>, when taking into account the general variance in your data and the number of participants you have.</p>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Formula for a one-sample t-test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>One sample t-tests try to explain whether variance of data is better explained around one specific value (sample mean <span class="math inline">\(\bar{x}\)</span>) compared to another (previously assumed value <span class="math inline">\(\mu\)</span>), when compared to the general variance in the data ( <span class="math inline">\(\sigma/\sqrt{N}\)</span> explained more below).</p>
<p><span class="math display">\[
t_{oneSample}=\frac{\bar{x} - \mu}{\sigma/\sqrt{N} }
\]</span></p>
<p>For example, imagine that you wanted to test whether life expectancy is higher than 55 across the world:</p>
<ul>
<li><p>Your <span class="math inline">\(\mu\)</span> would be 55. This can be thought of as the assumed population mean that we want to use our sample to test.</p></li>
<li><p>Your <span class="math inline">\(\bar{x}\)</span> would be the sample mean.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
An example of a one-sample t-test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s visualise these values using gapminder data from 2007:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_2007, <span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>lifeExp)) <span class="sc">+</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">55</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">55</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Mu"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Sample Mean"</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the gapminder module and import the gapminder dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gapminder <span class="im">import</span> gapminder</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new data frame that only focuses on data from 2007</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="op">=</span> gapminder.loc[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create the scatterplot with some jitter</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">"year"</span>, y<span class="op">=</span><span class="st">'lifeExp'</span>, data<span class="op">=</span>gapminder_2007, dodge<span class="op">=</span><span class="va">True</span>, jitter<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for Mu</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">55</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Mu'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for the mean of 'lifeExp'</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_2007[<span class="st">'lifeExp'</span>].mean(), color<span class="op">=</span><span class="st">'g'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the label on the x-axis</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">""</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the tick on the x-axis</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># add the legend </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># show the plot</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure1.png" class="img-fluid figure-img" alt="Scatterplot with Mu and Sample Mean of 'Life expectancy'" width="650"></p>
<p></p><figcaption class="figure-caption">Scatterplot with Mu and Sample Mean of ‘Life expectancy’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>So the t-value will reflect how significantly higher or lower the sample mean (<span class="math inline">\(\bar{x}\)</span>) is than the assumed population mean (<span class="math inline">\(\mu\)</span>). Let’s apply the data from our data to the general formula:</p>
<p><span class="math display">\[
t_{oneSample}=\frac{\bar{x} - \mu}{\sigma/\sqrt{N}} = \frac{67.00742-55}{12.07302/\sqrt{142}} = 11.85163
\]</span></p>
<p>Let’s confirm that we get the same t-value using a function:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-statistic</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="at">mu=</span><span class="dv">55</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  gapminder_2007$lifeExp
t = 11.852, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 55
95 percent confidence interval:
 65.00450 69.01034
sample estimates:
mean of x 
 67.00742 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2007[<span class="st">'lifeExp'</span>], popmean<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>t-statistic: 11.851628442323024
p-value: 6.463174215427706e-23</code></pre>
</div>
</div>
</div>
<p>We can see that the t-value we calculated is the same as calculated by functions (once you take into account rounding numbers). You may have noticed that there is also a p-value associated with t-tests that is <strong>very</strong> small, suggesting that it is very unlikely that our sample would have such high life expectancy if the <span class="math inline">\(\mu\)</span> was correct, i.e.&nbsp;if the life expectancy across countries was actually 55 years old. So, the next question is how do we calculate p-values like this using t-values?</p>
</div>
</div>
</div>
</section>
<section id="t-values-calculating-p-values-from-t-distributions" class="level2">
<h2 class="anchored" data-anchor-id="t-values-calculating-p-values-from-t-distributions">T-values Calculating p-values from t-distributions</h2>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
T-values can be used to calculate p-values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<section id="section" class="level2 callout-body-container callout-body">
<h2 class="anchored" data-anchor-id="section"></h2>
<p>Similar to the <a href="../distributions/normal.html#z-scores-and-the-z-distribution">normal distribution</a>, we can calculate how likely it is that you would get a t-value or higher (or lower) by drawing a t-distribution. A t-distribution is like a normal distribution (it’s a bell curve), but also takes into account the number of participants (or data points) using degrees of freedom (N-1). Here are the t-distributions you would get for 101, 21 and 6 participants:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">100</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">20</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">5</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="dv">4</span>, .<span class="dv">3</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"df=5"</span>, <span class="st">"df=20"</span>, <span class="st">"df=100"</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x values</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density curves for different degrees of freedom</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'df=100'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'df=20'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'df=5'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set axis labels and plot title</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'T-Distribution Density Curves'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure5.png" class="img-fluid figure-img" alt="T-Distribution Density Curves'" width="650"></p>
<p></p><figcaption class="figure-caption">T-Distribution Density Curves’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>We can see that the slopes get steeper the higher the <span class="math inline">\(df\)</span> is (i.e.&nbsp;the more participants you have). This means that the results become more significant even with the same t-value. Not convinced? Let’s use a t-value of 2 to illustrate this. In the following figure you can see that the area under the curve for a t-value of 2 or more gets visually smaller the more participants/the higher the <span class="math inline">\(df\)</span> value is:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt,   <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">geom =</span> <span class="st">"area"</span>) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">20</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">100</span>), <span class="at">color =</span> <span class="st">"green"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, xlim, geom_area, geom_line</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame with x values</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the  plot</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>), fill<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure6.png" class="img-fluid figure-img" alt="Figure with the area under the curve for a t-value of 2'" width="650"></p>
<p></p><figcaption class="figure-caption">Figure with the area under the curve for a t-value of 2’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>Remember, area under the curve <strong>IS</strong> the p-value, so the area under the curve for a t-value of 2 or above for each degrees of freedom is:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># area under the curve for 2 and above</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">5</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05096974</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">20</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02963277</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">100</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02410609</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>0.050969739414929105</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>0.02963276772328527</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>area_above_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>0.024106089365566796</code></pre>
</div>
</div>
</div>
<p>Note that if you wanted a 2-tailed test (i.e.&nbsp;you didn’t have an expected direction of your finding) you would double the area under the curve/p-value.</p>
<p>Similar principles apply for an F-distribution, described next.</p>
</section>
</div>
</div>
</section>
<section id="calculating-p-values-from-f-distributions" class="level2">
<h2 class="anchored" data-anchor-id="calculating-p-values-from-f-distributions">Calculating p-values from F-distributions</h2>
<p>As F-values are based on the <strong>sum of squares</strong>, which are always positive, they cannot be negative. Also, F distributions can reflect more complex designs than t-distributions, such as having both <strong>explained</strong> and <strong>unexplained</strong> degrees of freedom. This means that they can have a variety of shapes to reflect these differences in degrees of freedom. First, let’s look at some distributions for designs with 2 conditions but differing numbers of participants:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">20</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label =</span> <span class="st">"df1 = 5, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 20, df2=1"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> f</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">5</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">20</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=5, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=20, df2=1"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure7.png" class="img-fluid figure-img" width="650"></p>
<p></p><figcaption class="figure-caption">F-Distribution Density Curves’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>The shape is roughly the same, but shifts slightly as you get more people. What happens if we look at distributions where there are about 100 people but 2 or more conditions (df2 = 2 or more).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">3</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=2"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=3"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TTests_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">3</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=100, df2=2"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=3"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure8.png" class="img-fluid figure-img" width="650"></p>
<p></p><figcaption class="figure-caption">F-Distribution Density Curves’</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>In all cases, you get your p-value from calculating the area under the curve for that F-value or above.</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
F-value approach (AKA General Linear Model (GLM) approach)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
internal callout
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>beep bop</p>
</div>
</div>
</div>
<p>To calculate the F-Value, we want to create a model that captures <strong>explained variance</strong> and <strong>unexplained variance</strong>. This model will aim to explain any variance around the population mean (mu or <span class="math inline">\(\mu\)</span>). The sample mean could be modeled as such:</p>
<p><span class="math display">\[
y = \bar{y} + e
\]</span></p>
<ul>
<li><p><span class="math inline">\(y\)</span> is the data point value you are trying to predict.</p></li>
<li><p><span class="math inline">\(\bar{y}\)</span> is mean of all y data points. Note that for this formula you will <strong>always</strong> have the same predicted outcome (the mean).</p></li>
<li><p><span class="math inline">\(e\)</span> is the error, i.e.&nbsp;the residuals that the module do not predict effectively.</p></li>
</ul>
<p>If the sample mean is a useful model, then it will explain a large proportion of the variance around the <span id="population_tippy" style="color:#006688">Mu</span> (<span class="math inline">\(\mu\)</span>) and will also suggested that there is significant reason to reject the <span class="math inline">\(\mu\)</span> as the real mean of your population.</p>
<div class="cell">
<div class="cell-output-display">
<span class="tippy html-widget html-fill-item-overflow-hidden html-fill-item" height="464px" id="htmlwidget-91f1813513023c8d54fb" width="100%"></span>
<script type="application/json" data-for="htmlwidget-91f1813513023c8d54fb">{"x":{"element":"population_tippy","opts":{"content":"Baseline value"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>First, we need to capture how much variance there is around the <span class="math inline">\(\mu\)</span>, which we’ll do using sum of squares:</p>
<p><span class="math display">\[
SS_{total} = \sum(y_i-\mu)^2
\]</span></p>
<ul>
<li><span class="math inline">\(y_i\)</span> is an individual data point</li>
</ul>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<p>Which for the above data would give us:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="dv">55</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41025.16</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the squared dfference</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> <span class="dv">55</span>) <span class="op">**</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>41025.157014</code></pre>
</div>
</div>
</div>
<p>So we have to explain 41025.16 in variance around the <span class="math inline">\(\mu\)</span>.</p>
<p>Our model’s explanation of variance around the <span class="math inline">\(\mu\)</span> is the sample mean (<span class="math inline">\(\bar{y}\)</span>). For each data point the variance explained (from the <span class="math inline">\(mu\)</span>) is the difference between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\bar{y}\)</span>, and then that leaves the unexplained variance (from the <span class="math inline">\(mu\)</span>) as the difference between the data point and the sample mean (<span class="math inline">\(\bar{y}\)</span>). If we visualise this for a single data point it should look something like:</p>
<p><img src="mu_vs_mean/Slide1.png" class="img-fluid"></p>
<p>For the above data point the variance (around the <span class="math inline">\(\mu\)</span>) explained is <span class="math inline">\(\bar{y} - \mu = 67.007 - 55 = 22.007\)</span>. However, we can see that the model isn’t perfect for this data point, and so there is a residual left over, i.e.&nbsp;a difference between the predicted value of 67.007 and the actual value of 58.04, meaning the unexplained variance is <span class="math inline">\(67.007 - 58.04 = 8.967\)</span>.</p>
<p>Your explained variance by this model is thus a repetition of comparisons of the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\bar{y}\)</span> as many times as there are data points (and squaring this difference to make the values positive):</p>
<p><span class="math display">\[
SS_{explained} = N * (\mu - \bar{x})^2
\]</span></p>
<p>Which for the above data would give us:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20473.3</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span>( <span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean())<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>20473.303823352093</code></pre>
</div>
</div>
</div>
<p>As described above, unexplained variance is the residuals around the sample mean, as this is variance that is not explained by the model. We can summarise what we get when we calculate the sum of squares of these residuals around the sample mean as follows:</p>
<p><span class="math display">\[
SS_{unexplained} = \sum(x_i-\bar{x})^2
\]</span></p>
<p>Which for the above data would give us</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20551.85</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>20551.853190647882</code></pre>
</div>
</div>
</div>
<p>To capture the effectiveness of the model we can calculate the F-value:</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{20473.3/(Predictors)}{20551.85/(N-1)} = \frac{20473.3/1}{20551.85/141}
\]</span></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>f_value <span class="ot">=</span> (<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>f_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 140.4611</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences between each value in 'lifeExp' and the mean</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span> (<span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences within groups</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the degrees of freedom for between groups and within groups</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>df_between <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>df_within <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the F-statistic</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>f_value <span class="op">=</span> (ss_between <span class="op">/</span> df_between) <span class="op">/</span> (ss_within <span class="op">/</span> df_within)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>140.46109673488004</code></pre>
</div>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3"></h3>
</section>
</div>
</div>
</div>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4"></h3>
</section>
<section id="anvoa-vs.-t-test-formula" class="level3">
<h3 class="anchored" data-anchor-id="anvoa-vs.-t-test-formula">ANVOA vs.&nbsp;T-test formula</h3>
<p>Great. So now that we’ve highlighted the GLM approach works for t-tests, can we see how our formula for a GLM simplifies to the formula we usually use for one-sample t-tests:</p>
<p><span class="math display">\[
T = \sqrt{F} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \sqrt{\frac{N * (\mu - \bar{x})^2/(levelsOfPredictors - 1)}{\sum(x_i-\bar{x})^2/(N-1)}} =
\]</span></p>
<p><span class="math display">\[
\sqrt{\frac{N * (\mu - \bar{x})^2/(2-1)}{\sigma^2}} = \frac{\sqrt{N * (\mu - \bar{x})^2}}{\sqrt{\sigma^2}} = \frac{\sqrt{(\mu - \bar{x})^2}}{\sigma/\sqrt{N}} = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}
\]</span> where:</p>
<ul>
<li><span class="math inline">\(T\)</span> is the t-value</li>
<li><span class="math inline">\(F\)</span> is the f-value</li>
<li><span class="math inline">\(SS_{exp}\)</span> is the sum of squares of the data explained by the model</li>
<li><span class="math inline">\(SS_{unexp}\)</span> is the sum of squares of the data not explained by the model (i.e.&nbsp;the residuals)</li>
<li><span class="math inline">\(df_{exp}\)</span> is the degrees of freedom for the model. As there is only one predictor (the sample mean) and it’s only got 2 levels (1 or 0, however, in all cases the model is comparing the data to the mean, so it’s less intuitive that there are 2 levels).</li>
</ul>
<p>To confirm, the formula for a one-sample t-test is just:</p>
<p><span class="math display">\[
T = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}
\]</span></p>
<p>F-values are squares of t-values, so let’s see if this is true here also:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.85163</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="at">mu=</span><span class="dv">55</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  gapminder_2007$lifeExp
t = 11.852, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 55
95 percent confidence interval:
 65.00450 69.01034
sample estimates:
mean of x 
 67.00742 </code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the square root of the F-value</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>np.sqrt(f_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>11.851628442323022</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2007[<span class="st">'lifeExp'</span>], popmean<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>t-statistic: 11.851628442323024
p-value: 6.463174215427706e-23</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="paired-samples-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples-t-tests">Paired samples t-tests</h2>
<p>Paired samples t-tests can be approached like 1-sample t-tests, but you first of all need to collapse the data to have a single variable to compare to a <span class="math inline">\(\mu\)</span> of zero. Let’s do this for gapminder data, comparing life expectancy between 2002 and 2007:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>] <span class="sc">-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2002_2007_life_exp, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  gapminder_2002_2007_life_exp
t = 14.665, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 1.135561 1.489439
sample estimates:
mean of x 
   1.3125 </code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="op">=</span> life_exp_2007.reset_index(drop<span class="op">=</span><span class="va">True</span>) <span class="op">-</span> life_exp_2002.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2002_2007_life_exp, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>t-statistic: 14.664513524875451
p-value: 3.738316746290281e-30</code></pre>
</div>
</div>
</div>
<p>The above suggests that life expectancy was significantly different. Let’s see if we get the exact same value when we use a paired t-test in R:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>],gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>], <span class="at">paired=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  gapminder$lifeExp[gapminder$year == 2007] and gapminder$lifeExp[gapminder$year == 2002]
t = 14.665, df = 141, p-value &lt; 2.2e-16
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 1.135561 1.489439
sample estimates:
mean difference 
         1.3125 </code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2007</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>life_exp_2007 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2002</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>life_exp_2002 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2002</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a paired t-test</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_rel(life_exp_2007, life_exp_2002)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"T-statistic:"</span>, t_statistic)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"P-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>t-statistic: 14.664513524875451
p-value: 3.738316746290281e-30</code></pre>
</div>
</div>
</div>
<p>Looks identical. Let’s compare formulas to see why this is ( <span class="math inline">\(\mu\)</span> = 0 , and so it isn’t written) :</p>
<p><span class="math display">\[
t_{paired} = \frac{\bar{x_1} - \bar{x_2}}{\sigma_{pooled}/\sqrt{N}} = \frac{\bar{x_3}}{\sigma_{pooled}/\sqrt{N}}
\]</span></p>
<p>Where</p>
<ul>
<li><p><span class="math inline">\(\bar{x_1}\)</span> is the mean of condition 1</p></li>
<li><p><span class="math inline">\(\bar{x_2}\)</span> is the mean of condition 2</p></li>
<li><p><span class="math inline">\(\bar{x_3}\)</span> is the mean of the result you get when you subtract condition 2 from condition 1 for each participant, i.e.&nbsp;<span class="math inline">\(mean(x_1-x_2)\)</span>.</p></li>
<li><p><span class="math display">\[
\sigma_{pooled}  = \sqrt{\frac{\sigma_1^2 + \sigma_2^2}{2}} OR \frac{\sum(x_1 - x_2)^2}{N-1}
\]</span> One way effectively gets the average of the standard deviations of condition and 1. The second way gets the standard deviation of the differences between conditions 1 and 2. Both give you the same outcome.</p></li>
<li><p><span class="math inline">\(N\)</span> is the number of participants</p></li>
</ul>
<p>You can rewrite the above formula to compare <span class="math inline">\(\bar{x_3}\)</span> to <span class="math inline">\(\mu\)</span>, as we know <span class="math inline">\(\mu\)</span> is zero, which would make this formula (effectively) identical to the one above for one-sample t-tests:</p>
<p><span class="math display">\[
\frac{\bar{x_3} - \mu}{\sigma_{pooled}/\sqrt{N}}
\]</span></p>
<p>The following explains how to calculate F if analysing your data as a model. This isn’t necessary if you just want to complete a t-test, but does help clarify how t-tests overlap with ANOVAs and regressions.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
F and value
</div>
</div>
<div class="callout-body-container callout-body">
<p>To calculate the F value we will use the following formula:</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}}
\]</span></p>
<p>So the question is, what is our model, and what is explained and what is not explained by it. Our model is that life expectancy is explained by year. We predict that any difference between 2002 and 2007 in life expectancy in <strong><em>any</em></strong> country’s is the <strong><em>mean</em></strong> life expectancy difference across all countries. The sum of squares thus is the mean difference between 2007 and 2002’s life expectancy multiplied by the number of countries:</p>
<p><span class="math display">\[
SS_{explained} = \sum_{country}{{((\bar{lifeExp}_{2007} - \bar{lifeExp}_{2002}})^2)} = ((\bar{lifeExp}_{2007} - \bar{lifeExp}_{2002})^2) * N_{countries}
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">2002</span>) <span class="ot">-&gt;</span> gapminder_2007_2002</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>explained_ss <span class="ot">=</span> ((<span class="fu">mean</span>(gapminder_2007_2002<span class="sc">$</span>lifeExp[gapminder_2007_2002<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>]) <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007_2002<span class="sc">$</span>lifeExp[gapminder_2007_2002<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>]))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(gapminder_2007_2002<span class="sc">$</span>country))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>explained_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 244.6172</code></pre>
</div>
</div>
<p><span class="math display">\[
SS_{unexplained} = SS_{total} - SS_{explained}
\]</span></p>
<p>So we need to calculate the total Sum of Squares, which is all variance between 2002 and 2007 for each country (squared):</p>
<p><span class="math display">\[
SS_{total} = \sum{((lifeExp_{2007} - lifeExp_{2002})^2)}
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># restructuring data to simplify processing</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>gapminder_2007_2002 <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>year, <span class="at">values_from =</span> lifeExp)  <span class="ot">-&gt;</span> gapminder_wide</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>total_ss <span class="ot">=</span> <span class="fu">sum</span>((gapminder_wide[[<span class="st">"2002"</span>]] <span class="sc">-</span> gapminder_wide[[<span class="st">"2007"</span>]])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>total_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 405.0048</code></pre>
</div>
</div>
<p>To calculate the unexplained variance, let’s subtract the explained from total sum of squares</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>unexplained_ss <span class="ot">=</span> total_ss <span class="sc">-</span> explained_ss</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>unexplained_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 160.3876</code></pre>
</div>
</div>
<p>Now we can complete the above formula taking into account the explained degrees of freedom is 1 (2 levels -1 = 1), and the unexplained degrees of freedom is 141 (142 countries - 1 = 141):</p>
<p><span class="math display">\[
F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{244.6172/1}{160.3876/141} = 215.048
\]</span></p>
<p>Let’s check if this is the same value we get using a function:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ez<span class="sc">::</span><span class="fu">ezANOVA</span>(gapminder_2007_2002, <span class="at">within =</span> year, <span class="at">dv=</span> lifeExp, <span class="at">wid =</span> country)<span class="sc">$</span>ANOVA<span class="sc">$</span>F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: "year" will be treated as numeric.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There is at least one numeric within variable, therefore aov() will be
used for computation and no assumption checks will be obtained.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 215.048</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="independent-samples-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="independent-samples-t-tests">Independent Samples t-tests</h2>
<section id="anova-approach" class="level3">
<h3 class="anchored" data-anchor-id="anova-approach">ANOVA approach</h3>
<p>T-tests are restricted to comparisons between 2 conditions/groups, so we will restrict the Gapminder data to allow a comparison between 2 continents. To see if life expectancy was different if you are born in Europe compared to the Americas, let’s first check what the sum of squares is when you just use the <strong>mean</strong> as the model of life expectancy <strong>across</strong> these contents (so we’re <strong>not</strong> separating by continent yet):</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007,   <span class="co"># the data set</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mean-life-exp-resid-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-mean-life-exp-resid-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: The errors around the mean of life expectancy across Europe and American countries</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>].rank()</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], gapminder_americas_europe[<span class="st">"lifeExp"</span>], color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'blue'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>], ymax<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure2.png" width="700" height="500" class="figure-img"></p>
<p></p><figcaption class="figure-caption"><em>Fig. 3.</em> The errors around the mean of life expectancy across Europe and American countries.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>Once we square the errors in the pink lines above, we’ll get the <strong>squares:</strong></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 953.4478</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-mean-life-exp-resid-squared-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-mean-life-exp-resid-squared-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: The squared errors around the mean of life expectancy across Europe and American countries</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], (gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"(Life Expectancy - mean(Life Expectancy))^2"</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure3.png" width="700" height="500" class="figure-img"></p>
<p></p><figcaption class="figure-caption">The squared errors around the mean of life expectancy across Europe and American countries</figcaption><p></p>
</figure>
</div>
<pre><code>953.4477649818183</code></pre>
</div>
</div>
</div>
<p>And when you add all of these together:</p>
<p><span class="math display">\[
SumOfSquares = \sum(Y_i-\bar{Y})^2 = 953.4478
\]</span></p>
</section>
</section>
<section id="this-should-be-brought-earlierxs" class="level1">
<h1>this should be brought earlier!xs</h1>
<p>So the aim is to create models that explain the total sum of squares above.</p>
<p>So if the model we create for a t-test would result in a smaller <strong>sum of squares</strong> then that suggests it’s a more precise model for estimating life expectancy than simply using the <strong>mean</strong> as a model. This is because this would mean there’s less <strong>error</strong> in this model. Let’s model this using a t-test. For this we will need to effect code continent:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a column to place 1 or -1 for each row dependent on the country</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>contEffect <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">=</span> <span class="fu">cbind</span>(contEffect,gapminder_americas_europe)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contEffect"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["country"],"name":[2],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[6],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"Albania","3":"Europe","4":"2007","5":"76.423","6":"3600523","7":"5937.030","_rn_":"1"},{"1":"-1","2":"Argentina","3":"Americas","4":"2007","5":"75.320","6":"40301927","7":"12779.380","_rn_":"2"},{"1":"1","2":"Austria","3":"Europe","4":"2007","5":"79.829","6":"8199783","7":"36126.493","_rn_":"3"},{"1":"1","2":"Belgium","3":"Europe","4":"2007","5":"79.441","6":"10392226","7":"33692.605","_rn_":"4"},{"1":"-1","2":"Bolivia","3":"Americas","4":"2007","5":"65.554","6":"9119152","7":"3822.137","_rn_":"5"},{"1":"1","2":"Bosnia and Herzegovina","3":"Europe","4":"2007","5":"74.852","6":"4552198","7":"7446.299","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> cols[<span class="bu">len</span>(cols)<span class="op">-</span><span class="dv">1</span>:<span class="bu">len</span>(cols):<span class="dv">1</span>]<span class="op">+</span>cols[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">1</span>]</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_americas_europe[cols]</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(gapminder_americas_europe[:<span class="dv">6</span>], headers<span class="op">=</span>gapminder_americas_europe.head(), tablefmt<span class="op">=</span><span class="st">"fancy_grid"</span>,showindex<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table2.png" height="300" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Table</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>Now that we have effect coded the continent, we can create a new model to try to predict an individual’s life expectancy based on which continent they are from</p>
<p><span class="math display">\[
Y = intercept + \beta * effectVariable + Error
\]</span></p>
<p>Which in our case means:</p>
<p><span class="math display">\[
lifeExp = mean(lifeExp) + \beta * contEffect + Error
\]</span></p>
<ul>
<li><p>Y being the predicted life expectancy.</p></li>
<li><p><span class="math inline">\(\bar{Y}\)</span> being the mean life expectancy regardless of continent. For a t-test this is also the <span class="math inline">\(intercept\)</span>.</p></li>
<li><p><span class="math inline">\(\beta\)</span> being how much to adjust the prediction based on which continent the person is from</p></li>
<li><p><span class="math inline">\(contEffect\)</span> being 1 (Europe) or -1 (Americas) to reflect which continent the participant is from</p></li>
<li><p><span class="math inline">\(Error\)</span> being any error in the prediction not captured by the model</p></li>
</ul>
<p>To get the <span class="math inline">\(intercept\)</span> and <span class="math inline">\(\beta\)</span> for the above formula let’s use linear model functions:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   75.62836 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>contEffect 
   2.02024 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_fit <span class="ot">=</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> <span class="co"># intercept</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]                       <span class="sc">*</span> <span class="co"># gradient</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>contEffect</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x =</span> contEffect, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> contEffect,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> t_fit,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.9</span>, </span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>, </span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">-</span> <span class="fl">1.9</span>,</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>,</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"dark green"</span></span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-model-life-exp-mean-2-continents" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TTests_files/figure-html/fig-model-life-exp-mean-2-continents-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Plot with the errors around the mean of life expectancy across Europe and American countries.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'contEffect' to type category</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">'contEffect'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lm 'contEffect' ~ 'lifeExp'</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="op">=</span> stats.linregress(gapminder_americas_europe[<span class="st">'contEffect'</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>])</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show results of lm</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>continent_ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>LinregressResult(slope=2.020240000000001, intercept=75.62836, rvalue=0.4832076439158285, pvalue=0.00018637488941351192, stderr=0.502794193121279, intercept_stderr=0.5027941931212789)</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_fit'</span>] <span class="op">=</span> continent_ttest.intercept <span class="op">+</span>continent_ttest.slope <span class="op">*</span> gapminder_americas_europe[<span class="st">'contEffect'</span>]</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_res_square'</span>] <span class="op">=</span> (gapminder_americas_europe[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_americas_europe[<span class="st">'t_fit'</span>])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span>np.repeat(m1, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span>np.repeat(m2, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==-1</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.98</span>, <span class="op">-</span><span class="fl">.05</span>, <span class="fl">0.08</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==1</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="fl">0.05</span>, <span class="fl">1.98</span>, <span class="fl">0.065</span>)</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="dv">60</span>, <span class="dv">85</span>])</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'green'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m1,xmin<span class="op">=-</span><span class="fl">1.99</span>, xmax<span class="op">=-</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m2,xmin<span class="op">=</span><span class="fl">1.99</span>, xmax<span class="op">=</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x1,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>], ymax<span class="op">=</span>m11, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x2,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>], ymax<span class="op">=</span>m22, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"contEffect"</span>)</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Figure4.png" width="700" height="500" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Plot with the errors around the mean of life expectancy across Europe and American countries</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>Countries in the americas are dummy coded as -1 and countries in Europe are dummy coded as 1. Note that jittering has been used to help visualise variation within continents, and so all countries in Americas had a <span class="math inline">\(contEffect\)</span> score of -1, even if the jittering above makes it look like participants from Europe had slightly different <span class="math inline">\(contEffect\)</span> values to each other.</p>
<p>So now that we’ve visualised the predictions and the error, lets summarise these errors with their sum of squares:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#temp_summary &lt;- summary(lm(lifeExp ~ contEffect, data = gapminder_americas_europe))</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(lifeExp <span class="sc">~</span> contEffect, <span class="at">data =</span> gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
contEffect   1  222.6  222.62   16.14 0.000186 ***
Residuals   53  730.8   13.79                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>america_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>ss_between <span class="ot">&lt;-</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">*</span> (europe_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> (america_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>top_half <span class="ot">=</span> ss_between</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>ss_within <span class="ot">=</span> (</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> europe_mean)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> america_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">=</span> (ss_within<span class="sc">/</span>(<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>top_half<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.14453</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  gapminder_americas_europe$lifeExp[gapminder_americas_europe$contEffect == 1] and gapminder_americas_europe$lifeExp[gapminder_americas_europe$contEffect == -1]
t = 4.018, df = 53, p-value = 0.0001864
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 2.023525 6.057435
sample estimates:
mean of x mean of y 
 77.64860  73.60812 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span><span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.14432</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at a t-distribution compared to an f-distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a table for the model</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>aov_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># display the table</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>aov_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table3.png" height="100" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Table</figcaption><p></p>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>].mean()</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>america_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span>(<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">*</span> (europe_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> (<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (america_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>top_half <span class="op">=</span> ss_between</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> (<span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>] <span class="op">-</span> europe_mean)<span class="op">**</span><span class="dv">2</span>)<span class="op">+</span> <span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> america_mean)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="op">=</span> (ss_within<span class="op">/</span>(<span class="bu">len</span>(gapminder_americas_europe[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>top_half<span class="op">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>16.14453</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>t_test <span class="op">=</span> ttest_ind(gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>t_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>Ttest_indResult(statistic=4.018025720342183, pvalue=0.00018637488941352037)</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span> <span class="op">**</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>16.144530689331322</code></pre>
</div>
</div>
</div>
<p>So the new unexplained variance (AKA residual) is 730.8276, which is smaller than it was when we just used the mean regardless of continent (953.4478; 935.4478 is also the <strong>total variance</strong> around the mean).</p>
<p>The sum of squares for the effect of continent can be calculated by subtracting the residuals from the total sum of squares (SS):</p>
<p><span class="math display">\[
effect_{SS} = total_{SS} - residual_{SS} = 953.4478 - 730.8276 = 222.6202
\]</span></p>
<p>The <span class="math inline">\(effect_{SS}\)</span> can also be thought of our explained variance! So we can actually calculate how much of the model is explained by the model (<span class="math inline">\(r^2\)</span>):</p>
<p><span class="math display">\[
r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335
\]</span></p>
<p>Let’s confirm that this is correct by comparing a manual calculation and a function:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="sc">/</span><span class="fl">953.4478</span> <span class="co"># should be  0.2335 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334897</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334896</code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="op">/</span><span class="fl">953.4478</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>0.23348965722087775</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get the r squared from the model</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> model.rsquared</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the R-squared value</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R-squared:"</span>, r_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>0.2334896271386857</code></pre>
</div>
</div>
</div>
<p>Great, the difference reflects a rounding error.</p>
<p>Note that the above formula is similar to the formula for <span class="math inline">\(r\)</span> from <a href="../regressions/simpleRegressions.html#proportion-of-variance-explained">simple regressions</a>. Variance is the square root of the Sum of Squares (or Sum of Squares is the <strong>square</strong> of variance!):</p>
<p><span class="math display">\[
r = \sqrt{\frac{SS_{explained}}{SS_{total}}} = \frac{\sqrt{SS_{explained}}}{\sqrt{SS_{total}}} =\frac{var_{explained}}{var_{total}}
\]</span></p>
<section id="anova-approach-vs-conventional-formula" class="level3">
<h3 class="anchored" data-anchor-id="anova-approach-vs-conventional-formula">ANOVA approach vs conventional formula</h3>
<p>The main formula for an independent samples t-test is:</p>
<p><span class="math display">\[
t =  \frac{\bar{X_1} - \bar{X_2}}{SE}
\]</span></p>
<p>However, this is a simplification of the GLM mathematics we’ve been doing above (although <span class="math inline">\(df\)</span> is the same for the denominator and numerator, so we ignored them as they cancelled out)</p>
<p><span class="math display">\[
t= \sqrt{f} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \frac{(\sum{\bar{X_1} - \mu)/(N_1-1) - (\sum{\bar{X_2} - \mu)}/(N_2-1)}}{
((\sum{X_{1i} - \bar{X_1}}) +  (\sum{X_{2i} - \bar{X_2}}) )/(N-1)}= \frac{\sum{\bar{X_1}/N_1 - \sum{\bar{X_2}}/N_2}}{SE} =  \frac{\bar{X_1} - \bar{X_2}}{SE}
\]</span></p>
</section>
<section id="glm-approach-optional" class="level2">
<h2 class="anchored" data-anchor-id="glm-approach-optional">GLM approach (optional)</h2>
<p>If we were to more strictly conceptualise this as a linear model, then we need to create a model that predicts the life expectancy based on the continent. As continent is a categorical variable, we need to allocate numbers for each continent. This can either be dummy coding (1 for 0 for each continent) or effect coding (1 or -1 for each continent). Let’s go through both approaches.</p>
<section id="dummy-coding" class="level3">
<h3 class="anchored" data-anchor-id="dummy-coding">Dummy coding</h3>
<p>In this model, we will dummy code America as 1 and Europe as 0. This means that our model will tell us how much life expectancy increases/decreases when you live in America compared to Europe. A general linear model with 1 predictor is generally structured as follows:</p>
<p><span class="math display">\[
Y = a + B*X  + e
\]</span></p>
<p>Or in relation to our variables</p>
<p><span class="math display">\[
GDP = a + B_{continent} * X_{continent} + e =
\]</span></p>
<ul>
<li><p><span class="math inline">\(X\)</span> refers to the value of our dummy coded variable, which is either 0 (Europe) or 1 (Americas).</p></li>
<li><p><span class="math inline">\(a\)</span> is the intercept, i.e.&nbsp;the value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X = 0\)</span>. Thus, as <span class="math inline">\(X=0\)</span> for Europe, <span class="math inline">\(a\)</span> is the mean life expectancy in Europe. This will be clarified below.</p></li>
<li><p><span class="math inline">\(B\)</span> is the gradient (AKA Coefficient AKA Beta) of the predictor. In our case, this will be the difference in means between Europe and the Americas, which will be further clarified below.</p></li>
<li><p><span class="math inline">\(e\)</span> is the error, or residual (i.e.&nbsp;the difference between the predicted value and the actual value).</p></li>
</ul>
<p>So it’s been claimed that <span class="math inline">\(a\)</span> will be the mean life expectancy in Europe. We can see why this is the case by seeing what happens when <span class="math inline">\(X=0\)</span>, which follows our dummy coding of Europe as 0.</p>
<p><span class="math display">\[
LifeExp = a + B_{continent} * 0 + e = a + e
\]</span></p>
<p>So predicting GDP for Europe is just <span class="math inline">\(a\)</span> and whatever is not predicted by <span class="math inline">\(a\)</span> is the error (<span class="math inline">\(e\)</span>). The best prediction of GDP in Europe is calculating the mean of life expectancy in Europe. Thus <span class="math inline">\(a\)</span> is the mean life expectancy in Europe.</p>
<p>Now, to get the gradient (<span class="math inline">\(B\)</span>), we need to calculate how much life expectancy goes up or down as <span class="math inline">\(X\)</span> increases by 1.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   contEffect                country continent year lifeExp       pop gdpPercap
1           1                Albania    Europe 2007  76.423   3600523  5937.030
2          -1              Argentina  Americas 2007  75.320  40301927 12779.380
3           1                Austria    Europe 2007  79.829   8199783 36126.493
4           1                Belgium    Europe 2007  79.441  10392226 33692.605
5          -1                Bolivia  Americas 2007  65.554   9119152  3822.137
6           1 Bosnia and Herzegovina    Europe 2007  74.852   4552198  7446.299
7          -1                 Brazil  Americas 2007  72.390 190010647  9065.801
8           1               Bulgaria    Europe 2007  73.005   7322858 10680.793
9          -1                 Canada  Americas 2007  80.653  33390141 36319.235
10         -1                  Chile  Americas 2007  78.553  16284741 13171.639
11         -1               Colombia  Americas 2007  72.889  44227550  7006.580
12         -1             Costa Rica  Americas 2007  78.782   4133884  9645.061
13          1                Croatia    Europe 2007  75.748   4493312 14619.223
14         -1                   Cuba  Americas 2007  78.273  11416987  8948.103
15          1         Czech Republic    Europe 2007  76.486  10228744 22833.309
16          1                Denmark    Europe 2007  78.332   5468120 35278.419
17         -1     Dominican Republic  Americas 2007  72.235   9319622  6025.375
18         -1                Ecuador  Americas 2007  74.994  13755680  6873.262
19         -1            El Salvador  Americas 2007  71.878   6939688  5728.354
20          1                Finland    Europe 2007  79.313   5238460 33207.084
21          1                 France    Europe 2007  80.657  61083916 30470.017
22          1                Germany    Europe 2007  79.406  82400996 32170.374
23          1                 Greece    Europe 2007  79.483  10706290 27538.412
24         -1              Guatemala  Americas 2007  70.259  12572928  5186.050
25         -1                  Haiti  Americas 2007  60.916   8502814  1201.637
26         -1               Honduras  Americas 2007  70.198   7483763  3548.331
27          1                Hungary    Europe 2007  73.338   9956108 18008.944
28          1                Iceland    Europe 2007  81.757    301931 36180.789
29          1                Ireland    Europe 2007  78.885   4109086 40675.996
30          1                  Italy    Europe 2007  80.546  58147733 28569.720
31         -1                Jamaica  Americas 2007  72.567   2780132  7320.880
32         -1                 Mexico  Americas 2007  76.195 108700891 11977.575
33          1             Montenegro    Europe 2007  74.543    684736  9253.896
34          1            Netherlands    Europe 2007  79.762  16570613 36797.933
35         -1              Nicaragua  Americas 2007  72.899   5675356  2749.321
36          1                 Norway    Europe 2007  80.196   4627926 49357.190
37         -1                 Panama  Americas 2007  75.537   3242173  9809.186
38         -1               Paraguay  Americas 2007  71.752   6667147  4172.838
39         -1                   Peru  Americas 2007  71.421  28674757  7408.906
40          1                 Poland    Europe 2007  75.563  38518241 15389.925
41          1               Portugal    Europe 2007  78.098  10642836 20509.648
42         -1            Puerto Rico  Americas 2007  78.746   3942491 19328.709
43          1                Romania    Europe 2007  72.476  22276056 10808.476
44          1                 Serbia    Europe 2007  74.002  10150265  9786.535
45          1        Slovak Republic    Europe 2007  74.663   5447502 18678.314
46          1               Slovenia    Europe 2007  77.926   2009245 25768.258
47          1                  Spain    Europe 2007  80.941  40448191 28821.064
48          1                 Sweden    Europe 2007  80.884   9031088 33859.748
49          1            Switzerland    Europe 2007  81.701   7554661 37506.419
50         -1    Trinidad and Tobago  Americas 2007  69.819   1056608 18008.509
51          1                 Turkey    Europe 2007  71.777  71158647  8458.276
52          1         United Kingdom    Europe 2007  79.425  60776238 33203.261
53         -1          United States  Americas 2007  78.242 301139947 42951.653
54         -1                Uruguay  Americas 2007  76.384   3447496 10611.463
55         -1              Venezuela  Americas 2007  73.747  26084662 11415.806
      t_fit
1  77.64860
2  73.60812
3  77.64860
4  77.64860
5  73.60812
6  77.64860
7  73.60812
8  77.64860
9  73.60812
10 73.60812
11 73.60812
12 73.60812
13 77.64860
14 73.60812
15 77.64860
16 77.64860
17 73.60812
18 73.60812
19 73.60812
20 77.64860
21 77.64860
22 77.64860
23 77.64860
24 73.60812
25 73.60812
26 73.60812
27 77.64860
28 77.64860
29 77.64860
30 77.64860
31 73.60812
32 73.60812
33 77.64860
34 77.64860
35 73.60812
36 77.64860
37 73.60812
38 73.60812
39 73.60812
40 77.64860
41 77.64860
42 73.60812
43 77.64860
44 77.64860
45 77.64860
46 77.64860
47 77.64860
48 77.64860
49 77.64860
50 73.60812
51 77.64860
52 77.64860
53 73.60812
54 73.60812
55 73.60812</code></pre>
</div>
</div>
</section>
<section id="effect-coding" class="level3">
<h3 class="anchored" data-anchor-id="effect-coding">Effect coding</h3>
</section>
</section>
</section>
<section id="effect-sizes" class="level1">
<h1>Effect sizes</h1>
<section id="t-tests" class="level2">
<h2 class="anchored" data-anchor-id="t-tests">T-tests</h2>
<p>To capture how large the effect is, there are slightly different calculations when doing a within subject design (1 or 2 conditions that all participants complete) vs.&nbsp;a between subject design. In all cases these are Cohen <span class="math inline">\(d\)</span> calculations.</p>
<section id="one-sample-t-tests-1" class="level3">
<h3 class="anchored" data-anchor-id="one-sample-t-tests-1">One Sample T-tests</h3>
<p>The size of an effect is how big the difference is between the mean and the <span class="math inline">\(\mu\)</span> that you are comparing it to, compared to the standard deviation:</p>
<p><span class="math display">\[
d = \frac{\bar{x} - \mu}{SD(x)}
\]</span></p>
<p>The general benchmarks for how big or small a Cohen’s <span class="math inline">\(d\)</span> value are as follows:</p>
<ul>
<li><p>.01 and below is very small (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
<li><p>.2 and below is small (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>.5 is medium (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>.8 is large (<a href="http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical">Cohen 2013</a>)</p></li>
<li><p>1.2 is very large (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
<li><p>2 is huge (<a href="http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new">Sawilowsky 2009</a>)</p></li>
</ul>
</section>
<section id="paired-sample-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="paired-sample-t-tests">Paired sample T-tests</h3>
<p>The size of an effect is how big the difference is between the conditions, compared to the standard deviation:</p>
<p><span class="math display">\[
d = \frac{\bar{x_1} - \bar{x_2}}{SD(x_1-x_2)}
\]</span></p>
<p>This actually can be thought of the same as one-sample t-tests after you take the step to calculate the difference between each value in <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> to make <span class="math inline">\(x_3\)</span> to compare to a <span class="math inline">\(\mu\)</span> of 0:</p>
<p><span class="math display">\[
x_3 = x_1 - x_2
\]</span> <span class="math display">\[
\mu = 0
\]</span> <span class="math display">\[
d = \frac{\bar{x_1}-\bar{x_2}}{SD(\bar{x_1}-\bar{x_2})} = \frac{\bar{x_3}}{SD(x_3)} = \frac{\bar{x_3}-\mu}{SD(x_3)}
\]</span></p>
</section>
<section id="independent-sample-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="independent-sample-t-tests">Independent Sample T-tests</h3>
<p>The formula for this is somewhat similar to that for a paired samples t-test, but because you are comparing between groups of participants you can’t collapse the values between conditions because there are no pairings. So, you need to calculate the <em>pooled</em> standard deviation.</p>
<p><span class="math display">\[
SD_{pooled} = \sqrt{(SD(x_1)^2 + SD(x_1)^2)/2}
\]</span></p>
<p><span class="math display">\[
d = \frac{\bar{x_1}-\bar{x_2}}{SD_{pooled}}
\]</span></p>
</section>
</section>
<section id="f-tests" class="level2">
<h2 class="anchored" data-anchor-id="f-tests">F-tests</h2>
<p>The effect sizes for F-tests are based on how much variance is explained by the model, which sometimes is exactly the same as <span class="math inline">\(r^2\)</span>. Let’s review some of the calculations above to confirm this:<br>
<span class="math display">\[
r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335
\]</span></p>
<p>If we run a linear model on the data we should also confirm the <span class="math inline">\(r^2\)</span> is .2335:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ contEffect, data = gapminder_americas_europe)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.6921  -2.1364   0.4494   2.5671   7.0449 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  75.6284     0.5028 150.416  &lt; 2e-16 ***
contEffect    2.0202     0.5028   4.018 0.000186 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.713 on 53 degrees of freedom
Multiple R-squared:  0.2335,    Adjusted R-squared:  0.219 
F-statistic: 16.14 on 1 and 53 DF,  p-value: 0.0001864</code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="TTests_Table4.png" height="300" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Table</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>We’ll use a function to confirm that this is the same for eta squared also:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">etaSquared</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              eta.sq eta.sq.part
contEffect 0.2334896   0.2334896</code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eta-squared</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> anova_lm(results)</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>eta_squared <span class="op">=</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">/</span> (anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">+</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">1</span>])</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eta-squared (η²):"</span>, eta_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>Eta-squared (η²): 0.2334896271386854</code></pre>
</div>
</div>
</div>
<p>Boom, you got effect sizes for F-tests like ANOVAs.</p>
<p>If you have understood this page it will set you up for the pages on each type of ANOVA as it uses the same concepts again and again.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb120" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "T-Tests (R, Python incomplete)"</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>this_page <span class="ot">=</span> <span class="st">"ttests"</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../overview.qmd &gt;}}</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## T-tests and ANOVAs</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>T-tests use the same underlying mathematics as ANOVAs. There is an argument that it's better to just use the ANOVA mathematics as this will allow you more flexibility in future to do more complex analyses. Expand this for insights into the ANOVA concepts and how they overlap with t-tests.</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution collapse="true" appearance="minimal"}</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expand this for insights into the ANOVA concepts and how they overlap with t-tests.</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>In the tests below we will frequently come across the following concepts:</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>**Total sum of squares** represents all the variance around the mean. We create models to try to explain why data points are different to the mean.</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>**Explained sum of squares** represents the variance around the mean that is explained by your model.</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>**Unexplained variance** represents whatever variance around the mean that isn't explained by your model. Sometimes the word **residual** or **error** is used to capture the difference between the predicted value of a data point (i.e. what would be **explained** by the model) and the actual data point (the difference being **unexplained**).</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>We summarise this ratio of **explained** vs. **unexplained** variance using an F value:</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}}</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{explained}$ is explained sum of squares</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{unexplained}$ is the unexplained sum of squares</span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$df_{explained}$ is the **degrees of freedom (df)** for the model explaining the variance. This is generally the number of levels in your model minus 1. For example, if you were testing if life expectancy is explained by which continent a country is in, then the number of levels is the number of continents in your analysis (e.g. 5 continents), and the **df** would be 5-1=4. The **df** is used to address <span class="co">[</span><span class="ot">uncertainty because we are using a sample to estimate a population</span><span class="co">](../describingData/dispersion.html#degrees-of-freedom)</span>, but you don't need to understand this to continue on this page.</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$df_{unexplained}$ is the **degrees of freedom (df)** that is not addressed by the model. Generally this is the number of subjects minus 1. Using the above example about continents and life expectancy, each subject could be one of 142 countries in your analysis, and so the **df** would be 142-1=141.</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>The key points in the above formula are:</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The better your model is the more Sum of Squares will be explained, which will increase F</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The more data points (e.g. subjects) you have, the higher your $df_{unexplained}$ will be, which will also increase F</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning collapse="true" appearance="minimal"}</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## How F-values for a test with 2 levels can be simplified to calculate a t-value</span></span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>On this page we will be focusing on simpler analyses that only compare between 2 conditions, which means $df_{explained}$ will be (2-1=) 1, which simplifies the above formula:</span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a>F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{SS_{explained}/1}{SS_{unexplained}/df_{unexplained}} = \frac{SS_{explained}}{SS_{unexplained}/df_{unexplained}}</span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a>This allows us to complete simpler analyses to calculate $t$ values, which are the square root of $F$:</span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a>t = \sqrt{F} = \sqrt{\frac{SS_{explained}}{SS_{unexplained}/df_{unexplained}}}</span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a>$t$ values are used for $t$-tests, which we'll address below.</span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sample t-tests</span></span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-70"><a href="#cb120-70" aria-hidden="true" tabindex="-1"></a>One-sample t-tests test whether your sample's values are significantly higher or lower than a pre-specified value ($\mu$). You can do this by seeing how big the difference is between the **mean in your sample** ($\bar{x}$) and the $\mu$, when taking into account the general variance in your data and the number of participants you have.</span>
<span id="cb120-71"><a href="#cb120-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-72"><a href="#cb120-72" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true" appearance="minimal"}</span>
<span id="cb120-73"><a href="#cb120-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Formula for a one-sample t-test</span></span>
<span id="cb120-74"><a href="#cb120-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-75"><a href="#cb120-75" aria-hidden="true" tabindex="-1"></a>One sample t-tests try to explain whether variance of data is better explained around one specific value (sample mean $\bar{x}$) compared to another (previously assumed value $\mu$), when compared to the general variance in the data ( $\sigma/\sqrt{N}$ explained more below).</span>
<span id="cb120-76"><a href="#cb120-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-77"><a href="#cb120-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-78"><a href="#cb120-78" aria-hidden="true" tabindex="-1"></a>t_{oneSample}=\frac{\bar{x} - \mu}{\sigma/\sqrt{N} }</span>
<span id="cb120-79"><a href="#cb120-79" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-80"><a href="#cb120-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-81"><a href="#cb120-81" aria-hidden="true" tabindex="-1"></a>For example, imagine that you wanted to test whether life expectancy is higher than 55 across the world:</span>
<span id="cb120-82"><a href="#cb120-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-83"><a href="#cb120-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Your $\mu$ would be 55. This can be thought of as the assumed population mean that we want to use our sample to test.</span>
<span id="cb120-84"><a href="#cb120-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-85"><a href="#cb120-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Your $\bar{x}$ would be the sample mean.</span>
<span id="cb120-86"><a href="#cb120-86" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-87"><a href="#cb120-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-88"><a href="#cb120-88" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true" appearance="minimal"}</span>
<span id="cb120-89"><a href="#cb120-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## An example of a one-sample t-test</span></span>
<span id="cb120-90"><a href="#cb120-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-91"><a href="#cb120-91" aria-hidden="true" tabindex="-1"></a>Let's visualise these values using gapminder data from 2007:</span>
<span id="cb120-92"><a href="#cb120-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-93"><a href="#cb120-93" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-94"><a href="#cb120-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-95"><a href="#cb120-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-98"><a href="#cb120-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-99"><a href="#cb120-99" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb120-100"><a href="#cb120-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb120-101"><a href="#cb120-101" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb120-102"><a href="#cb120-102" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb120-103"><a href="#cb120-103" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span></span>
<span id="cb120-104"><a href="#cb120-104" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-105"><a href="#cb120-105" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_2007, <span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">y=</span>lifeExp)) <span class="sc">+</span> </span>
<span id="cb120-106"><a href="#cb120-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span> </span>
<span id="cb120-107"><a href="#cb120-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb120-108"><a href="#cb120-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb120-109"><a href="#cb120-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb120-110"><a href="#cb120-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-111"><a href="#cb120-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-112"><a href="#cb120-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb120-113"><a href="#cb120-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb120-114"><a href="#cb120-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">55</span>,</span>
<span id="cb120-115"><a href="#cb120-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">55</span>,</span>
<span id="cb120-116"><a href="#cb120-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Mu"</span></span>
<span id="cb120-117"><a href="#cb120-117" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-118"><a href="#cb120-118" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-119"><a href="#cb120-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-120"><a href="#cb120-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-121"><a href="#cb120-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">2006.6</span>,</span>
<span id="cb120-122"><a href="#cb120-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">2007.4</span>,</span>
<span id="cb120-123"><a href="#cb120-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb120-124"><a href="#cb120-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb120-125"><a href="#cb120-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Sample Mean"</span></span>
<span id="cb120-126"><a href="#cb120-126" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-127"><a href="#cb120-127" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-128"><a href="#cb120-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-129"><a href="#cb120-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-130"><a href="#cb120-130" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-131"><a href="#cb120-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-134"><a href="#cb120-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-135"><a href="#cb120-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-136"><a href="#cb120-136" aria-hidden="true" tabindex="-1"></a><span class="co"># load the gapminder module and import the gapminder dataset</span></span>
<span id="cb120-137"><a href="#cb120-137" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gapminder <span class="im">import</span> gapminder</span>
<span id="cb120-138"><a href="#cb120-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-139"><a href="#cb120-139" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib</span></span>
<span id="cb120-140"><a href="#cb120-140" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb120-141"><a href="#cb120-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-142"><a href="#cb120-142" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb120-143"><a href="#cb120-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-144"><a href="#cb120-144" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new data frame that only focuses on data from 2007</span></span>
<span id="cb120-145"><a href="#cb120-145" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="op">=</span> gapminder.loc[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>]</span>
<span id="cb120-146"><a href="#cb120-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-147"><a href="#cb120-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb120-148"><a href="#cb120-148" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb120-149"><a href="#cb120-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-150"><a href="#cb120-150" aria-hidden="true" tabindex="-1"></a><span class="co"># create the scatterplot with some jitter</span></span>
<span id="cb120-151"><a href="#cb120-151" aria-hidden="true" tabindex="-1"></a>sns.stripplot(x<span class="op">=</span><span class="st">"year"</span>, y<span class="op">=</span><span class="st">'lifeExp'</span>, data<span class="op">=</span>gapminder_2007, dodge<span class="op">=</span><span class="va">True</span>, jitter<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-152"><a href="#cb120-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-153"><a href="#cb120-153" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for Mu</span></span>
<span id="cb120-154"><a href="#cb120-154" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">55</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Mu'</span>)</span>
<span id="cb120-155"><a href="#cb120-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-156"><a href="#cb120-156" aria-hidden="true" tabindex="-1"></a><span class="co"># add an horizontal line for the mean of 'lifeExp'</span></span>
<span id="cb120-157"><a href="#cb120-157" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_2007[<span class="st">'lifeExp'</span>].mean(), color<span class="op">=</span><span class="st">'g'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'Sample Mean'</span>)</span>
<span id="cb120-158"><a href="#cb120-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-159"><a href="#cb120-159" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the label on the x-axis</span></span>
<span id="cb120-160"><a href="#cb120-160" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">""</span>)</span>
<span id="cb120-161"><a href="#cb120-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-162"><a href="#cb120-162" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the tick on the x-axis</span></span>
<span id="cb120-163"><a href="#cb120-163" aria-hidden="true" tabindex="-1"></a>plt.xticks([])</span>
<span id="cb120-164"><a href="#cb120-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-165"><a href="#cb120-165" aria-hidden="true" tabindex="-1"></a><span class="co"># add the legend </span></span>
<span id="cb120-166"><a href="#cb120-166" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb120-167"><a href="#cb120-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-168"><a href="#cb120-168" aria-hidden="true" tabindex="-1"></a><span class="co"># show the plot</span></span>
<span id="cb120-169"><a href="#cb120-169" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb120-170"><a href="#cb120-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-171"><a href="#cb120-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-172"><a href="#cb120-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-173"><a href="#cb120-173" aria-hidden="true" tabindex="-1"></a><span class="al">![Scatterplot with Mu and Sample Mean of 'Life expectancy'](TTests_Figure1.png)</span>{alt="Scatterplot with Mu and Sample Mean of 'Life expectancy'" fig-align="left" width="650"}</span>
<span id="cb120-174"><a href="#cb120-174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-175"><a href="#cb120-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-176"><a href="#cb120-176" aria-hidden="true" tabindex="-1"></a>So the t-value will reflect how significantly higher or lower the sample mean ($\bar{x}$) is than the assumed population mean ($\mu$). Let's apply the data from our data to the general formula:</span>
<span id="cb120-177"><a href="#cb120-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-178"><a href="#cb120-178" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-179"><a href="#cb120-179" aria-hidden="true" tabindex="-1"></a>t_{oneSample}=\frac{\bar{x} - \mu}{\sigma/\sqrt{N}} = \frac{67.00742-55}{12.07302/\sqrt{142}} = 11.85163</span>
<span id="cb120-180"><a href="#cb120-180" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-181"><a href="#cb120-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-182"><a href="#cb120-182" aria-hidden="true" tabindex="-1"></a>Let's confirm that we get the same t-value using a function:</span>
<span id="cb120-183"><a href="#cb120-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-184"><a href="#cb120-184" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-185"><a href="#cb120-185" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-186"><a href="#cb120-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-189"><a href="#cb120-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-190"><a href="#cb120-190" aria-hidden="true" tabindex="-1"></a><span class="co"># t-statistic</span></span>
<span id="cb120-191"><a href="#cb120-191" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="at">mu=</span><span class="dv">55</span>)</span>
<span id="cb120-192"><a href="#cb120-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-193"><a href="#cb120-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-194"><a href="#cb120-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-195"><a href="#cb120-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-198"><a href="#cb120-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-199"><a href="#cb120-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-200"><a href="#cb120-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-201"><a href="#cb120-201" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb120-202"><a href="#cb120-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb120-203"><a href="#cb120-203" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2007[<span class="st">'lifeExp'</span>], popmean<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb120-204"><a href="#cb120-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-205"><a href="#cb120-205" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb120-206"><a href="#cb120-206" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span>
<span id="cb120-207"><a href="#cb120-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-208"><a href="#cb120-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-209"><a href="#cb120-209" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-210"><a href="#cb120-210" aria-hidden="true" tabindex="-1"></a><span class="in">t-statistic: 11.851628442323024</span></span>
<span id="cb120-211"><a href="#cb120-211" aria-hidden="true" tabindex="-1"></a><span class="in">p-value: 6.463174215427706e-23</span></span>
<span id="cb120-212"><a href="#cb120-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-213"><a href="#cb120-213" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-214"><a href="#cb120-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-215"><a href="#cb120-215" aria-hidden="true" tabindex="-1"></a>We can see that the t-value we calculated is the same as calculated by functions (once you take into account rounding numbers). You may have noticed that there is also a p-value associated with t-tests that is **very** small, suggesting that it is very unlikely that our sample would have such high life expectancy if the $\mu$ was correct, i.e. if the life expectancy across countries was actually 55 years old. So, the next question is how do we calculate p-values like this using t-values?</span>
<span id="cb120-216"><a href="#cb120-216" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-217"><a href="#cb120-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-218"><a href="#cb120-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## T-values Calculating p-values from t-distributions</span></span>
<span id="cb120-219"><a href="#cb120-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-220"><a href="#cb120-220" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true" appearance="minimal"}</span>
<span id="cb120-221"><a href="#cb120-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## T-values can be used to calculate p-values </span></span>
<span id="cb120-222"><a href="#cb120-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-223"><a href="#cb120-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb120-224"><a href="#cb120-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-225"><a href="#cb120-225" aria-hidden="true" tabindex="-1"></a>Similar to the <span class="co">[</span><span class="ot">normal distribution</span><span class="co">](../distributions/normal.html#z-scores-and-the-z-distribution)</span>, we can calculate how likely it is that you would get a t-value or higher (or lower) by drawing a t-distribution. A t-distribution is like a normal distribution (it's a bell curve), but also takes into account the number of participants (or data points) using degrees of freedom (N-1). Here are the t-distributions you would get for 101, 21 and 6 participants:</span>
<span id="cb120-226"><a href="#cb120-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-227"><a href="#cb120-227" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-228"><a href="#cb120-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-229"><a href="#cb120-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-232"><a href="#cb120-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-233"><a href="#cb120-233" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">100</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb120-234"><a href="#cb120-234" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">20</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb120-235"><a href="#cb120-235" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, <span class="at">df=</span><span class="dv">5</span>), <span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span>
<span id="cb120-236"><a href="#cb120-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-237"><a href="#cb120-237" aria-hidden="true" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb120-238"><a href="#cb120-238" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="dv">4</span>, .<span class="dv">3</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"df=5"</span>, <span class="st">"df=20"</span>, <span class="st">"df=100"</span>),</span>
<span id="cb120-239"><a href="#cb120-239" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb120-240"><a href="#cb120-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-241"><a href="#cb120-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-242"><a href="#cb120-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-243"><a href="#cb120-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-246"><a href="#cb120-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-247"><a href="#cb120-247" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-248"><a href="#cb120-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-249"><a href="#cb120-249" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb120-250"><a href="#cb120-250" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb120-251"><a href="#cb120-251" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb120-252"><a href="#cb120-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-253"><a href="#cb120-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the x values</span></span>
<span id="cb120-254"><a href="#cb120-254" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1000</span>)</span>
<span id="cb120-255"><a href="#cb120-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-256"><a href="#cb120-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density curves for different degrees of freedom</span></span>
<span id="cb120-257"><a href="#cb120-257" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'df=100'</span>)</span>
<span id="cb120-258"><a href="#cb120-258" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'df=20'</span>)</span>
<span id="cb120-259"><a href="#cb120-259" aria-hidden="true" tabindex="-1"></a>plt.plot(x, t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'df=5'</span>)</span>
<span id="cb120-260"><a href="#cb120-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-261"><a href="#cb120-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb120-262"><a href="#cb120-262" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb120-263"><a href="#cb120-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-264"><a href="#cb120-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Set axis labels and plot title</span></span>
<span id="cb120-265"><a href="#cb120-265" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb120-266"><a href="#cb120-266" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb120-267"><a href="#cb120-267" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'T-Distribution Density Curves'</span>)</span>
<span id="cb120-268"><a href="#cb120-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-269"><a href="#cb120-269" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb120-270"><a href="#cb120-270" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb120-271"><a href="#cb120-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-272"><a href="#cb120-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-273"><a href="#cb120-273" aria-hidden="true" tabindex="-1"></a><span class="al">![T-Distribution Density Curves'](TTests_Figure5.png)</span>{alt="T-Distribution Density Curves'" fig-align="left" width="650"}</span>
<span id="cb120-274"><a href="#cb120-274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-275"><a href="#cb120-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-276"><a href="#cb120-276" aria-hidden="true" tabindex="-1"></a>We can see that the slopes get steeper the higher the $df$ is (i.e. the more participants you have). This means that the results become more significant even with the same t-value. Not convinced? Let's use a t-value of 2 to illustrate this. In the following figure you can see that the area under the curve for a t-value of 2 or more gets visually smaller the more participants/the higher the $df$ value is:</span>
<span id="cb120-277"><a href="#cb120-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-278"><a href="#cb120-278" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-279"><a href="#cb120-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-280"><a href="#cb120-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-283"><a href="#cb120-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-284"><a href="#cb120-284" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb120-285"><a href="#cb120-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt,   <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">geom =</span> <span class="st">"area"</span>) <span class="sc">+</span> </span>
<span id="cb120-286"><a href="#cb120-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">5</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-287"><a href="#cb120-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">20</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb120-288"><a href="#cb120-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dt, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df =</span><span class="dv">100</span>), <span class="at">color =</span> <span class="st">"green"</span>) </span>
<span id="cb120-289"><a href="#cb120-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-290"><a href="#cb120-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-291"><a href="#cb120-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-292"><a href="#cb120-292" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-293"><a href="#cb120-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-296"><a href="#cb120-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-297"><a href="#cb120-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-298"><a href="#cb120-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-299"><a href="#cb120-299" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, xlim, geom_area, geom_line</span>
<span id="cb120-300"><a href="#cb120-300" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb120-301"><a href="#cb120-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-302"><a href="#cb120-302" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb120-303"><a href="#cb120-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-304"><a href="#cb120-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame with x values</span></span>
<span id="cb120-305"><a href="#cb120-305" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb120-306"><a href="#cb120-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-307"><a href="#cb120-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the  plot</span></span>
<span id="cb120-308"><a href="#cb120-308" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb120-309"><a href="#cb120-309" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb120-310"><a href="#cb120-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">4</span>), fill<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb120-311"><a href="#cb120-311" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">5</span>), color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb120-312"><a href="#cb120-312" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">20</span>), color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb120-313"><a href="#cb120-313" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(fun<span class="op">=</span><span class="kw">lambda</span> x: t.pdf(x, df<span class="op">=</span><span class="dv">100</span>), color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb120-314"><a href="#cb120-314" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-315"><a href="#cb120-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-316"><a href="#cb120-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-317"><a href="#cb120-317" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure with the area under the curve for a t-value of 2'](TTests_Figure6.png)</span>{alt="Figure with the area under the curve for a t-value of 2'" fig-align="left" width="650"}</span>
<span id="cb120-318"><a href="#cb120-318" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-319"><a href="#cb120-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-320"><a href="#cb120-320" aria-hidden="true" tabindex="-1"></a>Remember, area under the curve **IS** the p-value, so the area under the curve for a t-value of 2 or above for each degrees of freedom is:</span>
<span id="cb120-321"><a href="#cb120-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-322"><a href="#cb120-322" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-323"><a href="#cb120-323" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-324"><a href="#cb120-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-327"><a href="#cb120-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-328"><a href="#cb120-328" aria-hidden="true" tabindex="-1"></a><span class="co"># area under the curve for 2 and above</span></span>
<span id="cb120-329"><a href="#cb120-329" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb120-330"><a href="#cb120-330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb120-331"><a href="#cb120-331" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb120-332"><a href="#cb120-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb120-333"><a href="#cb120-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">5</span>, </span>
<span id="cb120-334"><a href="#cb120-334" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb120-335"><a href="#cb120-335" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb120-336"><a href="#cb120-336" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-337"><a href="#cb120-337" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb120-338"><a href="#cb120-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb120-339"><a href="#cb120-339" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb120-340"><a href="#cb120-340" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb120-341"><a href="#cb120-341" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">20</span>, </span>
<span id="cb120-342"><a href="#cb120-342" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb120-343"><a href="#cb120-343" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb120-344"><a href="#cb120-344" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-345"><a href="#cb120-345" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(</span>
<span id="cb120-346"><a href="#cb120-346" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-value</span></span>
<span id="cb120-347"><a href="#cb120-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">q=</span><span class="dv">2</span>, </span>
<span id="cb120-348"><a href="#cb120-348" aria-hidden="true" tabindex="-1"></a>  <span class="co"># degrees of freedom</span></span>
<span id="cb120-349"><a href="#cb120-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">df=</span><span class="dv">100</span>, </span>
<span id="cb120-350"><a href="#cb120-350" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is the test of the t-value and below (TRUE) or the t-value and above (FALSE)</span></span>
<span id="cb120-351"><a href="#cb120-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb120-352"><a href="#cb120-352" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-353"><a href="#cb120-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-354"><a href="#cb120-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-355"><a href="#cb120-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-356"><a href="#cb120-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-359"><a href="#cb120-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-360"><a href="#cb120-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-361"><a href="#cb120-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-362"><a href="#cb120-362" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span>
<span id="cb120-363"><a href="#cb120-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-364"><a href="#cb120-364" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb120-365"><a href="#cb120-365" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb120-366"><a href="#cb120-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-367"><a href="#cb120-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb120-368"><a href="#cb120-368" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb120-369"><a href="#cb120-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-370"><a href="#cb120-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb120-371"><a href="#cb120-371" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb120-372"><a href="#cb120-372" aria-hidden="true" tabindex="-1"></a>area_above_2</span>
<span id="cb120-373"><a href="#cb120-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-374"><a href="#cb120-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-375"><a href="#cb120-375" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-376"><a href="#cb120-376" aria-hidden="true" tabindex="-1"></a><span class="in">0.050969739414929105</span></span>
<span id="cb120-377"><a href="#cb120-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-378"><a href="#cb120-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-381"><a href="#cb120-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-382"><a href="#cb120-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-383"><a href="#cb120-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-384"><a href="#cb120-384" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb120-385"><a href="#cb120-385" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb120-386"><a href="#cb120-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-387"><a href="#cb120-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb120-388"><a href="#cb120-388" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb120-389"><a href="#cb120-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-390"><a href="#cb120-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb120-391"><a href="#cb120-391" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb120-392"><a href="#cb120-392" aria-hidden="true" tabindex="-1"></a>area_above_2</span>
<span id="cb120-393"><a href="#cb120-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-394"><a href="#cb120-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-395"><a href="#cb120-395" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-396"><a href="#cb120-396" aria-hidden="true" tabindex="-1"></a><span class="in">0.02963276772328527</span></span>
<span id="cb120-397"><a href="#cb120-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-398"><a href="#cb120-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-401"><a href="#cb120-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-402"><a href="#cb120-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-403"><a href="#cb120-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-404"><a href="#cb120-404" aria-hidden="true" tabindex="-1"></a><span class="co"># t-value</span></span>
<span id="cb120-405"><a href="#cb120-405" aria-hidden="true" tabindex="-1"></a>t_value <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb120-406"><a href="#cb120-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-407"><a href="#cb120-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb120-408"><a href="#cb120-408" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb120-409"><a href="#cb120-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-410"><a href="#cb120-410" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the area under the curve for t &gt;= 2</span></span>
<span id="cb120-411"><a href="#cb120-411" aria-hidden="true" tabindex="-1"></a>area_above_2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> t.cdf(t_value, df<span class="op">=</span>df)</span>
<span id="cb120-412"><a href="#cb120-412" aria-hidden="true" tabindex="-1"></a>area_above_2</span>
<span id="cb120-413"><a href="#cb120-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-414"><a href="#cb120-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-415"><a href="#cb120-415" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-416"><a href="#cb120-416" aria-hidden="true" tabindex="-1"></a><span class="in">0.024106089365566796</span></span>
<span id="cb120-417"><a href="#cb120-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-418"><a href="#cb120-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-419"><a href="#cb120-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-420"><a href="#cb120-420" aria-hidden="true" tabindex="-1"></a>Note that if you wanted a 2-tailed test (i.e. you didn't have an expected direction of your finding) you would double the area under the curve/p-value.</span>
<span id="cb120-421"><a href="#cb120-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-422"><a href="#cb120-422" aria-hidden="true" tabindex="-1"></a>Similar principles apply for an F-distribution, described next.</span>
<span id="cb120-423"><a href="#cb120-423" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-424"><a href="#cb120-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-425"><a href="#cb120-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## Calculating p-values from F-distributions</span></span>
<span id="cb120-426"><a href="#cb120-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-427"><a href="#cb120-427" aria-hidden="true" tabindex="-1"></a>As F-values are based on the **sum of squares**, which are always positive, they cannot be negative. Also, F distributions can reflect more complex designs than t-distributions, such as having both **explained** and **unexplained** degrees of freedom. This means that they can have a variety of shapes to reflect these differences in degrees of freedom. First, let's look at some distributions for designs with 2 conditions but differing numbers of participants:</span>
<span id="cb120-428"><a href="#cb120-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-429"><a href="#cb120-429" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-430"><a href="#cb120-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-431"><a href="#cb120-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-434"><a href="#cb120-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-435"><a href="#cb120-435" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb120-436"><a href="#cb120-436" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb120-437"><a href="#cb120-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">5</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-438"><a href="#cb120-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">20</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb120-439"><a href="#cb120-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb120-440"><a href="#cb120-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label =</span> <span class="st">"df1 = 5, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-441"><a href="#cb120-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 20, df2=1"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb120-442"><a href="#cb120-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb120-443"><a href="#cb120-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb120-444"><a href="#cb120-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span>
<span id="cb120-445"><a href="#cb120-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-446"><a href="#cb120-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-447"><a href="#cb120-447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-448"><a href="#cb120-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-451"><a href="#cb120-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-452"><a href="#cb120-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-453"><a href="#cb120-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-454"><a href="#cb120-454" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb120-455"><a href="#cb120-455" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb120-456"><a href="#cb120-456" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> f</span>
<span id="cb120-457"><a href="#cb120-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-458"><a href="#cb120-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb120-459"><a href="#cb120-459" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb120-460"><a href="#cb120-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-461"><a href="#cb120-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb120-462"><a href="#cb120-462" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb120-463"><a href="#cb120-463" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb120-464"><a href="#cb120-464" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-465"><a href="#cb120-465" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">5</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb120-466"><a href="#cb120-466" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb120-467"><a href="#cb120-467" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-468"><a href="#cb120-468" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-469"><a href="#cb120-469" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">20</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb120-470"><a href="#cb120-470" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb120-471"><a href="#cb120-471" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-472"><a href="#cb120-472" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-473"><a href="#cb120-473" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb120-474"><a href="#cb120-474" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb120-475"><a href="#cb120-475" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-476"><a href="#cb120-476" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-477"><a href="#cb120-477" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=5, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb120-478"><a href="#cb120-478" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-479"><a href="#cb120-479" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-480"><a href="#cb120-480" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=20, df2=1"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb120-481"><a href="#cb120-481" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-482"><a href="#cb120-482" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-483"><a href="#cb120-483" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb120-484"><a href="#cb120-484" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-485"><a href="#cb120-485" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb120-486"><a href="#cb120-486" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-487"><a href="#cb120-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-488"><a href="#cb120-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-489"><a href="#cb120-489" aria-hidden="true" tabindex="-1"></a><span class="al">![F-Distribution Density Curves'](TTests_Figure7.png)</span>{fig-align="left" width="650"}</span>
<span id="cb120-490"><a href="#cb120-490" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-491"><a href="#cb120-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-492"><a href="#cb120-492" aria-hidden="true" tabindex="-1"></a>The shape is roughly the same, but shifts slightly as you get more people. What happens if we look at distributions where there are about 100 people but 2 or more conditions (df2 = 2 or more).</span>
<span id="cb120-493"><a href="#cb120-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-494"><a href="#cb120-494" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-495"><a href="#cb120-495" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-496"><a href="#cb120-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-499"><a href="#cb120-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-500"><a href="#cb120-500" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb120-501"><a href="#cb120-501" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_function(fun = df, args =list(df1 =5, df2=1), xlim = c(2,4), geom = "area") + </span></span>
<span id="cb120-502"><a href="#cb120-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">1</span>), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-503"><a href="#cb120-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb120-504"><a href="#cb120-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> df, <span class="at">args =</span><span class="fu">list</span>(<span class="at">df1 =</span><span class="dv">100</span>, <span class="at">df2=</span><span class="dv">3</span>), <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb120-505"><a href="#cb120-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">4</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=1"</span>, <span class="at">colour=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-506"><a href="#cb120-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">35</span>, <span class="at">label =</span> <span class="st">"df1 = 100, df2=2"</span>, <span class="at">colour=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb120-507"><a href="#cb120-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">label  =</span> <span class="st">"df1 = 100, df2=3"</span>, <span class="at">colour=</span><span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb120-508"><a href="#cb120-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F-Value"</span>) <span class="sc">+</span></span>
<span id="cb120-509"><a href="#cb120-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span>
<span id="cb120-510"><a href="#cb120-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-511"><a href="#cb120-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-512"><a href="#cb120-512" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-513"><a href="#cb120-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-516"><a href="#cb120-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-517"><a href="#cb120-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-518"><a href="#cb120-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-519"><a href="#cb120-519" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, stat_function, annotate, labs</span>
<span id="cb120-520"><a href="#cb120-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-521"><a href="#cb120-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with x values</span></span>
<span id="cb120-522"><a href="#cb120-522" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">4</span>]})</span>
<span id="cb120-523"><a href="#cb120-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-524"><a href="#cb120-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb120-525"><a href="#cb120-525" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb120-526"><a href="#cb120-526" aria-hidden="true" tabindex="-1"></a>    ggplot(df, aes(x<span class="op">=</span><span class="st">'x'</span>))</span>
<span id="cb120-527"><a href="#cb120-527" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-528"><a href="#cb120-528" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb120-529"><a href="#cb120-529" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'blue'</span></span>
<span id="cb120-530"><a href="#cb120-530" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-531"><a href="#cb120-531" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-532"><a href="#cb120-532" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb120-533"><a href="#cb120-533" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'red'</span></span>
<span id="cb120-534"><a href="#cb120-534" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-535"><a href="#cb120-535" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> stat_function(</span>
<span id="cb120-536"><a href="#cb120-536" aria-hidden="true" tabindex="-1"></a>        fun<span class="op">=</span><span class="kw">lambda</span> x: f.pdf(x, dfn<span class="op">=</span><span class="dv">100</span>, dfd<span class="op">=</span><span class="dv">3</span>),</span>
<span id="cb120-537"><a href="#cb120-537" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">'green'</span></span>
<span id="cb120-538"><a href="#cb120-538" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-539"><a href="#cb120-539" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-540"><a href="#cb120-540" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.4</span>, label<span class="op">=</span><span class="st">"df1=100, df2=1"</span>, color<span class="op">=</span><span class="st">"blue"</span></span>
<span id="cb120-541"><a href="#cb120-541" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-542"><a href="#cb120-542" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-543"><a href="#cb120-543" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.35</span>, label<span class="op">=</span><span class="st">"df1=100, df2=2"</span>, color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb120-544"><a href="#cb120-544" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-545"><a href="#cb120-545" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> annotate(</span>
<span id="cb120-546"><a href="#cb120-546" aria-hidden="true" tabindex="-1"></a>        <span class="st">"label"</span>, x<span class="op">=</span><span class="dv">2</span>, y<span class="op">=</span><span class="fl">0.3</span>, label<span class="op">=</span><span class="st">"df1=100, df2=3"</span>, color<span class="op">=</span><span class="st">"green"</span></span>
<span id="cb120-547"><a href="#cb120-547" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-548"><a href="#cb120-548" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(x<span class="op">=</span><span class="st">"F-Value"</span>, y<span class="op">=</span><span class="st">"Density"</span>)</span>
<span id="cb120-549"><a href="#cb120-549" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-550"><a href="#cb120-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-551"><a href="#cb120-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-552"><a href="#cb120-552" aria-hidden="true" tabindex="-1"></a><span class="al">![F-Distribution Density Curves'](TTests_Figure8.png)</span>{fig-align="left" width="650"}</span>
<span id="cb120-553"><a href="#cb120-553" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-554"><a href="#cb120-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-555"><a href="#cb120-555" aria-hidden="true" tabindex="-1"></a>In all cases, you get your p-value from calculating the area under the curve for that F-value or above.</span>
<span id="cb120-556"><a href="#cb120-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-557"><a href="#cb120-557" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb120-558"><a href="#cb120-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-559"><a href="#cb120-559" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" appearance="minimal"}</span>
<span id="cb120-560"><a href="#cb120-560" aria-hidden="true" tabindex="-1"></a><span class="fu">## F-value approach (AKA General Linear Model (GLM) approach)</span></span>
<span id="cb120-561"><a href="#cb120-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-562"><a href="#cb120-562" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb120-563"><a href="#cb120-563" aria-hidden="true" tabindex="-1"></a><span class="fu">## internal callout</span></span>
<span id="cb120-564"><a href="#cb120-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-565"><a href="#cb120-565" aria-hidden="true" tabindex="-1"></a>beep bop</span>
<span id="cb120-566"><a href="#cb120-566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-567"><a href="#cb120-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-568"><a href="#cb120-568" aria-hidden="true" tabindex="-1"></a>To calculate the F-Value, we want to create a model that captures **explained variance** and **unexplained variance**. This model will aim to explain any variance around the population mean (mu or $\mu$). The sample mean could be modeled as such:</span>
<span id="cb120-569"><a href="#cb120-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-570"><a href="#cb120-570" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-571"><a href="#cb120-571" aria-hidden="true" tabindex="-1"></a>y = \bar{y} + e</span>
<span id="cb120-572"><a href="#cb120-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-573"><a href="#cb120-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-574"><a href="#cb120-574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ is the data point value you are trying to predict.</span>
<span id="cb120-575"><a href="#cb120-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-576"><a href="#cb120-576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{y}$ is mean of all y data points. Note that for this formula you will **always** have the same predicted outcome (the mean).</span>
<span id="cb120-577"><a href="#cb120-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-578"><a href="#cb120-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e$ is the error, i.e. the residuals that the module do not predict effectively.</span>
<span id="cb120-579"><a href="#cb120-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-580"><a href="#cb120-580" aria-hidden="true" tabindex="-1"></a>If the sample mean is a useful model, then it will explain a large proportion of the variance around the <span class="co">[</span><span class="ot">Mu</span><span class="co">]</span>{#population_tippy style="color:#006688"} ($\mu$) and will also suggested that there is significant reason to reject the $\mu$ as the real mean of your population.</span>
<span id="cb120-581"><a href="#cb120-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-582"><a href="#cb120-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb120-583"><a href="#cb120-583" aria-hidden="true" tabindex="-1"></a>tippy<span class="sc">::</span><span class="fu">tippy_this</span>(<span class="at">elementId =</span> <span class="st">"population_tippy"</span>, <span class="at">tooltip =</span> <span class="st">"Baseline value"</span>)</span>
<span id="cb120-584"><a href="#cb120-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-585"><a href="#cb120-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-586"><a href="#cb120-586" aria-hidden="true" tabindex="-1"></a>First, we need to capture how much variance there is around the $\mu$, which we'll do using sum of squares:</span>
<span id="cb120-587"><a href="#cb120-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-588"><a href="#cb120-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-589"><a href="#cb120-589" aria-hidden="true" tabindex="-1"></a>SS_{total} = \sum(y_i-\mu)^2</span>
<span id="cb120-590"><a href="#cb120-590" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-591"><a href="#cb120-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-592"><a href="#cb120-592" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y_i$ is an individual data point</span>
<span id="cb120-593"><a href="#cb120-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-594"><a href="#cb120-594" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb120-595"><a href="#cb120-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-596"><a href="#cb120-596" aria-hidden="true" tabindex="-1"></a>Which for the above data would give us:</span>
<span id="cb120-597"><a href="#cb120-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-598"><a href="#cb120-598" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-599"><a href="#cb120-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-600"><a href="#cb120-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-603"><a href="#cb120-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-604"><a href="#cb120-604" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="dv">55</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-605"><a href="#cb120-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-606"><a href="#cb120-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-607"><a href="#cb120-607" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-608"><a href="#cb120-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-611"><a href="#cb120-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-612"><a href="#cb120-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-613"><a href="#cb120-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-614"><a href="#cb120-614" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy </span></span>
<span id="cb120-615"><a href="#cb120-615" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb120-616"><a href="#cb120-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-617"><a href="#cb120-617" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the squared dfference</span></span>
<span id="cb120-618"><a href="#cb120-618" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> <span class="dv">55</span>) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb120-619"><a href="#cb120-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-620"><a href="#cb120-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-621"><a href="#cb120-621" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-622"><a href="#cb120-622" aria-hidden="true" tabindex="-1"></a><span class="in">41025.157014</span></span>
<span id="cb120-623"><a href="#cb120-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-624"><a href="#cb120-624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-625"><a href="#cb120-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-626"><a href="#cb120-626" aria-hidden="true" tabindex="-1"></a>So we have to explain 41025.16 in variance around the $\mu$.</span>
<span id="cb120-627"><a href="#cb120-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-628"><a href="#cb120-628" aria-hidden="true" tabindex="-1"></a>Our model's explanation of variance around the $\mu$ is the sample mean ($\bar{y}$). For each data point the variance explained (from the $mu$) is the difference between $\mu$ and $\bar{y}$, and then that leaves the unexplained variance (from the $mu$) as the difference between the data point and the sample mean ($\bar{y}$). If we visualise this for a single data point it should look something like:</span>
<span id="cb120-629"><a href="#cb120-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-630"><a href="#cb120-630" aria-hidden="true" tabindex="-1"></a><span class="al">![](mu_vs_mean/Slide1.png)</span></span>
<span id="cb120-631"><a href="#cb120-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-632"><a href="#cb120-632" aria-hidden="true" tabindex="-1"></a>For the above data point the variance (around the $\mu$) explained is $\bar{y} - \mu = 67.007 - 55 = 22.007$. However, we can see that the model isn't perfect for this data point, and so there is a residual left over, i.e. a difference between the predicted value of 67.007 and the actual value of 58.04, meaning the unexplained variance is $67.007 - 58.04 = 8.967$.</span>
<span id="cb120-633"><a href="#cb120-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-634"><a href="#cb120-634" aria-hidden="true" tabindex="-1"></a>Your explained variance by this model is thus a repetition of comparisons of the $\mu$ and $\bar{y}$ as many times as there are data points (and squaring this difference to make the values positive):</span>
<span id="cb120-635"><a href="#cb120-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-636"><a href="#cb120-636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-637"><a href="#cb120-637" aria-hidden="true" tabindex="-1"></a>SS_{explained} = N * (\mu - \bar{x})^2</span>
<span id="cb120-638"><a href="#cb120-638" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-639"><a href="#cb120-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-640"><a href="#cb120-640" aria-hidden="true" tabindex="-1"></a>Which for the above data would give us:</span>
<span id="cb120-641"><a href="#cb120-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-642"><a href="#cb120-642" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-643"><a href="#cb120-643" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-644"><a href="#cb120-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-647"><a href="#cb120-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-648"><a href="#cb120-648" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb120-649"><a href="#cb120-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-650"><a href="#cb120-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-651"><a href="#cb120-651" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-652"><a href="#cb120-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-655"><a href="#cb120-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-656"><a href="#cb120-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-657"><a href="#cb120-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-658"><a href="#cb120-658" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span>( <span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean())<span class="op">**</span><span class="dv">2</span></span>
<span id="cb120-659"><a href="#cb120-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-660"><a href="#cb120-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-661"><a href="#cb120-661" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-662"><a href="#cb120-662" aria-hidden="true" tabindex="-1"></a><span class="in">20473.303823352093</span></span>
<span id="cb120-663"><a href="#cb120-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-664"><a href="#cb120-664" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-665"><a href="#cb120-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-666"><a href="#cb120-666" aria-hidden="true" tabindex="-1"></a>As described above, unexplained variance is the residuals around the sample mean, as this is variance that is not explained by the model. We can summarise what we get when we calculate the sum of squares of these residuals around the sample mean as follows:</span>
<span id="cb120-667"><a href="#cb120-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-668"><a href="#cb120-668" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-669"><a href="#cb120-669" aria-hidden="true" tabindex="-1"></a>SS_{unexplained} = \sum(x_i-\bar{x})^2</span>
<span id="cb120-670"><a href="#cb120-670" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-671"><a href="#cb120-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-672"><a href="#cb120-672" aria-hidden="true" tabindex="-1"></a>Which for the above data would give us</span>
<span id="cb120-673"><a href="#cb120-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-674"><a href="#cb120-674" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-675"><a href="#cb120-675" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-676"><a href="#cb120-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-679"><a href="#cb120-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-680"><a href="#cb120-680" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-681"><a href="#cb120-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-682"><a href="#cb120-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-683"><a href="#cb120-683" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-684"><a href="#cb120-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-687"><a href="#cb120-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-688"><a href="#cb120-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-689"><a href="#cb120-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-690"><a href="#cb120-690" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb120-691"><a href="#cb120-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-692"><a href="#cb120-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-693"><a href="#cb120-693" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-694"><a href="#cb120-694" aria-hidden="true" tabindex="-1"></a><span class="in">20551.853190647882</span></span>
<span id="cb120-695"><a href="#cb120-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-696"><a href="#cb120-696" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-697"><a href="#cb120-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-698"><a href="#cb120-698" aria-hidden="true" tabindex="-1"></a>To capture the effectiveness of the model we can calculate the F-value:</span>
<span id="cb120-699"><a href="#cb120-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-700"><a href="#cb120-700" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-701"><a href="#cb120-701" aria-hidden="true" tabindex="-1"></a>F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{20473.3/(Predictors)}{20551.85/(N-1)} = \frac{20473.3/1}{20551.85/141} </span>
<span id="cb120-702"><a href="#cb120-702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-703"><a href="#cb120-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-704"><a href="#cb120-704" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-705"><a href="#cb120-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-706"><a href="#cb120-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-709"><a href="#cb120-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-710"><a href="#cb120-710" aria-hidden="true" tabindex="-1"></a>f_value <span class="ot">=</span> (<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp) <span class="sc">*</span> (<span class="dv">55</span><span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (</span>
<span id="cb120-711"><a href="#cb120-711" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sum</span>((gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">length</span>(gapminder_2007<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb120-712"><a href="#cb120-712" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-713"><a href="#cb120-713" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-714"><a href="#cb120-714" aria-hidden="true" tabindex="-1"></a>f_value</span>
<span id="cb120-715"><a href="#cb120-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-716"><a href="#cb120-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-717"><a href="#cb120-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-718"><a href="#cb120-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-721"><a href="#cb120-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-722"><a href="#cb120-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-723"><a href="#cb120-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-724"><a href="#cb120-724" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences between each value in 'lifeExp' and the mean</span></span>
<span id="cb120-725"><a href="#cb120-725" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">*</span> (<span class="dv">55</span> <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb120-726"><a href="#cb120-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-727"><a href="#cb120-727" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum of squared differences within groups</span></span>
<span id="cb120-728"><a href="#cb120-728" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> np.<span class="bu">sum</span>((gapminder_2007[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_2007[<span class="st">'lifeExp'</span>].mean()) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb120-729"><a href="#cb120-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-730"><a href="#cb120-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the degrees of freedom for between groups and within groups</span></span>
<span id="cb120-731"><a href="#cb120-731" aria-hidden="true" tabindex="-1"></a>df_between <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb120-732"><a href="#cb120-732" aria-hidden="true" tabindex="-1"></a>df_within <span class="op">=</span> <span class="bu">len</span>(gapminder_2007[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb120-733"><a href="#cb120-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-734"><a href="#cb120-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the F-statistic</span></span>
<span id="cb120-735"><a href="#cb120-735" aria-hidden="true" tabindex="-1"></a>f_value <span class="op">=</span> (ss_between <span class="op">/</span> df_between) <span class="op">/</span> (ss_within <span class="op">/</span> df_within)</span>
<span id="cb120-736"><a href="#cb120-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-737"><a href="#cb120-737" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f_value)</span>
<span id="cb120-738"><a href="#cb120-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-739"><a href="#cb120-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-740"><a href="#cb120-740" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-741"><a href="#cb120-741" aria-hidden="true" tabindex="-1"></a><span class="in">140.46109673488004</span></span>
<span id="cb120-742"><a href="#cb120-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-743"><a href="#cb120-743" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-744"><a href="#cb120-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-745"><a href="#cb120-745" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb120-746"><a href="#cb120-746" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-747"><a href="#cb120-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-748"><a href="#cb120-748" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb120-749"><a href="#cb120-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-750"><a href="#cb120-750" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANVOA vs. T-test formula</span></span>
<span id="cb120-751"><a href="#cb120-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-752"><a href="#cb120-752" aria-hidden="true" tabindex="-1"></a>Great. So now that we've highlighted the GLM approach works for t-tests, can we see how our formula for a GLM simplifies to the formula we usually use for one-sample t-tests:</span>
<span id="cb120-753"><a href="#cb120-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-754"><a href="#cb120-754" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-755"><a href="#cb120-755" aria-hidden="true" tabindex="-1"></a>T = \sqrt{F} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \sqrt{\frac{N * (\mu - \bar{x})^2/(levelsOfPredictors - 1)}{\sum(x_i-\bar{x})^2/(N-1)}} =</span>
<span id="cb120-756"><a href="#cb120-756" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-757"><a href="#cb120-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-758"><a href="#cb120-758" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-759"><a href="#cb120-759" aria-hidden="true" tabindex="-1"></a>\sqrt{\frac{N * (\mu - \bar{x})^2/(2-1)}{\sigma^2}} = \frac{\sqrt{N * (\mu - \bar{x})^2}}{\sqrt{\sigma^2}} = \frac{\sqrt{(\mu - \bar{x})^2}}{\sigma/\sqrt{N}} = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}</span>
<span id="cb120-760"><a href="#cb120-760" aria-hidden="true" tabindex="-1"></a>$$ where:</span>
<span id="cb120-761"><a href="#cb120-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-762"><a href="#cb120-762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$T$ is the t-value</span>
<span id="cb120-763"><a href="#cb120-763" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$F$ is the f-value</span>
<span id="cb120-764"><a href="#cb120-764" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{exp}$ is the sum of squares of the data explained by the model</span>
<span id="cb120-765"><a href="#cb120-765" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SS_{unexp}$ is the sum of squares of the data not explained by the model (i.e. the residuals)</span>
<span id="cb120-766"><a href="#cb120-766" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$df_{exp}$ is the degrees of freedom for the model. As there is only one predictor (the sample mean) and it's only got 2 levels (1 or 0, however, in all cases the model is comparing the data to the mean, so it's less intuitive that there are 2 levels).</span>
<span id="cb120-767"><a href="#cb120-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-768"><a href="#cb120-768" aria-hidden="true" tabindex="-1"></a>To confirm, the formula for a one-sample t-test is just:</span>
<span id="cb120-769"><a href="#cb120-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-770"><a href="#cb120-770" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-771"><a href="#cb120-771" aria-hidden="true" tabindex="-1"></a>T = \frac{\mu - \bar{x}}{\sigma/\sqrt{N}}</span>
<span id="cb120-772"><a href="#cb120-772" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-773"><a href="#cb120-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-774"><a href="#cb120-774" aria-hidden="true" tabindex="-1"></a>F-values are squares of t-values, so let's see if this is true here also:</span>
<span id="cb120-775"><a href="#cb120-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-776"><a href="#cb120-776" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-777"><a href="#cb120-777" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-778"><a href="#cb120-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-781"><a href="#cb120-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-782"><a href="#cb120-782" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(f_value)</span>
<span id="cb120-783"><a href="#cb120-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-784"><a href="#cb120-784" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="at">mu=</span><span class="dv">55</span>)</span>
<span id="cb120-785"><a href="#cb120-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-786"><a href="#cb120-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-787"><a href="#cb120-787" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-788"><a href="#cb120-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-791"><a href="#cb120-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-792"><a href="#cb120-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-793"><a href="#cb120-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-794"><a href="#cb120-794" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb120-795"><a href="#cb120-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-796"><a href="#cb120-796" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the square root of the F-value</span></span>
<span id="cb120-797"><a href="#cb120-797" aria-hidden="true" tabindex="-1"></a>np.sqrt(f_value)</span>
<span id="cb120-798"><a href="#cb120-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-799"><a href="#cb120-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-800"><a href="#cb120-800" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-801"><a href="#cb120-801" aria-hidden="true" tabindex="-1"></a><span class="in">11.851628442323022</span></span>
<span id="cb120-802"><a href="#cb120-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-803"><a href="#cb120-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-806"><a href="#cb120-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-807"><a href="#cb120-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-808"><a href="#cb120-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-809"><a href="#cb120-809" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb120-810"><a href="#cb120-810" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2007[<span class="st">'lifeExp'</span>], popmean<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb120-811"><a href="#cb120-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-812"><a href="#cb120-812" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb120-813"><a href="#cb120-813" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span>
<span id="cb120-814"><a href="#cb120-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-815"><a href="#cb120-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-816"><a href="#cb120-816" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-817"><a href="#cb120-817" aria-hidden="true" tabindex="-1"></a><span class="in">t-statistic: 11.851628442323024</span></span>
<span id="cb120-818"><a href="#cb120-818" aria-hidden="true" tabindex="-1"></a><span class="in">p-value: 6.463174215427706e-23</span></span>
<span id="cb120-819"><a href="#cb120-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-820"><a href="#cb120-820" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-821"><a href="#cb120-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-822"><a href="#cb120-822" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired samples t-tests</span></span>
<span id="cb120-823"><a href="#cb120-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-824"><a href="#cb120-824" aria-hidden="true" tabindex="-1"></a>Paired samples t-tests can be approached like 1-sample t-tests, but you first of all need to collapse the data to have a single variable to compare to a $\mu$ of zero. Let's do this for gapminder data, comparing life expectancy between 2002 and 2007:</span>
<span id="cb120-825"><a href="#cb120-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-826"><a href="#cb120-826" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-827"><a href="#cb120-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-828"><a href="#cb120-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-831"><a href="#cb120-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-832"><a href="#cb120-832" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="ot">&lt;-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>] <span class="sc">-</span> gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>]</span>
<span id="cb120-833"><a href="#cb120-833" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder_2002_2007_life_exp, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb120-834"><a href="#cb120-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-835"><a href="#cb120-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-836"><a href="#cb120-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-837"><a href="#cb120-837" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-838"><a href="#cb120-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-841"><a href="#cb120-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-842"><a href="#cb120-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-843"><a href="#cb120-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-844"><a href="#cb120-844" aria-hidden="true" tabindex="-1"></a>gapminder_2002_2007_life_exp <span class="op">=</span> life_exp_2007.reset_index(drop<span class="op">=</span><span class="va">True</span>) <span class="op">-</span> life_exp_2002.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb120-845"><a href="#cb120-845" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_1samp(gapminder_2002_2007_life_exp, popmean<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb120-846"><a href="#cb120-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-847"><a href="#cb120-847" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t-statistic:"</span>, t_statistic)</span>
<span id="cb120-848"><a href="#cb120-848" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"p-value:"</span>, p_value)</span>
<span id="cb120-849"><a href="#cb120-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-850"><a href="#cb120-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-851"><a href="#cb120-851" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-852"><a href="#cb120-852" aria-hidden="true" tabindex="-1"></a><span class="in">t-statistic: 14.664513524875451</span></span>
<span id="cb120-853"><a href="#cb120-853" aria-hidden="true" tabindex="-1"></a><span class="in">p-value: 3.738316746290281e-30</span></span>
<span id="cb120-854"><a href="#cb120-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-855"><a href="#cb120-855" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-856"><a href="#cb120-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-857"><a href="#cb120-857" aria-hidden="true" tabindex="-1"></a>The above suggests that life expectancy was significantly different. Let's see if we get the exact same value when we use a paired t-test in R:</span>
<span id="cb120-858"><a href="#cb120-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-859"><a href="#cb120-859" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-860"><a href="#cb120-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-861"><a href="#cb120-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-864"><a href="#cb120-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-865"><a href="#cb120-865" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>],gapminder<span class="sc">$</span>lifeExp[gapminder<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>], <span class="at">paired=</span>T)</span>
<span id="cb120-866"><a href="#cb120-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-867"><a href="#cb120-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-868"><a href="#cb120-868" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-869"><a href="#cb120-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-872"><a href="#cb120-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-873"><a href="#cb120-873" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-874"><a href="#cb120-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-875"><a href="#cb120-875" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2007</span></span>
<span id="cb120-876"><a href="#cb120-876" aria-hidden="true" tabindex="-1"></a>life_exp_2007 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2007</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb120-877"><a href="#cb120-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-878"><a href="#cb120-878" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for the year 2002</span></span>
<span id="cb120-879"><a href="#cb120-879" aria-hidden="true" tabindex="-1"></a>life_exp_2002 <span class="op">=</span> gapminder[gapminder[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2002</span>][<span class="st">'lifeExp'</span>]</span>
<span id="cb120-880"><a href="#cb120-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-881"><a href="#cb120-881" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a paired t-test</span></span>
<span id="cb120-882"><a href="#cb120-882" aria-hidden="true" tabindex="-1"></a>t_statistic, p_value <span class="op">=</span> stats.ttest_rel(life_exp_2007, life_exp_2002)</span>
<span id="cb120-883"><a href="#cb120-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-884"><a href="#cb120-884" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"T-statistic:"</span>, t_statistic)</span>
<span id="cb120-885"><a href="#cb120-885" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"P-value:"</span>, p_value)</span>
<span id="cb120-886"><a href="#cb120-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-887"><a href="#cb120-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-888"><a href="#cb120-888" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-889"><a href="#cb120-889" aria-hidden="true" tabindex="-1"></a><span class="in">t-statistic: 14.664513524875451</span></span>
<span id="cb120-890"><a href="#cb120-890" aria-hidden="true" tabindex="-1"></a><span class="in">p-value: 3.738316746290281e-30</span></span>
<span id="cb120-891"><a href="#cb120-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-892"><a href="#cb120-892" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-893"><a href="#cb120-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-894"><a href="#cb120-894" aria-hidden="true" tabindex="-1"></a>Looks identical. Let's compare formulas to see why this is ( $\mu$ = 0 , and so it isn't written) :</span>
<span id="cb120-895"><a href="#cb120-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-896"><a href="#cb120-896" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-897"><a href="#cb120-897" aria-hidden="true" tabindex="-1"></a> t_{paired} = \frac{\bar{x_1} - \bar{x_2}}{\sigma_{pooled}/\sqrt{N}} = \frac{\bar{x_3}}{\sigma_{pooled}/\sqrt{N}}</span>
<span id="cb120-898"><a href="#cb120-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-899"><a href="#cb120-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-900"><a href="#cb120-900" aria-hidden="true" tabindex="-1"></a>Where</span>
<span id="cb120-901"><a href="#cb120-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-902"><a href="#cb120-902" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{x_1}$ is the mean of condition 1</span>
<span id="cb120-903"><a href="#cb120-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-904"><a href="#cb120-904" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{x_2}$ is the mean of condition 2</span>
<span id="cb120-905"><a href="#cb120-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-906"><a href="#cb120-906" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{x_3}$ is the mean of the result you get when you subtract condition 2 from condition 1 for each participant, i.e. $mean(x_1-x_2)$.</span>
<span id="cb120-907"><a href="#cb120-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-908"><a href="#cb120-908" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$$</span>
<span id="cb120-909"><a href="#cb120-909" aria-hidden="true" tabindex="-1"></a>    \sigma_{pooled}  = \sqrt{\frac{\sigma_1^2 + \sigma_2^2}{2}} OR \frac{\sum(x_1 - x_2)^2}{N-1} </span>
<span id="cb120-910"><a href="#cb120-910" aria-hidden="true" tabindex="-1"></a>    $$ One way effectively gets the average of the standard deviations of condition and 1. The second way gets the standard deviation of the differences between conditions 1 and 2. Both give you the same outcome.</span>
<span id="cb120-911"><a href="#cb120-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-912"><a href="#cb120-912" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$N$ is the number of participants</span>
<span id="cb120-913"><a href="#cb120-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-914"><a href="#cb120-914" aria-hidden="true" tabindex="-1"></a>You can rewrite the above formula to compare $\bar{x_3}$ to $\mu$, as we know $\mu$ is zero, which would make this formula (effectively) identical to the one above for one-sample t-tests:</span>
<span id="cb120-915"><a href="#cb120-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-916"><a href="#cb120-916" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-917"><a href="#cb120-917" aria-hidden="true" tabindex="-1"></a>\frac{\bar{x_3} - \mu}{\sigma_{pooled}/\sqrt{N}}</span>
<span id="cb120-918"><a href="#cb120-918" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-919"><a href="#cb120-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-920"><a href="#cb120-920" aria-hidden="true" tabindex="-1"></a>The following explains how to calculate F if analysing your data as a model. This isn't necessary if you just want to complete a t-test, but does help clarify how t-tests overlap with ANOVAs and regressions.</span>
<span id="cb120-921"><a href="#cb120-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-922"><a href="#cb120-922" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb120-923"><a href="#cb120-923" aria-hidden="true" tabindex="-1"></a><span class="fu">## F and value</span></span>
<span id="cb120-924"><a href="#cb120-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-925"><a href="#cb120-925" aria-hidden="true" tabindex="-1"></a>To calculate the F value we will use the following formula:</span>
<span id="cb120-926"><a href="#cb120-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-927"><a href="#cb120-927" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-928"><a href="#cb120-928" aria-hidden="true" tabindex="-1"></a>F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}}</span>
<span id="cb120-929"><a href="#cb120-929" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-930"><a href="#cb120-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-931"><a href="#cb120-931" aria-hidden="true" tabindex="-1"></a>So the question is, what is our model, and what is explained and what is not explained by it. Our model is that life expectancy is explained by year. We predict that any difference between 2002 and 2007 in life expectancy in ***any*** country's is the ***mean*** life expectancy difference across all countries. The sum of squares thus is the mean difference between 2007 and 2002's life expectancy multiplied by the number of countries:</span>
<span id="cb120-932"><a href="#cb120-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-933"><a href="#cb120-933" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-934"><a href="#cb120-934" aria-hidden="true" tabindex="-1"></a>SS_{explained} = \sum_{country}{{((\bar{lifeExp}_{2007} - \bar{lifeExp}_{2002}})^2)} = ((\bar{lifeExp}_{2007} - \bar{lifeExp}_{2002})^2) * N_{countries}</span>
<span id="cb120-935"><a href="#cb120-935" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-936"><a href="#cb120-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-939"><a href="#cb120-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-940"><a href="#cb120-940" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb120-941"><a href="#cb120-941" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb120-942"><a href="#cb120-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">2002</span>) <span class="ot">-&gt;</span> gapminder_2007_2002</span>
<span id="cb120-943"><a href="#cb120-943" aria-hidden="true" tabindex="-1"></a>explained_ss <span class="ot">=</span> ((<span class="fu">mean</span>(gapminder_2007_2002<span class="sc">$</span>lifeExp[gapminder_2007_2002<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2002</span>]) <span class="sc">-</span> <span class="fu">mean</span>(gapminder_2007_2002<span class="sc">$</span>lifeExp[gapminder_2007_2002<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2007</span>]))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">unique</span>(gapminder_2007_2002<span class="sc">$</span>country))</span>
<span id="cb120-944"><a href="#cb120-944" aria-hidden="true" tabindex="-1"></a>explained_ss</span>
<span id="cb120-945"><a href="#cb120-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-946"><a href="#cb120-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-947"><a href="#cb120-947" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-948"><a href="#cb120-948" aria-hidden="true" tabindex="-1"></a>SS_{unexplained} = SS_{total} - SS_{explained}</span>
<span id="cb120-949"><a href="#cb120-949" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-950"><a href="#cb120-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-951"><a href="#cb120-951" aria-hidden="true" tabindex="-1"></a>So we need to calculate the total Sum of Squares, which is all variance between 2002 and 2007 for each country (squared):</span>
<span id="cb120-952"><a href="#cb120-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-953"><a href="#cb120-953" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-954"><a href="#cb120-954" aria-hidden="true" tabindex="-1"></a>SS_{total} = \sum{((lifeExp_{2007} - lifeExp_{2002})^2)}</span>
<span id="cb120-955"><a href="#cb120-955" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-956"><a href="#cb120-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-959"><a href="#cb120-959" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-960"><a href="#cb120-960" aria-hidden="true" tabindex="-1"></a><span class="co"># restructuring data to simplify processing</span></span>
<span id="cb120-961"><a href="#cb120-961" aria-hidden="true" tabindex="-1"></a>gapminder_2007_2002 <span class="sc">%&gt;%</span> </span>
<span id="cb120-962"><a href="#cb120-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb120-963"><a href="#cb120-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>year, <span class="at">values_from =</span> lifeExp)  <span class="ot">-&gt;</span> gapminder_wide</span>
<span id="cb120-964"><a href="#cb120-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-965"><a href="#cb120-965" aria-hidden="true" tabindex="-1"></a>total_ss <span class="ot">=</span> <span class="fu">sum</span>((gapminder_wide[[<span class="st">"2002"</span>]] <span class="sc">-</span> gapminder_wide[[<span class="st">"2007"</span>]])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-966"><a href="#cb120-966" aria-hidden="true" tabindex="-1"></a>total_ss</span>
<span id="cb120-967"><a href="#cb120-967" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-968"><a href="#cb120-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-969"><a href="#cb120-969" aria-hidden="true" tabindex="-1"></a>To calculate the unexplained variance, let's subtract the explained from total sum of squares</span>
<span id="cb120-970"><a href="#cb120-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-973"><a href="#cb120-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-974"><a href="#cb120-974" aria-hidden="true" tabindex="-1"></a>unexplained_ss <span class="ot">=</span> total_ss <span class="sc">-</span> explained_ss</span>
<span id="cb120-975"><a href="#cb120-975" aria-hidden="true" tabindex="-1"></a>unexplained_ss</span>
<span id="cb120-976"><a href="#cb120-976" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-977"><a href="#cb120-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-978"><a href="#cb120-978" aria-hidden="true" tabindex="-1"></a>Now we can complete the above formula taking into account the explained degrees of freedom is 1 (2 levels -1 = 1), and the unexplained degrees of freedom is 141 (142 countries - 1 = 141):</span>
<span id="cb120-979"><a href="#cb120-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-980"><a href="#cb120-980" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-981"><a href="#cb120-981" aria-hidden="true" tabindex="-1"></a>F = \frac{SS_{explained}/df_{explained}}{SS_{unexplained}/df_{unexplained}} = \frac{244.6172/1}{160.3876/141} = 215.048</span>
<span id="cb120-982"><a href="#cb120-982" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-983"><a href="#cb120-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-984"><a href="#cb120-984" aria-hidden="true" tabindex="-1"></a>Let's check if this is the same value we get using a function:</span>
<span id="cb120-985"><a href="#cb120-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-988"><a href="#cb120-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-989"><a href="#cb120-989" aria-hidden="true" tabindex="-1"></a>ez<span class="sc">::</span><span class="fu">ezANOVA</span>(gapminder_2007_2002, <span class="at">within =</span> year, <span class="at">dv=</span> lifeExp, <span class="at">wid =</span> country)<span class="sc">$</span>ANOVA<span class="sc">$</span>F</span>
<span id="cb120-990"><a href="#cb120-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-991"><a href="#cb120-991" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-992"><a href="#cb120-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-993"><a href="#cb120-993" aria-hidden="true" tabindex="-1"></a><span class="fu">## Independent Samples t-tests</span></span>
<span id="cb120-994"><a href="#cb120-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-995"><a href="#cb120-995" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA approach</span></span>
<span id="cb120-996"><a href="#cb120-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-997"><a href="#cb120-997" aria-hidden="true" tabindex="-1"></a>T-tests are restricted to comparisons between 2 conditions/groups, so we will restrict the Gapminder data to allow a comparison between 2 continents. To see if life expectancy was different if you are born in Europe compared to the Americas, let's first check what the sum of squares is when you just use the **mean** as the model of life expectancy **across** these contents (so we're **not** separating by continent yet):</span>
<span id="cb120-998"><a href="#cb120-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-999"><a href="#cb120-999" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1000"><a href="#cb120-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1001"><a href="#cb120-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1004"><a href="#cb120-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1005"><a href="#cb120-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mean-life-exp-resid-2-continents</span></span>
<span id="cb120-1006"><a href="#cb120-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The errors around the mean of life expectancy across Europe and American countries"</span></span>
<span id="cb120-1007"><a href="#cb120-1007" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb120-1008"><a href="#cb120-1008" aria-hidden="true" tabindex="-1"></a>  gapminder_2007,   <span class="co"># the data set</span></span>
<span id="cb120-1009"><a href="#cb120-1009" aria-hidden="true" tabindex="-1"></a>  continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span></span>
<span id="cb120-1010"><a href="#cb120-1010" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-1011"><a href="#cb120-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1012"><a href="#cb120-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb120-1013"><a href="#cb120-1013" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb120-1014"><a href="#cb120-1014" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb120-1015"><a href="#cb120-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb120-1016"><a href="#cb120-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb120-1017"><a href="#cb120-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-1018"><a href="#cb120-1018" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-1019"><a href="#cb120-1019" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb120-1020"><a href="#cb120-1020" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb120-1021"><a href="#cb120-1021" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb120-1022"><a href="#cb120-1022" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-1023"><a href="#cb120-1023" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-1024"><a href="#cb120-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb120-1025"><a href="#cb120-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1026"><a href="#cb120-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1027"><a href="#cb120-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1028"><a href="#cb120-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1029"><a href="#cb120-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1032"><a href="#cb120-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1033"><a href="#cb120-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1034"><a href="#cb120-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1035"><a href="#cb120-1035" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb120-1036"><a href="#cb120-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1037"><a href="#cb120-1037" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>].rank()</span>
<span id="cb120-1038"><a href="#cb120-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1039"><a href="#cb120-1039" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb120-1040"><a href="#cb120-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1041"><a href="#cb120-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb120-1042"><a href="#cb120-1042" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], gapminder_americas_europe[<span class="st">"lifeExp"</span>], color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb120-1043"><a href="#cb120-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb120-1044"><a href="#cb120-1044" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'blue'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb120-1045"><a href="#cb120-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1046"><a href="#cb120-1046" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>], ymax<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1047"><a href="#cb120-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1048"><a href="#cb120-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb120-1049"><a href="#cb120-1049" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb120-1050"><a href="#cb120-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1051"><a href="#cb120-1051" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb120-1052"><a href="#cb120-1052" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb120-1053"><a href="#cb120-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1054"><a href="#cb120-1054" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb120-1055"><a href="#cb120-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1056"><a href="#cb120-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1057"><a href="#cb120-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1058"><a href="#cb120-1058" aria-hidden="true" tabindex="-1"></a><span class="al">![*Fig. 3.* The errors around the mean of life expectancy across Europe and American countries.](TTests_Figure2.png)</span>{fig-align="left" width="700" height="500"}</span>
<span id="cb120-1059"><a href="#cb120-1059" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1060"><a href="#cb120-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1061"><a href="#cb120-1061" aria-hidden="true" tabindex="-1"></a>Once we square the errors in the pink lines above, we'll get the **squares:**</span>
<span id="cb120-1062"><a href="#cb120-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1063"><a href="#cb120-1063" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1064"><a href="#cb120-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1065"><a href="#cb120-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1068"><a href="#cb120-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1069"><a href="#cb120-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mean-life-exp-resid-squared-2-continents</span></span>
<span id="cb120-1070"><a href="#cb120-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The squared errors around the mean of life expectancy across Europe and American countries"</span></span>
<span id="cb120-1071"><a href="#cb120-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb120-1072"><a href="#cb120-1072" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, </span>
<span id="cb120-1073"><a href="#cb120-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb120-1074"><a href="#cb120-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb120-1075"><a href="#cb120-1075" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb120-1076"><a href="#cb120-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb120-1077"><a href="#cb120-1077" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-1078"><a href="#cb120-1078" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb120-1079"><a href="#cb120-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb120-1080"><a href="#cb120-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-1081"><a href="#cb120-1081" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-1082"><a href="#cb120-1082" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb120-1083"><a href="#cb120-1083" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb120-1084"><a href="#cb120-1084" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb120-1085"><a href="#cb120-1085" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-1086"><a href="#cb120-1086" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb120-1087"><a href="#cb120-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb120-1088"><a href="#cb120-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1089"><a href="#cb120-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-1090"><a href="#cb120-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1091"><a href="#cb120-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1092"><a href="#cb120-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1093"><a href="#cb120-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1094"><a href="#cb120-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1097"><a href="#cb120-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1098"><a href="#cb120-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1099"><a href="#cb120-1099" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb120-1100"><a href="#cb120-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1101"><a href="#cb120-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot for the dataset</span></span>
<span id="cb120-1102"><a href="#cb120-1102" aria-hidden="true" tabindex="-1"></a>plt.scatter(gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>], (gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb120-1103"><a href="#cb120-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># only one line may be specified; full height</span></span>
<span id="cb120-1104"><a href="#cb120-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1105"><a href="#cb120-1105" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp_rank"</span>],ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1106"><a href="#cb120-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1107"><a href="#cb120-1107" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb120-1108"><a href="#cb120-1108" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"rank(lifeExp)"</span>)</span>
<span id="cb120-1109"><a href="#cb120-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1110"><a href="#cb120-1110" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb120-1111"><a href="#cb120-1111" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"(Life Expectancy - mean(Life Expectancy))^2"</span>)</span>
<span id="cb120-1112"><a href="#cb120-1112" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb120-1113"><a href="#cb120-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1114"><a href="#cb120-1114" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>((gapminder_americas_europe[<span class="st">"lifeExp"</span>]<span class="op">-</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb120-1115"><a href="#cb120-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1116"><a href="#cb120-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1117"><a href="#cb120-1117" aria-hidden="true" tabindex="-1"></a><span class="al">![The squared errors around the mean of life expectancy across Europe and American countries](TTests_Figure3.png)</span>{fig-align="left" width="700" height="500"}</span>
<span id="cb120-1118"><a href="#cb120-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1119"><a href="#cb120-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1120"><a href="#cb120-1120" aria-hidden="true" tabindex="-1"></a><span class="in">953.4477649818183</span></span>
<span id="cb120-1121"><a href="#cb120-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1122"><a href="#cb120-1122" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1123"><a href="#cb120-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1124"><a href="#cb120-1124" aria-hidden="true" tabindex="-1"></a>And when you add all of these together:</span>
<span id="cb120-1125"><a href="#cb120-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1126"><a href="#cb120-1126" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1127"><a href="#cb120-1127" aria-hidden="true" tabindex="-1"></a>SumOfSquares = \sum(Y_i-\bar{Y})^2 = 953.4478</span>
<span id="cb120-1128"><a href="#cb120-1128" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1129"><a href="#cb120-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1130"><a href="#cb120-1130" aria-hidden="true" tabindex="-1"></a><span class="fu"># this should be brought earlier!xs</span></span>
<span id="cb120-1131"><a href="#cb120-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1132"><a href="#cb120-1132" aria-hidden="true" tabindex="-1"></a>So the aim is to create models that explain the total sum of squares above.</span>
<span id="cb120-1133"><a href="#cb120-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1134"><a href="#cb120-1134" aria-hidden="true" tabindex="-1"></a>So if the model we create for a t-test would result in a smaller **sum of squares** then that suggests it's a more precise model for estimating life expectancy than simply using the **mean** as a model. This is because this would mean there's less **error** in this model. Let's model this using a t-test. For this we will need to effect code continent:</span>
<span id="cb120-1135"><a href="#cb120-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1136"><a href="#cb120-1136" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1137"><a href="#cb120-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1138"><a href="#cb120-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1141"><a href="#cb120-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1142"><a href="#cb120-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># create a column to place 1 or -1 for each row dependent on the country</span></span>
<span id="cb120-1143"><a href="#cb120-1143" aria-hidden="true" tabindex="-1"></a>contEffect <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb120-1144"><a href="#cb120-1144" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb120-1145"><a href="#cb120-1145" aria-hidden="true" tabindex="-1"></a>contEffect[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb120-1146"><a href="#cb120-1146" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">=</span> <span class="fu">cbind</span>(contEffect,gapminder_americas_europe)</span>
<span id="cb120-1147"><a href="#cb120-1147" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(gapminder_americas_europe))</span>
<span id="cb120-1148"><a href="#cb120-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1149"><a href="#cb120-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1150"><a href="#cb120-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1151"><a href="#cb120-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1154"><a href="#cb120-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1155"><a href="#cb120-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1156"><a href="#cb120-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1157"><a href="#cb120-1157" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_2007.loc[(gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>) <span class="op">|</span> (gapminder_2007[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]</span>
<span id="cb120-1158"><a href="#cb120-1158" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb120-1159"><a href="#cb120-1159" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb120-1160"><a href="#cb120-1160" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb120-1161"><a href="#cb120-1161" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb120-1162"><a href="#cb120-1162" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> <span class="bu">list</span>(gapminder_americas_europe.columns)</span>
<span id="cb120-1163"><a href="#cb120-1163" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> cols[<span class="bu">len</span>(cols)<span class="op">-</span><span class="dv">1</span>:<span class="bu">len</span>(cols):<span class="dv">1</span>]<span class="op">+</span>cols[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>:<span class="dv">1</span>]</span>
<span id="cb120-1164"><a href="#cb120-1164" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="op">=</span> gapminder_americas_europe[cols]</span>
<span id="cb120-1165"><a href="#cb120-1165" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(gapminder_americas_europe[:<span class="dv">6</span>], headers<span class="op">=</span>gapminder_americas_europe.head(), tablefmt<span class="op">=</span><span class="st">"fancy_grid"</span>,showindex<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb120-1166"><a href="#cb120-1166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1167"><a href="#cb120-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1168"><a href="#cb120-1168" aria-hidden="true" tabindex="-1"></a><span class="al">![Table](TTests_Table2.png)</span>{fig-align="left" height="300"}</span>
<span id="cb120-1169"><a href="#cb120-1169" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1170"><a href="#cb120-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1171"><a href="#cb120-1171" aria-hidden="true" tabindex="-1"></a>Now that we have effect coded the continent, we can create a new model to try to predict an individual's life expectancy based on which continent they are from</span>
<span id="cb120-1172"><a href="#cb120-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1173"><a href="#cb120-1173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1174"><a href="#cb120-1174" aria-hidden="true" tabindex="-1"></a>Y = intercept + \beta * effectVariable + Error</span>
<span id="cb120-1175"><a href="#cb120-1175" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1176"><a href="#cb120-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1177"><a href="#cb120-1177" aria-hidden="true" tabindex="-1"></a>Which in our case means:</span>
<span id="cb120-1178"><a href="#cb120-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1179"><a href="#cb120-1179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1180"><a href="#cb120-1180" aria-hidden="true" tabindex="-1"></a>lifeExp = mean(lifeExp) + \beta * contEffect + Error</span>
<span id="cb120-1181"><a href="#cb120-1181" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1182"><a href="#cb120-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1183"><a href="#cb120-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Y being the predicted life expectancy.</span>
<span id="cb120-1184"><a href="#cb120-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1185"><a href="#cb120-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{Y}$ being the mean life expectancy regardless of continent. For a t-test this is also the $intercept$.</span>
<span id="cb120-1186"><a href="#cb120-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1187"><a href="#cb120-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta$ being how much to adjust the prediction based on which continent the person is from</span>
<span id="cb120-1188"><a href="#cb120-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1189"><a href="#cb120-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$contEffect$ being 1 (Europe) or -1 (Americas) to reflect which continent the participant is from</span>
<span id="cb120-1190"><a href="#cb120-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1191"><a href="#cb120-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$Error$ being any error in the prediction not captured by the model</span>
<span id="cb120-1192"><a href="#cb120-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1193"><a href="#cb120-1193" aria-hidden="true" tabindex="-1"></a>To get the $intercept$ and $\beta$ for the above formula let's use linear model functions:</span>
<span id="cb120-1194"><a href="#cb120-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1195"><a href="#cb120-1195" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1196"><a href="#cb120-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1197"><a href="#cb120-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1200"><a href="#cb120-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1201"><a href="#cb120-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-life-exp-mean-2-continents</span></span>
<span id="cb120-1202"><a href="#cb120-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot with the errors around the mean of life expectancy across Europe and American countries."</span></span>
<span id="cb120-1203"><a href="#cb120-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1204"><a href="#cb120-1204" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe)</span>
<span id="cb120-1205"><a href="#cb120-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1206"><a href="#cb120-1206" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] </span>
<span id="cb120-1207"><a href="#cb120-1207" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb120-1208"><a href="#cb120-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1209"><a href="#cb120-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1210"><a href="#cb120-1210" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_fit <span class="ot">=</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> <span class="co"># intercept</span></span>
<span id="cb120-1211"><a href="#cb120-1211" aria-hidden="true" tabindex="-1"></a>  continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]                       <span class="sc">*</span> <span class="co"># gradient</span></span>
<span id="cb120-1212"><a href="#cb120-1212" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>contEffect</span>
<span id="cb120-1213"><a href="#cb120-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1214"><a href="#cb120-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1215"><a href="#cb120-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x =</span> contEffect, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb120-1216"><a href="#cb120-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-1217"><a href="#cb120-1217" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb120-1218"><a href="#cb120-1218" aria-hidden="true" tabindex="-1"></a>    <span class="co">#arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb120-1219"><a href="#cb120-1219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-1220"><a href="#cb120-1220" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> contEffect,</span>
<span id="cb120-1221"><a href="#cb120-1221" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> t_fit,</span>
<span id="cb120-1222"><a href="#cb120-1222" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb120-1223"><a href="#cb120-1223" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-1224"><a href="#cb120-1224" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb120-1225"><a href="#cb120-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb120-1226"><a href="#cb120-1226" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.9</span>, </span>
<span id="cb120-1227"><a href="#cb120-1227" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb120-1228"><a href="#cb120-1228" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb120-1229"><a href="#cb120-1229" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb120-1230"><a href="#cb120-1230" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb120-1231"><a href="#cb120-1231" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb120-1232"><a href="#cb120-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-1233"><a href="#cb120-1233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-1234"><a href="#cb120-1234" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb120-1235"><a href="#cb120-1235" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>, </span>
<span id="cb120-1236"><a href="#cb120-1236" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb120-1237"><a href="#cb120-1237" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb120-1238"><a href="#cb120-1238" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb120-1239"><a href="#cb120-1239" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb120-1240"><a href="#cb120-1240" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb120-1241"><a href="#cb120-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb120-1242"><a href="#cb120-1242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb120-1243"><a href="#cb120-1243" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">-</span> <span class="fl">1.9</span>,</span>
<span id="cb120-1244"><a href="#cb120-1244" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fl">1.9</span>,</span>
<span id="cb120-1245"><a href="#cb120-1245" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb120-1246"><a href="#cb120-1246" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb120-1247"><a href="#cb120-1247" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb120-1248"><a href="#cb120-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"dark green"</span></span>
<span id="cb120-1249"><a href="#cb120-1249" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-1250"><a href="#cb120-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1251"><a href="#cb120-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1252"><a href="#cb120-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1253"><a href="#cb120-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1256"><a href="#cb120-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1257"><a href="#cb120-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1258"><a href="#cb120-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1259"><a href="#cb120-1259" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb120-1260"><a href="#cb120-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1261"><a href="#cb120-1261" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'contEffect' to type category</span></span>
<span id="cb120-1262"><a href="#cb120-1262" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">=</span> gapminder_americas_europe[<span class="st">'contEffect'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb120-1263"><a href="#cb120-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1264"><a href="#cb120-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># lm 'contEffect' ~ 'lifeExp'</span></span>
<span id="cb120-1265"><a href="#cb120-1265" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="op">=</span> stats.linregress(gapminder_americas_europe[<span class="st">'contEffect'</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>])</span>
<span id="cb120-1266"><a href="#cb120-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1267"><a href="#cb120-1267" aria-hidden="true" tabindex="-1"></a><span class="co"># show results of lm</span></span>
<span id="cb120-1268"><a href="#cb120-1268" aria-hidden="true" tabindex="-1"></a>continent_ttest</span>
<span id="cb120-1269"><a href="#cb120-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1270"><a href="#cb120-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1271"><a href="#cb120-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1272"><a href="#cb120-1272" aria-hidden="true" tabindex="-1"></a><span class="in">LinregressResult(slope=2.020240000000001, intercept=75.62836, rvalue=0.4832076439158285, pvalue=0.00018637488941351192, stderr=0.502794193121279, intercept_stderr=0.5027941931212789)</span></span>
<span id="cb120-1273"><a href="#cb120-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1274"><a href="#cb120-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1277"><a href="#cb120-1277" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1278"><a href="#cb120-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1279"><a href="#cb120-1279" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb120-1280"><a href="#cb120-1280" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Europe"</span>)]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb120-1281"><a href="#cb120-1281" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">"contEffect"</span>].loc[(gapminder_americas_europe[<span class="st">'continent'</span>] <span class="op">==</span> <span class="st">"Americas"</span>)]<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb120-1282"><a href="#cb120-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1283"><a href="#cb120-1283" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_fit'</span>] <span class="op">=</span> continent_ttest.intercept <span class="op">+</span>continent_ttest.slope <span class="op">*</span> gapminder_americas_europe[<span class="st">'contEffect'</span>]</span>
<span id="cb120-1284"><a href="#cb120-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1285"><a href="#cb120-1285" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe[<span class="st">'t_res_square'</span>] <span class="op">=</span> (gapminder_americas_europe[<span class="st">'lifeExp'</span>] <span class="op">-</span> gapminder_americas_europe[<span class="st">'t_fit'</span>])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb120-1286"><a href="#cb120-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1287"><a href="#cb120-1287" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb120-1288"><a href="#cb120-1288" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb120-1289"><a href="#cb120-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1290"><a href="#cb120-1290" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate 'lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb120-1291"><a href="#cb120-1291" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb120-1292"><a href="#cb120-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1293"><a href="#cb120-1293" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==-1</span></span>
<span id="cb120-1294"><a href="#cb120-1294" aria-hidden="true" tabindex="-1"></a>m11<span class="op">=</span>np.repeat(m1, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb120-1295"><a href="#cb120-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1296"><a href="#cb120-1296" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat lifeExp' mean for 'contEffect' ==1</span></span>
<span id="cb120-1297"><a href="#cb120-1297" aria-hidden="true" tabindex="-1"></a>m22<span class="op">=</span>np.repeat(m2, <span class="bu">len</span>(gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>]), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb120-1298"><a href="#cb120-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1299"><a href="#cb120-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==-1</span></span>
<span id="cb120-1300"><a href="#cb120-1300" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.arange(<span class="op">-</span><span class="fl">1.98</span>, <span class="op">-</span><span class="fl">.05</span>, <span class="fl">0.08</span>)</span>
<span id="cb120-1301"><a href="#cb120-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1302"><a href="#cb120-1302" aria-hidden="true" tabindex="-1"></a><span class="co"># create x coordinates for 'contEffect' ==1</span></span>
<span id="cb120-1303"><a href="#cb120-1303" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.arange(<span class="fl">0.05</span>, <span class="fl">1.98</span>, <span class="fl">0.065</span>)</span>
<span id="cb120-1304"><a href="#cb120-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1305"><a href="#cb120-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1306"><a href="#cb120-1306" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb120-1307"><a href="#cb120-1307" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="dv">60</span>, <span class="dv">85</span>])</span>
<span id="cb120-1308"><a href="#cb120-1308" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>].mean(), color<span class="op">=</span><span class="st">'green'</span>, ls<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb120-1309"><a href="#cb120-1309" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m1,xmin<span class="op">=-</span><span class="fl">1.99</span>, xmax<span class="op">=-</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1310"><a href="#cb120-1310" aria-hidden="true" tabindex="-1"></a>plt.hlines(y<span class="op">=</span>m2,xmin<span class="op">=</span><span class="fl">1.99</span>, xmax<span class="op">=</span><span class="fl">.04</span>, colors<span class="op">=</span><span class="st">'blue'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1311"><a href="#cb120-1311" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x1,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>], ymax<span class="op">=</span>m11, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1312"><a href="#cb120-1312" aria-hidden="true" tabindex="-1"></a>plt.vlines(x<span class="op">=</span> x2,ymin<span class="op">=</span>gapminder_americas_europe[<span class="st">"lifeExp"</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>], ymax<span class="op">=</span>m22, colors<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb120-1313"><a href="#cb120-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1314"><a href="#cb120-1314" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the x-axis</span></span>
<span id="cb120-1315"><a href="#cb120-1315" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"contEffect"</span>)</span>
<span id="cb120-1316"><a href="#cb120-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1317"><a href="#cb120-1317" aria-hidden="true" tabindex="-1"></a><span class="co"># add title on the y-axis</span></span>
<span id="cb120-1318"><a href="#cb120-1318" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"lifeExp"</span>)</span>
<span id="cb120-1319"><a href="#cb120-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1320"><a href="#cb120-1320" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb120-1321"><a href="#cb120-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1322"><a href="#cb120-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1323"><a href="#cb120-1323" aria-hidden="true" tabindex="-1"></a><span class="al">![Plot with the errors around the mean of life expectancy across Europe and American countries](TTests_Figure4.png)</span>{fig-align="left" width="700" height="500"}</span>
<span id="cb120-1324"><a href="#cb120-1324" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1325"><a href="#cb120-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1326"><a href="#cb120-1326" aria-hidden="true" tabindex="-1"></a>Countries in the americas are dummy coded as -1 and countries in Europe are dummy coded as 1. Note that jittering has been used to help visualise variation within continents, and so all countries in Americas had a $contEffect$ score of -1, even if the jittering above makes it look like participants from Europe had slightly different $contEffect$ values to each other.</span>
<span id="cb120-1327"><a href="#cb120-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1328"><a href="#cb120-1328" aria-hidden="true" tabindex="-1"></a>So now that we've visualised the predictions and the error, lets summarise these errors with their sum of squares:</span>
<span id="cb120-1329"><a href="#cb120-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1330"><a href="#cb120-1330" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1331"><a href="#cb120-1331" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1332"><a href="#cb120-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1335"><a href="#cb120-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1336"><a href="#cb120-1336" aria-hidden="true" tabindex="-1"></a><span class="co">#temp_summary &lt;- summary(lm(lifeExp ~ contEffect, data = gapminder_americas_europe))</span></span>
<span id="cb120-1337"><a href="#cb120-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(lifeExp <span class="sc">~</span> contEffect, <span class="at">data =</span> gapminder_americas_europe))</span>
<span id="cb120-1338"><a href="#cb120-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1339"><a href="#cb120-1339" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb120-1340"><a href="#cb120-1340" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span>
<span id="cb120-1341"><a href="#cb120-1341" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb120-1342"><a href="#cb120-1342" aria-hidden="true" tabindex="-1"></a>america_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb120-1343"><a href="#cb120-1343" aria-hidden="true" tabindex="-1"></a>ss_between <span class="ot">&lt;-</span> </span>
<span id="cb120-1344"><a href="#cb120-1344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">*</span> (europe_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb120-1345"><a href="#cb120-1345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> (america_mean <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb120-1346"><a href="#cb120-1346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-1347"><a href="#cb120-1347" aria-hidden="true" tabindex="-1"></a>top_half <span class="ot">=</span> ss_between</span>
<span id="cb120-1348"><a href="#cb120-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1349"><a href="#cb120-1349" aria-hidden="true" tabindex="-1"></a>ss_within <span class="ot">=</span> (</span>
<span id="cb120-1350"><a href="#cb120-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> europe_mean)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb120-1351"><a href="#cb120-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> america_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-1352"><a href="#cb120-1352" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-1353"><a href="#cb120-1353" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-1354"><a href="#cb120-1354" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">=</span> (ss_within<span class="sc">/</span>(<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb120-1355"><a href="#cb120-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1356"><a href="#cb120-1356" aria-hidden="true" tabindex="-1"></a>top_half<span class="sc">/</span>bottom_half</span>
<span id="cb120-1357"><a href="#cb120-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1358"><a href="#cb120-1358" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb120-1359"><a href="#cb120-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1360"><a href="#cb120-1360" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(</span>
<span id="cb120-1361"><a href="#cb120-1361" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb120-1362"><a href="#cb120-1362" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contEffect <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb120-1363"><a href="#cb120-1363" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb120-1364"><a href="#cb120-1364" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-1365"><a href="#cb120-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1366"><a href="#cb120-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1367"><a href="#cb120-1367" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb120-1368"><a href="#cb120-1368" aria-hidden="true" tabindex="-1"></a><span class="co"># look at a t-distribution compared to an f-distribution</span></span>
<span id="cb120-1369"><a href="#cb120-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1370"><a href="#cb120-1370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1371"><a href="#cb120-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1372"><a href="#cb120-1372" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1373"><a href="#cb120-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1376"><a href="#cb120-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1377"><a href="#cb120-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1378"><a href="#cb120-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1379"><a href="#cb120-1379" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb120-1380"><a href="#cb120-1380" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb120-1381"><a href="#cb120-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1382"><a href="#cb120-1382" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb120-1383"><a href="#cb120-1383" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb120-1384"><a href="#cb120-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1385"><a href="#cb120-1385" aria-hidden="true" tabindex="-1"></a><span class="co"># create a table for the model</span></span>
<span id="cb120-1386"><a href="#cb120-1386" aria-hidden="true" tabindex="-1"></a>aov_table <span class="op">=</span> sm.stats.anova_lm(model, typ<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb120-1387"><a href="#cb120-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1388"><a href="#cb120-1388" aria-hidden="true" tabindex="-1"></a><span class="co"># display the table</span></span>
<span id="cb120-1389"><a href="#cb120-1389" aria-hidden="true" tabindex="-1"></a>aov_table</span>
<span id="cb120-1390"><a href="#cb120-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1391"><a href="#cb120-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1392"><a href="#cb120-1392" aria-hidden="true" tabindex="-1"></a><span class="al">![Table](TTests_Table3.png)</span>{fig-align="left" height="100"}</span>
<span id="cb120-1393"><a href="#cb120-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1396"><a href="#cb120-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1397"><a href="#cb120-1397" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1398"><a href="#cb120-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb120-1399"><a href="#cb120-1399" aria-hidden="true" tabindex="-1"></a><span class="co"># between</span></span>
<span id="cb120-1400"><a href="#cb120-1400" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>].mean()</span>
<span id="cb120-1401"><a href="#cb120-1401" aria-hidden="true" tabindex="-1"></a>europe_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>].mean()</span>
<span id="cb120-1402"><a href="#cb120-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1403"><a href="#cb120-1403" aria-hidden="true" tabindex="-1"></a>america_mean <span class="op">=</span> gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>].mean()</span>
<span id="cb120-1404"><a href="#cb120-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1405"><a href="#cb120-1405" aria-hidden="true" tabindex="-1"></a>ss_between <span class="op">=</span>(<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">*</span> (europe_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> (<span class="bu">sum</span>(gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> (america_mean <span class="op">-</span> overall_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb120-1406"><a href="#cb120-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1407"><a href="#cb120-1407" aria-hidden="true" tabindex="-1"></a>top_half <span class="op">=</span> ss_between</span>
<span id="cb120-1408"><a href="#cb120-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1409"><a href="#cb120-1409" aria-hidden="true" tabindex="-1"></a>ss_within <span class="op">=</span> (<span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>] <span class="op">-</span> europe_mean)<span class="op">**</span><span class="dv">2</span>)<span class="op">+</span> <span class="bu">sum</span>((gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> america_mean)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb120-1410"><a href="#cb120-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1411"><a href="#cb120-1411" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="op">=</span> (ss_within<span class="op">/</span>(<span class="bu">len</span>(gapminder_americas_europe[<span class="st">'lifeExp'</span>]) <span class="op">-</span> <span class="dv">2</span>))</span>
<span id="cb120-1412"><a href="#cb120-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1413"><a href="#cb120-1413" aria-hidden="true" tabindex="-1"></a>top_half<span class="op">/</span>bottom_half</span>
<span id="cb120-1414"><a href="#cb120-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1415"><a href="#cb120-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1416"><a href="#cb120-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1417"><a href="#cb120-1417" aria-hidden="true" tabindex="-1"></a><span class="in">16.14453</span></span>
<span id="cb120-1418"><a href="#cb120-1418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1419"><a href="#cb120-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1422"><a href="#cb120-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1423"><a href="#cb120-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1424"><a href="#cb120-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1425"><a href="#cb120-1425" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with a t-test</span></span>
<span id="cb120-1426"><a href="#cb120-1426" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb120-1427"><a href="#cb120-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1428"><a href="#cb120-1428" aria-hidden="true" tabindex="-1"></a>t_test <span class="op">=</span> ttest_ind(gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="dv">1</span>],gapminder_americas_europe[<span class="st">'lifeExp'</span>][gapminder_americas_europe[<span class="st">'contEffect'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb120-1429"><a href="#cb120-1429" aria-hidden="true" tabindex="-1"></a>t_test</span>
<span id="cb120-1430"><a href="#cb120-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1431"><a href="#cb120-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1432"><a href="#cb120-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1433"><a href="#cb120-1433" aria-hidden="true" tabindex="-1"></a><span class="in">Ttest_indResult(statistic=4.018025720342183, pvalue=0.00018637488941352037)</span></span>
<span id="cb120-1434"><a href="#cb120-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1435"><a href="#cb120-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1438"><a href="#cb120-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1439"><a href="#cb120-1439" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1440"><a href="#cb120-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1441"><a href="#cb120-1441" aria-hidden="true" tabindex="-1"></a><span class="fl">4.018</span> <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb120-1442"><a href="#cb120-1442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1443"><a href="#cb120-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1444"><a href="#cb120-1444" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1445"><a href="#cb120-1445" aria-hidden="true" tabindex="-1"></a><span class="in">16.144530689331322</span></span>
<span id="cb120-1446"><a href="#cb120-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1447"><a href="#cb120-1447" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1448"><a href="#cb120-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1449"><a href="#cb120-1449" aria-hidden="true" tabindex="-1"></a>So the new unexplained variance (AKA residual) is 730.8276, which is smaller than it was when we just used the mean regardless of continent (953.4478; 935.4478 is also the **total variance** around the mean).</span>
<span id="cb120-1450"><a href="#cb120-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1451"><a href="#cb120-1451" aria-hidden="true" tabindex="-1"></a>The sum of squares for the effect of continent can be calculated by subtracting the residuals from the total sum of squares (SS):</span>
<span id="cb120-1452"><a href="#cb120-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1453"><a href="#cb120-1453" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1454"><a href="#cb120-1454" aria-hidden="true" tabindex="-1"></a>effect_{SS} = total_{SS} - residual_{SS} = 953.4478 - 730.8276 = 222.6202</span>
<span id="cb120-1455"><a href="#cb120-1455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1456"><a href="#cb120-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1457"><a href="#cb120-1457" aria-hidden="true" tabindex="-1"></a>The $effect_{SS}$ can also be thought of our explained variance! So we can actually calculate how much of the model is explained by the model ($r^2$):</span>
<span id="cb120-1458"><a href="#cb120-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1459"><a href="#cb120-1459" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1460"><a href="#cb120-1460" aria-hidden="true" tabindex="-1"></a>r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335</span>
<span id="cb120-1461"><a href="#cb120-1461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1462"><a href="#cb120-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1463"><a href="#cb120-1463" aria-hidden="true" tabindex="-1"></a>Let's confirm that this is correct by comparing a manual calculation and a function:</span>
<span id="cb120-1464"><a href="#cb120-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1465"><a href="#cb120-1465" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1466"><a href="#cb120-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1467"><a href="#cb120-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1470"><a href="#cb120-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1471"><a href="#cb120-1471" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="sc">/</span><span class="fl">953.4478</span> <span class="co"># should be  0.2335 </span></span>
<span id="cb120-1472"><a href="#cb120-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))<span class="sc">$</span>r.squared</span>
<span id="cb120-1473"><a href="#cb120-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1474"><a href="#cb120-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1475"><a href="#cb120-1475" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1476"><a href="#cb120-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1479"><a href="#cb120-1479" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1480"><a href="#cb120-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1481"><a href="#cb120-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1482"><a href="#cb120-1482" aria-hidden="true" tabindex="-1"></a><span class="fl">222.6202</span><span class="op">/</span><span class="fl">953.4478</span></span>
<span id="cb120-1483"><a href="#cb120-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1484"><a href="#cb120-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1485"><a href="#cb120-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1486"><a href="#cb120-1486" aria-hidden="true" tabindex="-1"></a><span class="in">0.23348965722087775</span></span>
<span id="cb120-1487"><a href="#cb120-1487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1488"><a href="#cb120-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1491"><a href="#cb120-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1492"><a href="#cb120-1492" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1493"><a href="#cb120-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1494"><a href="#cb120-1494" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model</span></span>
<span id="cb120-1495"><a href="#cb120-1495" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ols(<span class="st">'lifeExp ~ contEffect'</span>, data <span class="op">=</span> gapminder_americas_europe).fit()</span>
<span id="cb120-1496"><a href="#cb120-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1497"><a href="#cb120-1497" aria-hidden="true" tabindex="-1"></a><span class="co"># get the r squared from the model</span></span>
<span id="cb120-1498"><a href="#cb120-1498" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> model.rsquared</span>
<span id="cb120-1499"><a href="#cb120-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1500"><a href="#cb120-1500" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the R-squared value</span></span>
<span id="cb120-1501"><a href="#cb120-1501" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R-squared:"</span>, r_squared)</span>
<span id="cb120-1502"><a href="#cb120-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1503"><a href="#cb120-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1504"><a href="#cb120-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1505"><a href="#cb120-1505" aria-hidden="true" tabindex="-1"></a><span class="in">0.2334896271386857</span></span>
<span id="cb120-1506"><a href="#cb120-1506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1507"><a href="#cb120-1507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1508"><a href="#cb120-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1509"><a href="#cb120-1509" aria-hidden="true" tabindex="-1"></a>Great, the difference reflects a rounding error.</span>
<span id="cb120-1510"><a href="#cb120-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1511"><a href="#cb120-1511" aria-hidden="true" tabindex="-1"></a>Note that the above formula is similar to the formula for $r$ from <span class="co">[</span><span class="ot">simple regressions</span><span class="co">](../regressions/simpleRegressions.html#proportion-of-variance-explained)</span>. Variance is the square root of the Sum of Squares (or Sum of Squares is the **square** of variance!):</span>
<span id="cb120-1512"><a href="#cb120-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1513"><a href="#cb120-1513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1514"><a href="#cb120-1514" aria-hidden="true" tabindex="-1"></a>r = \sqrt{\frac{SS_{explained}}{SS_{total}}} = \frac{\sqrt{SS_{explained}}}{\sqrt{SS_{total}}} =\frac{var_{explained}}{var_{total}}</span>
<span id="cb120-1515"><a href="#cb120-1515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1516"><a href="#cb120-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1517"><a href="#cb120-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA approach vs conventional formula</span></span>
<span id="cb120-1518"><a href="#cb120-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1519"><a href="#cb120-1519" aria-hidden="true" tabindex="-1"></a>The main formula for an independent samples t-test is:</span>
<span id="cb120-1520"><a href="#cb120-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1521"><a href="#cb120-1521" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1522"><a href="#cb120-1522" aria-hidden="true" tabindex="-1"></a>t =  \frac{\bar{X_1} - \bar{X_2}}{SE}</span>
<span id="cb120-1523"><a href="#cb120-1523" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1524"><a href="#cb120-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1525"><a href="#cb120-1525" aria-hidden="true" tabindex="-1"></a>However, this is a simplification of the GLM mathematics we've been doing above (although $df$ is the same for the denominator and numerator, so we ignored them as they cancelled out)</span>
<span id="cb120-1526"><a href="#cb120-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1527"><a href="#cb120-1527" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1528"><a href="#cb120-1528" aria-hidden="true" tabindex="-1"></a>t= \sqrt{f} = \sqrt{\frac{SS_{exp}/df_{exp}}{SS_{unexp}/df_{unexp}}} = \frac{(\sum{\bar{X_1} - \mu)/(N_1-1) - (\sum{\bar{X_2} - \mu)}/(N_2-1)}}{</span>
<span id="cb120-1529"><a href="#cb120-1529" aria-hidden="true" tabindex="-1"></a>((\sum{X_{1i} - \bar{X_1}}) +  (\sum{X_{2i} - \bar{X_2}}) )/(N-1)}= \frac{\sum{\bar{X_1}/N_1 - \sum{\bar{X_2}}/N_2}}{SE} =  \frac{\bar{X_1} - \bar{X_2}}{SE}</span>
<span id="cb120-1530"><a href="#cb120-1530" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1531"><a href="#cb120-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1532"><a href="#cb120-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">## GLM approach (optional)</span></span>
<span id="cb120-1533"><a href="#cb120-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1534"><a href="#cb120-1534" aria-hidden="true" tabindex="-1"></a>If we were to more strictly conceptualise this as a linear model, then we need to create a model that predicts the life expectancy based on the continent. As continent is a categorical variable, we need to allocate numbers for each continent. This can either be dummy coding (1 for 0 for each continent) or effect coding (1 or -1 for each continent). Let's go through both approaches.</span>
<span id="cb120-1535"><a href="#cb120-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1536"><a href="#cb120-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dummy coding</span></span>
<span id="cb120-1537"><a href="#cb120-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1538"><a href="#cb120-1538" aria-hidden="true" tabindex="-1"></a>In this model, we will dummy code America as 1 and Europe as 0. This means that our model will tell us how much life expectancy increases/decreases when you live in America compared to Europe. A general linear model with 1 predictor is generally structured as follows:</span>
<span id="cb120-1539"><a href="#cb120-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1540"><a href="#cb120-1540" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1541"><a href="#cb120-1541" aria-hidden="true" tabindex="-1"></a>Y = a + B*X  + e</span>
<span id="cb120-1542"><a href="#cb120-1542" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1543"><a href="#cb120-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1544"><a href="#cb120-1544" aria-hidden="true" tabindex="-1"></a>Or in relation to our variables</span>
<span id="cb120-1545"><a href="#cb120-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1546"><a href="#cb120-1546" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1547"><a href="#cb120-1547" aria-hidden="true" tabindex="-1"></a>GDP = a + B_{continent} * X_{continent} + e =</span>
<span id="cb120-1548"><a href="#cb120-1548" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1549"><a href="#cb120-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1550"><a href="#cb120-1550" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$X$ refers to the value of our dummy coded variable, which is either 0 (Europe) or 1 (Americas).</span>
<span id="cb120-1551"><a href="#cb120-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1552"><a href="#cb120-1552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$a$ is the intercept, i.e. the value of $Y$ when $X = 0$. Thus, as $X=0$ for Europe, $a$ is the mean life expectancy in Europe. This will be clarified below.</span>
<span id="cb120-1553"><a href="#cb120-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1554"><a href="#cb120-1554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$B$ is the gradient (AKA Coefficient AKA Beta) of the predictor. In our case, this will be the difference in means between Europe and the Americas, which will be further clarified below.</span>
<span id="cb120-1555"><a href="#cb120-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1556"><a href="#cb120-1556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$e$ is the error, or residual (i.e. the difference between the predicted value and the actual value).</span>
<span id="cb120-1557"><a href="#cb120-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1558"><a href="#cb120-1558" aria-hidden="true" tabindex="-1"></a>So it's been claimed that $a$ will be the mean life expectancy in Europe. We can see why this is the case by seeing what happens when $X=0$, which follows our dummy coding of Europe as 0.</span>
<span id="cb120-1559"><a href="#cb120-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1560"><a href="#cb120-1560" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1561"><a href="#cb120-1561" aria-hidden="true" tabindex="-1"></a>LifeExp = a + B_{continent} * 0 + e = a + e </span>
<span id="cb120-1562"><a href="#cb120-1562" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1563"><a href="#cb120-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1564"><a href="#cb120-1564" aria-hidden="true" tabindex="-1"></a>So predicting GDP for Europe is just $a$ and whatever is not predicted by $a$ is the error ($e$). The best prediction of GDP in Europe is calculating the mean of life expectancy in Europe. Thus $a$ is the mean life expectancy in Europe.</span>
<span id="cb120-1565"><a href="#cb120-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1566"><a href="#cb120-1566" aria-hidden="true" tabindex="-1"></a>Now, to get the gradient ($B$), we need to calculate how much life expectancy goes up or down as $X$ increases by 1.</span>
<span id="cb120-1567"><a href="#cb120-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1570"><a href="#cb120-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1571"><a href="#cb120-1571" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe</span>
<span id="cb120-1572"><a href="#cb120-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1573"><a href="#cb120-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1574"><a href="#cb120-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect coding</span></span>
<span id="cb120-1575"><a href="#cb120-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1576"><a href="#cb120-1576" aria-hidden="true" tabindex="-1"></a><span class="fu"># Effect sizes</span></span>
<span id="cb120-1577"><a href="#cb120-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1578"><a href="#cb120-1578" aria-hidden="true" tabindex="-1"></a><span class="fu">## T-tests</span></span>
<span id="cb120-1579"><a href="#cb120-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1580"><a href="#cb120-1580" aria-hidden="true" tabindex="-1"></a>To capture how large the effect is, there are slightly different calculations when doing a within subject design (1 or 2 conditions that all participants complete) vs. a between subject design. In all cases these are Cohen $d$ calculations.</span>
<span id="cb120-1581"><a href="#cb120-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1582"><a href="#cb120-1582" aria-hidden="true" tabindex="-1"></a><span class="fu">### One Sample T-tests</span></span>
<span id="cb120-1583"><a href="#cb120-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1584"><a href="#cb120-1584" aria-hidden="true" tabindex="-1"></a>The size of an effect is how big the difference is between the mean and the $\mu$ that you are comparing it to, compared to the standard deviation:</span>
<span id="cb120-1585"><a href="#cb120-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1586"><a href="#cb120-1586" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1587"><a href="#cb120-1587" aria-hidden="true" tabindex="-1"></a>d = \frac{\bar{x} - \mu}{SD(x)}</span>
<span id="cb120-1588"><a href="#cb120-1588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1589"><a href="#cb120-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1590"><a href="#cb120-1590" aria-hidden="true" tabindex="-1"></a>The general benchmarks for how big or small a Cohen's $d$ value are as follows:</span>
<span id="cb120-1591"><a href="#cb120-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1592"><a href="#cb120-1592" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>.01 and below is very small (<span class="co">[</span><span class="ot">Sawilowsky 2009</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new)</span>)</span>
<span id="cb120-1593"><a href="#cb120-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1594"><a href="#cb120-1594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>.2 and below is small (<span class="co">[</span><span class="ot">Cohen 2013</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical)</span>)</span>
<span id="cb120-1595"><a href="#cb120-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1596"><a href="#cb120-1596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>.5 is medium (<span class="co">[</span><span class="ot">Cohen 2013</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical)</span>)</span>
<span id="cb120-1597"><a href="#cb120-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1598"><a href="#cb120-1598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>.8 is large (<span class="co">[</span><span class="ot">Cohen 2013</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-cohen2013statistical)</span>)</span>
<span id="cb120-1599"><a href="#cb120-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1600"><a href="#cb120-1600" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>1.2 is very large (<span class="co">[</span><span class="ot">Sawilowsky 2009</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new)</span>)</span>
<span id="cb120-1601"><a href="#cb120-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1602"><a href="#cb120-1602" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>2 is huge (<span class="co">[</span><span class="ot">Sawilowsky 2009</span><span class="co">](http://localhost:7754/describingData/dispersion.html#ref-sawilowsky2009new)</span>)</span>
<span id="cb120-1603"><a href="#cb120-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1604"><a href="#cb120-1604" aria-hidden="true" tabindex="-1"></a><span class="fu">### Paired sample T-tests</span></span>
<span id="cb120-1605"><a href="#cb120-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1606"><a href="#cb120-1606" aria-hidden="true" tabindex="-1"></a>The size of an effect is how big the difference is between the conditions, compared to the standard deviation:</span>
<span id="cb120-1607"><a href="#cb120-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1608"><a href="#cb120-1608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1609"><a href="#cb120-1609" aria-hidden="true" tabindex="-1"></a>d = \frac{\bar{x_1} - \bar{x_2}}{SD(x_1-x_2)}</span>
<span id="cb120-1610"><a href="#cb120-1610" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1611"><a href="#cb120-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1612"><a href="#cb120-1612" aria-hidden="true" tabindex="-1"></a>This actually can be thought of the same as one-sample t-tests after you take the step to calculate the difference between each value in $x_1$ and $x_2$ to make $x_3$ to compare to a $\mu$ of 0:</span>
<span id="cb120-1613"><a href="#cb120-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1614"><a href="#cb120-1614" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1615"><a href="#cb120-1615" aria-hidden="true" tabindex="-1"></a>x_3 = x_1 - x_2</span>
<span id="cb120-1616"><a href="#cb120-1616" aria-hidden="true" tabindex="-1"></a>$$ $$</span>
<span id="cb120-1617"><a href="#cb120-1617" aria-hidden="true" tabindex="-1"></a>\mu = 0</span>
<span id="cb120-1618"><a href="#cb120-1618" aria-hidden="true" tabindex="-1"></a>$$ $$</span>
<span id="cb120-1619"><a href="#cb120-1619" aria-hidden="true" tabindex="-1"></a>d = \frac{\bar{x_1}-\bar{x_2}}{SD(\bar{x_1}-\bar{x_2})} = \frac{\bar{x_3}}{SD(x_3)} = \frac{\bar{x_3}-\mu}{SD(x_3)}</span>
<span id="cb120-1620"><a href="#cb120-1620" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1621"><a href="#cb120-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1622"><a href="#cb120-1622" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independent Sample T-tests</span></span>
<span id="cb120-1623"><a href="#cb120-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1624"><a href="#cb120-1624" aria-hidden="true" tabindex="-1"></a>The formula for this is somewhat similar to that for a paired samples t-test, but because you are comparing between groups of participants you can't collapse the values between conditions because there are no pairings. So, you need to calculate the *pooled* standard deviation.</span>
<span id="cb120-1625"><a href="#cb120-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1626"><a href="#cb120-1626" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1627"><a href="#cb120-1627" aria-hidden="true" tabindex="-1"></a>SD_{pooled} = \sqrt{(SD(x_1)^2 + SD(x_1)^2)/2}</span>
<span id="cb120-1628"><a href="#cb120-1628" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1629"><a href="#cb120-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1630"><a href="#cb120-1630" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1631"><a href="#cb120-1631" aria-hidden="true" tabindex="-1"></a>d = \frac{\bar{x_1}-\bar{x_2}}{SD_{pooled}}</span>
<span id="cb120-1632"><a href="#cb120-1632" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1633"><a href="#cb120-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1634"><a href="#cb120-1634" aria-hidden="true" tabindex="-1"></a><span class="fu">## F-tests</span></span>
<span id="cb120-1635"><a href="#cb120-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1636"><a href="#cb120-1636" aria-hidden="true" tabindex="-1"></a>The effect sizes for F-tests are based on how much variance is explained by the model, which sometimes is exactly the same as $r^2$. Let's review some of the calculations above to confirm this:\</span>
<span id="cb120-1637"><a href="#cb120-1637" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1638"><a href="#cb120-1638" aria-hidden="true" tabindex="-1"></a>r^2 = \frac{SS_{explained}}{SS_{total}} = \frac{222.6202}{953.4478} = 0.2335</span>
<span id="cb120-1639"><a href="#cb120-1639" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb120-1640"><a href="#cb120-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1641"><a href="#cb120-1641" aria-hidden="true" tabindex="-1"></a>If we run a linear model on the data we should also confirm the $r^2$ is .2335:</span>
<span id="cb120-1642"><a href="#cb120-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1643"><a href="#cb120-1643" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1644"><a href="#cb120-1644" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1645"><a href="#cb120-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1648"><a href="#cb120-1648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1649"><a href="#cb120-1649" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span>
<span id="cb120-1650"><a href="#cb120-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1651"><a href="#cb120-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1652"><a href="#cb120-1652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1653"><a href="#cb120-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1656"><a href="#cb120-1656" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1657"><a href="#cb120-1657" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1658"><a href="#cb120-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1659"><a href="#cb120-1659" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb120-1660"><a href="#cb120-1660" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb120-1661"><a href="#cb120-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1662"><a href="#cb120-1662" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb120-1663"><a href="#cb120-1663" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb120-1664"><a href="#cb120-1664" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb120-1665"><a href="#cb120-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1666"><a href="#cb120-1666" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary</span></span>
<span id="cb120-1667"><a href="#cb120-1667" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span>
<span id="cb120-1668"><a href="#cb120-1668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1669"><a href="#cb120-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1670"><a href="#cb120-1670" aria-hidden="true" tabindex="-1"></a><span class="al">![Table](TTests_Table4.png)</span>{fig-align="left" height="300"}</span>
<span id="cb120-1671"><a href="#cb120-1671" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1672"><a href="#cb120-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1673"><a href="#cb120-1673" aria-hidden="true" tabindex="-1"></a>We'll use a function to confirm that this is the same for eta squared also:</span>
<span id="cb120-1674"><a href="#cb120-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1675"><a href="#cb120-1675" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb120-1676"><a href="#cb120-1676" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb120-1677"><a href="#cb120-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1680"><a href="#cb120-1680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-1681"><a href="#cb120-1681" aria-hidden="true" tabindex="-1"></a>lsr<span class="sc">::</span><span class="fu">etaSquared</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contEffect, gapminder_americas_europe))</span>
<span id="cb120-1682"><a href="#cb120-1682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1683"><a href="#cb120-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1684"><a href="#cb120-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb120-1685"><a href="#cb120-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1688"><a href="#cb120-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb120-1689"><a href="#cb120-1689" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-1690"><a href="#cb120-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1691"><a href="#cb120-1691" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb120-1692"><a href="#cb120-1692" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb120-1693"><a href="#cb120-1693" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb120-1694"><a href="#cb120-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1695"><a href="#cb120-1695" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the model</span></span>
<span id="cb120-1696"><a href="#cb120-1696" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(<span class="st">'lifeExp ~ contEffect'</span>, data<span class="op">=</span>gapminder_americas_europe)</span>
<span id="cb120-1697"><a href="#cb120-1697" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb120-1698"><a href="#cb120-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1699"><a href="#cb120-1699" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate eta-squared</span></span>
<span id="cb120-1700"><a href="#cb120-1700" aria-hidden="true" tabindex="-1"></a>anova_table <span class="op">=</span> anova_lm(results)</span>
<span id="cb120-1701"><a href="#cb120-1701" aria-hidden="true" tabindex="-1"></a>eta_squared <span class="op">=</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">/</span> (anova_table[<span class="st">'sum_sq'</span>][<span class="dv">0</span>] <span class="op">+</span> anova_table[<span class="st">'sum_sq'</span>][<span class="dv">1</span>])</span>
<span id="cb120-1702"><a href="#cb120-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1703"><a href="#cb120-1703" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Eta-squared (η²):"</span>, eta_squared)</span>
<span id="cb120-1704"><a href="#cb120-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1705"><a href="#cb120-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1706"><a href="#cb120-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb120-1707"><a href="#cb120-1707" aria-hidden="true" tabindex="-1"></a><span class="in">Eta-squared (η²): 0.2334896271386854</span></span>
<span id="cb120-1708"><a href="#cb120-1708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-1709"><a href="#cb120-1709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-1710"><a href="#cb120-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1711"><a href="#cb120-1711" aria-hidden="true" tabindex="-1"></a>Boom, you got effect sizes for F-tests like ANOVAs.</span>
<span id="cb120-1712"><a href="#cb120-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-1713"><a href="#cb120-1713" aria-hidden="true" tabindex="-1"></a>If you have understood this page it will set you up for the pages on each type of ANOVA as it uses the same concepts again and again.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>