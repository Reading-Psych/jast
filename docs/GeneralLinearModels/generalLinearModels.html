<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - General Linear Models and Sum of Squares</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document">Report an error</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications">Request a clarification</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content">Suggest Content</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">General Linear Models and Sum of Squares</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Welcome</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">Installing R(Studio)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Statistics Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">Statistics Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">Scientific Notation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">R Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">Types of Scripts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">R Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">R Logic</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Describing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">Central Tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">Dispersion</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Distributions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">Normal Distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">Skewness</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/kurtosis.html" class="sidebar-item-text sidebar-link">Kurtosis (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">Transforming Data (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Correlation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  correlations/cooksd.qmd
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Regressions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">Simple regression (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">Multiple Regressions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">General Linear Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link active">General Linear Models and Sum of Squares</a>
  </div>
</li>
          <li class="sidebar-item">
  GeneralLinearModels/One-Way Analysis of Variance
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-are-general-linear-models" id="toc-what-are-general-linear-models" class="nav-link active" data-scroll-target="#what-are-general-linear-models">What are general linear models?</a></li>
  <li><a href="#mean-as-the-simplest-model-of-data" id="toc-mean-as-the-simplest-model-of-data" class="nav-link" data-scroll-target="#mean-as-the-simplest-model-of-data">Mean as the simplest model of data</a></li>
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests">T-Tests</a>
  <ul class="collapse">
  <li><a href="#r-squared-vs.-adjusted-r-squared" id="toc-r-squared-vs.-adjusted-r-squared" class="nav-link" data-scroll-target="#r-squared-vs.-adjusted-r-squared">R-squared vs.&nbsp;adjusted R-squared</a></li>
  </ul></li>
  <li><a href="#what-is-adjusted-r-squared" id="toc-what-is-adjusted-r-squared" class="nav-link" data-scroll-target="#what-is-adjusted-r-squared">what is adjusted r-squared?</a></li>
  <li><a href="#trying-to-understand-f-values" id="toc-trying-to-understand-f-values" class="nav-link" data-scroll-target="#trying-to-understand-f-values">trying to understand f-values</a>
  <ul class="collapse">
  <li><a href="#anovas" id="toc-anovas" class="nav-link" data-scroll-target="#anovas">ANOVAs</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  <li><a href="#simple-regressions-and-t-tests" id="toc-simple-regressions-and-t-tests" class="nav-link" data-scroll-target="#simple-regressions-and-t-tests">Simple Regressions and t-tests</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">General Linear Models and Sum of Squares</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="what-are-general-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="what-are-general-linear-models">What are general linear models?</h2>
<p>General linear models allow you to analyse data in which the <strong>dependent</strong> variable is continuous. For example, if you are analysing the height of a group of individuals, you might use one of the following analyses:</p>
<ul>
<li><p><strong>t-test</strong>, comparisons between two conditions e.g.&nbsp;are males taller than females?</p></li>
<li><p><strong>regression</strong>, one or more predictors of a single outcome e.g.&nbsp;does foot size, weight etc. predict height? (Note that <strong>correlations</strong> are equivalent to a regression with a single predictor)</p></li>
<li><p><strong>ANOVA</strong>, comparisons between 3 or more conditions or between multiple categorical factors, e.g.&nbsp;are there differences in height between sexes and nationalities?</p></li>
</ul>
<p><strong>Linear</strong> refers to the <strong>dependent variable</strong> being continuous.</p>
<p><strong>General</strong> refers to the fact that the <strong>independent variables</strong> can both be continuous (e.g.&nbsp;regression) or categorical (e.g.&nbsp;t-test or ANOVA).</p>
<p>In <strong>general linear models</strong> all analyses involve creating a model, and capturing what is and isn’t explained by the model (i.e.&nbsp;the <strong>error</strong> of the model). All analyses in general linear models can be formulated as:</p>
<p><span class="math display">\[
Data = Model + Error
\]</span></p>
<p>Data: The dependent variable in your analysis Model: A model which predicts a phenomenon. This could be multiple independent variables. Error: What data isn’t explained by the model.</p>
</section>
<section id="mean-as-the-simplest-model-of-data" class="level2">
<h2 class="anchored" data-anchor-id="mean-as-the-simplest-model-of-data">Mean as the simplest model of data</h2>
<p>If you want to estimate what someone’s life expectancy would be in 2007, you could look at the mean life expectancy using the gapminder data. In terms of how this corresponds to the above model:</p>
<p><span class="math display">\[
Data = Model + Error
\]</span></p>
<p><span class="math display">\[
estimatedLifeExpectancy = mean(lifeExpectancy) + Error
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new data frame that only focuses on data from 2007</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span>     </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67.00742</code></pre>
</div>
</div>
<p><span class="math display">\[
estimatedLifeExpectancy = 67.01 + Error
\]</span></p>
<p>Which could be visualised as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  gapminder_2007, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 1.</em></p>
<p>In English, the above model and figure allow you to predict that anyone’s life expectancy will be 67 years. However, as you can also see, there’s a huge amount of error, i.e.&nbsp;variance in life expectancy that is not explained by the model. These errors can be squared and summed to give the <strong>sum of squares</strong>, a statistic of how much error there is around the model:</p>
<p><span class="math display">\[
SS = \sum(Y_i-\bar{Y})^2
\]</span></p>
<p>Which can be visualised as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 2.</em></p>
<p>You can directly compare <strong>fig.&nbsp;1. and fig.&nbsp;2.</strong> to see how much error is associated with each data point compared to the model. Fig. 2. is positive because it is the distance of the data-point from the mean squared. If you added together all the <strong>squares (pink lines)</strong> in fig.&nbsp;2. that would give you the <strong>sum of squares.</strong></p>
<p>As you may have guessed, it is possible to have more precise models that have less error, and thus a smaller <strong>sum of squares</strong>. The sum of squares around the mean is also the <strong>total sum of squares,</strong> and the <strong>total variance</strong>. When we calculate the proportion of the variance that a model explains, we are comparing it to this <strong>variance around the mean.</strong></p>
<p>Let’s explore those possibilities now.</p>
</section>
<section id="t-tests" class="level2">
<h2 class="anchored" data-anchor-id="t-tests">T-Tests</h2>
<p>T-tests are restricted to comparisons between 2 conditions/groups, so we will restrict the Gapminder data to allow a comparison between 2 continents. To see if life expectancy was different if you are born in Europe compared to the Americas, let’s first check what the sum of squares is when you just use the <strong>mean</strong> as the model of life expectancy across these contents:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007,   <span class="co"># the data set</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 3.</em> The errors around the mean of life expectancy across Europe and American countries.</p>
<p>Once we square the errors in the pink lines above, we’ll get the <strong>squares:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 953.4478</code></pre>
</div>
</div>
<p>And when you add all of these together:</p>
<p><span class="math display">\[
SumOfSquares = \sum(Y_i-\bar{Y})^2 = 953.4478
\]</span></p>
<p>So if the model we create for a t-test would result in a smaller <strong>sum of squares</strong> then that suggests it’s a more precise model for estimating life expectancy than simply using the <strong>mean</strong> as a model. This is because this would mean there’s less <strong>error</strong> in this model. Let’s model this using a t-test. For this we will need to dummy code country:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a column to place 1 or -1 for each row dependent on the country</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>contDummy <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>contDummy[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>contDummy[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">=</span> <span class="fu">cbind</span>(contDummy,gapminder_americas_europe)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contDummy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["country"],"name":[2],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[6],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"Albania","3":"Europe","4":"2007","5":"76.423","6":"3600523","7":"5937.030","_rn_":"1"},{"1":"-1","2":"Argentina","3":"Americas","4":"2007","5":"75.320","6":"40301927","7":"12779.380","_rn_":"2"},{"1":"1","2":"Austria","3":"Europe","4":"2007","5":"79.829","6":"8199783","7":"36126.493","_rn_":"3"},{"1":"1","2":"Belgium","3":"Europe","4":"2007","5":"79.441","6":"10392226","7":"33692.605","_rn_":"4"},{"1":"-1","2":"Bolivia","3":"Americas","4":"2007","5":"65.554","6":"9119152","7":"3822.137","_rn_":"5"},{"1":"1","2":"Bosnia and Herzegovina","3":"Europe","4":"2007","5":"74.852","6":"4552198","7":"7446.299","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now that we have dummy coded the continent, we can create a new model to try to predict an individual’s life expectancy based on which continent they are from</p>
<p><span class="math display">\[
Y = intercept + \beta * dummyVariable + Error
\]</span></p>
<p><span class="math display">\[
lifeExp = mean(lifeExp) + \beta * ContDummy + Error
\]</span></p>
<ul>
<li><p>Y being the predicted life expectancy.</p></li>
<li><p><span class="math inline">\(\bar{Y}\)</span> being the mean life expectancy regardless of continent. For a t-test this is also the <span class="math inline">\(intercept\)</span>.</p></li>
<li><p><span class="math inline">\(\beta\)</span> being how much to adjust the prediction based on which continent the person is from</p></li>
<li><p><span class="math inline">\(ContDummy\)</span> being 1 (Europe) or -1 (Americas) to reflect which continent the participant is from</p></li>
<li><p><span class="math inline">\(Error\)</span> being any error in the prediction not captured by the model</p></li>
</ul>
<p>To get the <span class="math inline">\(intercept\)</span> and <span class="math inline">\(\beta\)</span> for the above formula let’s use the lm function in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   75.62836 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>contDummy 
  2.02024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_fit <span class="ot">=</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> <span class="co"># intercept</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]                       <span class="sc">*</span> <span class="co"># gradient</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>contDummy</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x =</span> contDummy, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> contDummy,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> t_fit,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.9</span>, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fl">1.9</span>, </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. X. Countries in the americas are dummy coded as -1 and countries in Europe are dummy coded as 1. Note that jittering has been used to help visualise variation within continents, and so all countries in Americas had a</em> <span class="math inline">\(contDummy\)</span> score of -1, even if the jittering above makes it look like participants from Europe had slightly different <span class="math inline">\(contDummy\)</span> values to each other.</p>
<p>So now that we’ve visualised the predictions and the error, lets summarise these errors with their sum of squares:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to get the sum of squares, you can use the lm from earlier</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(continent_ttest<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 730.8276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to calculate this manually:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_res <span class="ot">=</span> gapminder_americas_europe<span class="sc">$</span>t_fit <span class="sc">-</span> gapminder_americas_europe<span class="sc">$</span>lifeExp</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_res_squared <span class="ot">=</span> gapminder_americas_europe<span class="sc">$</span>t_res<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>t_res_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 730.8276</code></pre>
</div>
</div>
<p>So the new sum of squares is 730.8276, which is smaller than it was when we just used the mean regardless of continent (953.4478) which also summarises the <strong>total variance</strong> (around the mean). In fact, we can use these 2 numbers to calculate the <span class="math inline">\(r^2\)</span> value (i.e.&nbsp;what proportion of the variance around the mean is explained by the model). The amount of variance explained by the model can be calculated by:</p>
<p><span class="math display">\[
totalSumOfSquares - modelSumOfSquares = totalError - modelError
\]</span></p>
<p>This allows us to calculate an r-value and thus a p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>this_r2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>t_res_squared)<span class="sc">/</span><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>this_r <span class="ot">=</span> <span class="fu">sqrt</span>(this_r2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>this_r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4832076</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  gapminder_americas_europe$lifeExp[gapminder_americas_europe$contDummy == 1] and gapminder_americas_europe$lifeExp[gapminder_americas_europe$contDummy == -1]
t = 4.018, df = 53, p-value = 0.0001864
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 2.023525 6.057435
sample estimates:
mean of x mean of y 
 77.64860  73.60812 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ contDummy, data = gapminder_americas_europe)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.6921  -2.1364   0.4494   2.5671   7.0449 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  75.6284     0.5028 150.416  &lt; 2e-16 ***
contDummy     2.0202     0.5028   4.018 0.000186 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.713 on 53 degrees of freedom
Multiple R-squared:  0.2335,    Adjusted R-squared:  0.219 
F-statistic: 16.14 on 1 and 53 DF,  p-value: 0.0001864</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>this_r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334896</code></pre>
</div>
</div>
<p>You may notice above that the manually calculated <span class="math inline">\(r^2\)</span> value is identical to the “Multiple R-Squared”, rather than the “Adjusted R-squared”. So what’s the difference between r-squared and adjusted r-squared?</p>
<section id="r-squared-vs.-adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-vs.-adjusted-r-squared">R-squared vs.&nbsp;adjusted R-squared</h3>
<p>When completing a regression, there’s always a risk of “overfitting” the data, i.e.&nbsp;creating a model that includes predictors that have no meaningful association with the outcome variable. For example, let’s generate some random data, and see what R-values etc. we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>random_df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_1 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_2 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_3 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_dv =</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(random_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["random_iv_1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["random_iv_2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["random_iv_3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["random_dv"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.505841631","2":"0.440598845","3":"0.905740602","4":"0.29760375"},{"1":"0.167180107","2":"0.849034735","3":"0.399345785","4":"0.23532851"},{"1":"0.637017697","2":"0.995053618","3":"0.889127424","4":"0.65583703"},{"1":"0.460933120","2":"0.449859742","3":"0.460232751","4":"0.92684691"},{"1":"0.563497575","2":"0.552340306","3":"0.545808291","4":"0.06176590"},{"1":"0.253589601","2":"0.376488500","3":"0.268641687","4":"0.39018305"},{"1":"0.800523303","2":"0.273098734","3":"0.955758274","4":"0.24572493"},{"1":"0.653210326","2":"0.461999374","3":"0.295299463","4":"0.64020861"},{"1":"0.743333409","2":"0.109243175","3":"0.564229959","4":"0.51734422"},{"1":"0.130972305","2":"0.011699852","3":"0.536921050","4":"0.24183943"},{"1":"0.309349422","2":"0.744986565","3":"0.231762510","4":"0.54229990"},{"1":"0.111840743","2":"0.547864547","3":"0.958960825","4":"0.70550485"},{"1":"0.921581345","2":"0.467000209","3":"0.369214979","4":"0.65286888"},{"1":"0.253473807","2":"0.159913857","3":"0.088358842","4":"0.73985302"},{"1":"0.658189478","2":"0.279993088","3":"0.528742002","4":"0.76673215"},{"1":"0.252298640","2":"0.371915132","3":"0.834164949","4":"0.10112952"},{"1":"0.206676560","2":"0.438964620","3":"0.541829960","4":"0.29183163"},{"1":"0.599312129","2":"0.163031930","3":"0.909742118","4":"0.18323140"},{"1":"0.398726245","2":"0.274731818","3":"0.051956553","4":"0.28702304"},{"1":"0.528163900","2":"0.171306065","3":"0.549274657","4":"0.70775237"},{"1":"0.327889627","2":"0.003472824","3":"0.266130404","4":"0.35624849"},{"1":"0.386178731","2":"0.124015578","3":"0.359277282","4":"0.53507835"},{"1":"0.302087873","2":"0.985093687","3":"0.526477262","4":"0.27682007"},{"1":"0.917461071","2":"0.708222907","3":"0.963174621","4":"0.15815602"},{"1":"0.001828696","2":"0.435738801","3":"0.939666500","4":"0.14155102"},{"1":"0.086381003","2":"0.914670136","3":"0.991699893","4":"0.91854043"},{"1":"0.027594801","2":"0.431146438","3":"0.022933241","4":"0.27706039"},{"1":"0.625027904","2":"0.908080674","3":"0.742195891","4":"0.30583039"},{"1":"0.744543981","2":"0.987019834","3":"0.134341351","4":"0.84731453"},{"1":"0.629741834","2":"0.250895715","3":"0.074554614","4":"0.27210354"},{"1":"0.252800117","2":"0.967360725","3":"0.303830615","4":"0.95664164"},{"1":"0.804212906","2":"0.990001554","3":"0.481194897","4":"0.15551388"},{"1":"0.960264201","2":"0.092161391","3":"0.732200734","4":"0.38318565"},{"1":"0.083555515","2":"0.571017796","3":"0.350080196","4":"0.17240253"},{"1":"0.611450968","2":"0.044782504","3":"0.949782070","4":"0.99791595"},{"1":"0.629488551","2":"0.232359330","3":"0.119710912","4":"0.67291122"},{"1":"0.550415306","2":"0.842433468","3":"0.027437964","4":"0.02331100"},{"1":"0.877415372","2":"0.837665933","3":"0.900661451","4":"0.05013669"},{"1":"0.106349742","2":"0.666973674","3":"0.355911315","4":"0.20680594"},{"1":"0.260607414","2":"0.444922076","3":"0.611206818","4":"0.01948040"},{"1":"0.969084063","2":"0.248997560","3":"0.598407000","4":"0.86150306"},{"1":"0.249412530","2":"0.517676827","3":"0.998861412","4":"0.86331337"},{"1":"0.161205652","2":"0.644012306","3":"0.917719611","4":"0.58580715"},{"1":"0.022181005","2":"0.265601381","3":"0.840627344","4":"0.89212764"},{"1":"0.831553451","2":"0.375073225","3":"0.692349181","4":"0.20111167"},{"1":"0.476982163","2":"0.801966869","3":"0.947402220","4":"0.68336452"},{"1":"0.322695188","2":"0.085208722","3":"0.505791549","4":"0.70515482"},{"1":"0.405384130","2":"0.370111677","3":"0.931018365","4":"0.01794368"},{"1":"0.265700066","2":"0.893888504","3":"0.746294651","4":"0.15924145"},{"1":"0.186035781","2":"0.883535426","3":"0.631074911","4":"0.94362725"},{"1":"0.715766346","2":"0.599478336","3":"0.174292727","4":"0.49592750"},{"1":"0.982496293","2":"0.175482902","3":"0.903362451","4":"0.11087143"},{"1":"0.409362240","2":"0.823731985","3":"0.418023938","4":"0.80516439"},{"1":"0.908667033","2":"0.636190318","3":"0.925523360","4":"0.68518016"},{"1":"0.422708160","2":"0.808589407","3":"0.941570152","4":"0.61648372"},{"1":"0.308792776","2":"0.024947092","3":"0.071060210","4":"0.32638986"},{"1":"0.296089598","2":"0.931808477","3":"0.432801552","4":"0.72635492"},{"1":"0.877244338","2":"0.363308474","3":"0.546331738","4":"0.82334325"},{"1":"0.837277102","2":"0.529236837","3":"0.757885370","4":"0.90194029"},{"1":"0.399864825","2":"0.364653972","3":"0.805515409","4":"0.23449429"},{"1":"0.496426540","2":"0.260771659","3":"0.831711272","4":"0.36782178"},{"1":"0.426970917","2":"0.590847247","3":"0.489389098","4":"0.70380360"},{"1":"0.456491933","2":"0.213893294","3":"0.134298747","4":"0.26711885"},{"1":"0.837929578","2":"0.292548953","3":"0.366426783","4":"0.31569117"},{"1":"0.967405398","2":"0.205423857","3":"0.497770812","4":"0.43981790"},{"1":"0.155034852","2":"0.796102990","3":"0.029233037","4":"0.05343063"},{"1":"0.734520216","2":"0.977588641","3":"0.946169165","4":"0.44524690"},{"1":"0.839484556","2":"0.385907989","3":"0.437249322","4":"0.39646805"},{"1":"0.877074466","2":"0.493263628","3":"0.175203668","4":"0.47568841"},{"1":"0.403214775","2":"0.518457710","3":"0.464456951","4":"0.63067315"},{"1":"0.550746746","2":"0.433054205","3":"0.958071464","4":"0.66927141"},{"1":"0.937686937","2":"0.474686519","3":"0.204154842","4":"0.49186622"},{"1":"0.051162304","2":"0.386851263","3":"0.358354673","4":"0.92709976"},{"1":"0.603351325","2":"0.799166486","3":"0.005821074","4":"0.99903609"},{"1":"0.566638213","2":"0.581042693","3":"0.018090502","4":"0.81993165"},{"1":"0.348993777","2":"0.106148295","3":"0.041833610","4":"0.76122699"},{"1":"0.453414940","2":"0.835257588","3":"0.058817382","4":"0.42852116"},{"1":"0.520331821","2":"0.077713026","3":"0.570597462","4":"0.20484826"},{"1":"0.269084754","2":"0.207743792","3":"0.322586367","4":"0.22474672"},{"1":"0.945899863","2":"0.488575437","3":"0.946523833","4":"0.79616075"},{"1":"0.828299464","2":"0.758937960","3":"0.971755036","4":"0.80538107"},{"1":"0.609277881","2":"0.966079249","3":"0.345317019","4":"0.87157908"},{"1":"0.456277495","2":"0.705579975","3":"0.146860921","4":"0.40099226"},{"1":"0.535955141","2":"0.138778890","3":"0.779458984","4":"0.60855058"},{"1":"0.371169768","2":"0.754106476","3":"0.231215322","4":"0.14944485"},{"1":"0.113530632","2":"0.612807222","3":"0.509378428","4":"0.69228912"},{"1":"0.330140087","2":"0.387588012","3":"0.495407697","4":"0.02944729"},{"1":"0.481325456","2":"0.959996700","3":"0.006131164","4":"0.11795172"},{"1":"0.937119149","2":"0.811938868","3":"0.972937859","4":"0.77457702"},{"1":"0.665413946","2":"0.943969057","3":"0.908539771","4":"0.62461202"},{"1":"0.787075026","2":"0.748545228","3":"0.809159657","4":"0.77560454"},{"1":"0.911733978","2":"0.180752164","3":"0.572341736","4":"0.21827769"},{"1":"0.336306393","2":"0.386903714","3":"0.500393947","4":"0.26746765"},{"1":"0.420199007","2":"0.194425383","3":"0.420948547","4":"0.50258859"},{"1":"0.587497154","2":"0.706854157","3":"0.011494415","4":"0.42118549"},{"1":"0.627926684","2":"0.491420208","3":"0.256914378","4":"0.86045213"},{"1":"0.634465582","2":"0.201021831","3":"0.338177042","4":"0.58574038"},{"1":"0.807264410","2":"0.949575212","3":"0.608623154","4":"0.77786091"},{"1":"0.285050088","2":"0.869949706","3":"0.909993249","4":"0.45666680"},{"1":"0.303763198","2":"0.449613431","3":"0.547738321","4":"0.03662699"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>random_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(random_dv <span class="sc">~</span> random_iv_1, random_df))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>random_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = random_dv ~ random_iv_1, data = random_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.47728 -0.23245 -0.02832  0.25692  0.49977 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.43728    0.06107   7.160  1.5e-10 ***
random_iv_1  0.10274    0.10608   0.968    0.335    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2862 on 98 degrees of freedom
Multiple R-squared:  0.00948,   Adjusted R-squared:  -0.0006272 
F-statistic: 0.938 on 1 and 98 DF,  p-value: 0.3352</code></pre>
</div>
</div>
<p>Looking at the output above, we can see that 0.948% of the variance of random_dv was explained by random_iv_1 before correction. Considering that these were randomly generated numbers, that’s 0.948% too much. However, the <em>Adjusted R-squared</em> is only -6^{-4}. Note that <em>Adjusted R-squared</em> can be a negative number (we’ll discuss the maths in a moment), but this just suggests that based on the sample, the predictors have no association with the outcome variable in the population.</p>
</section>
</section>
<section id="what-is-adjusted-r-squared" class="level1">
<h1>what is adjusted r-squared?</h1>
<p>To show that we’ve achieved the same as a t-test, let’s run a between subjects t-test that assumes the variance is equal between the groups (which is an assumption of a general linear model), and see if the p-values are the same:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#953.4478/730.8276</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># general linear models assume the variance between conditions is equal</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>continent_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001863749</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>continent_model<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># p-value for the continent as a predictor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001863749</code></pre>
</div>
</div>
<p>There are some advantages of conducting a t-test using the “lm” functionality:</p>
<ul>
<li><p>You can capture residuals</p></li>
<li><p>You have more flexibility to make more complex models</p></li>
</ul>
<p>Let’s now see how we can proceed if we have a more complex design, i.e.&nbsp;3 or more levels and/or more than 1 factor, using ANOVAs.</p>
</section>
<section id="trying-to-understand-f-values" class="level1">
<h1>trying to understand f-values</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manual calculation of F</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># between subject</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of squares between:</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#top_half &lt;- sum(continent_model$residuals^2)/1</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77.6486</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73.60812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.81202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>top_half <span class="ot">=</span> <span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">*</span> <span class="fu">sum</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>]) <span class="sc">-</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">^</span><span class="dv">2</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>top_half<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.01407</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> continent , gapminder_americas_europe), <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: lifeExp
            Sum Sq Df  F value    Pr(&gt;F)    
(Intercept) 135454  1 9823.186 &lt; 2.2e-16 ***
continent      223  1   16.145 0.0001864 ***
Residuals      731 53                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>statistic<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       t 
16.14453 </code></pre>
</div>
</div>
<p>SSBetween: 185.5168</p>
<p>SSwithin: 953.4478</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> gapminder_americas_europe</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>]<span class="ot">&lt;-</span> (<span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>]<span class="ot">&lt;-</span> (<span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>betweenSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>totalVar <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>withinSS <span class="ot">&lt;-</span> totalVar <span class="sc">-</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>betweenSS<span class="sc">/</span>(withinSS<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32.89829</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">*</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1386.928</code></pre>
</div>
</div>
<pre><code>16.145</code></pre>
<section id="anovas" class="level2">
<h2 class="anchored" data-anchor-id="anovas">ANOVAs</h2>
<p>ANOVAs are useful to compare between categorical conditions if you have more than 2 conditions you want to compare or if you have multiple categorical predictor factors you want to investigate. Let’s start with an example of a 2 x 2 design, in which continent and whether the population is “large” or “small” are categorical predictors of life expectancy. First, we need to make a new categorical variable, in which countries with a population greater than medium have a “large” population, and other countries have a “small” population:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popCategorical <span class="ot">=</span> <span class="st">"small"</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popDummy <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popCategorical[gapminder_americas_europe<span class="sc">$</span>pop <span class="sc">&gt;</span> <span class="fu">median</span>(gapminder_americas_europe<span class="sc">$</span>pop)] <span class="ot">=</span> <span class="st">"large"</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popDummy[gapminder_americas_europe<span class="sc">$</span>pop <span class="sc">&gt;</span> <span class="fu">median</span>(gapminder_americas_europe<span class="sc">$</span>pop)] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> gapminder_americas_europe[ ,<span class="fu">c</span>(</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"popCategorical"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"popDummy"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"continent"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"contDummy"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lifeExp"</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(anova_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["popCategorical"],"name":[1],"type":["chr"],"align":["left"]},{"label":["popDummy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["contDummy"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"small","2":"-1","3":"Europe","4":"1","5":"76.423","_rn_":"1"},{"1":"large","2":"1","3":"Americas","4":"-1","5":"75.320","_rn_":"2"},{"1":"small","2":"-1","3":"Europe","4":"1","5":"79.829","_rn_":"3"},{"1":"large","2":"1","3":"Europe","4":"1","5":"79.441","_rn_":"4"},{"1":"small","2":"-1","3":"Americas","4":"-1","5":"65.554","_rn_":"5"},{"1":"small","2":"-1","3":"Europe","4":"1","5":"74.852","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can now analyse this using a similar general linear model as the t-test above, but now have a second factor of <span class="math inline">\(popDummy\)</span> to try to make a more specific model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> popDummy <span class="sc">*</span> contDummy, <span class="at">data =</span> anova_df))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>glm_anova_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ popDummy * contDummy, data = anova_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.1815  -2.3171   0.4615   2.6663   6.6845 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         75.6598     0.4901 154.383  &lt; 2e-16 ***
popDummy             0.6759     0.4901   1.379  0.17388    
contDummy            1.9888     0.4901   4.058  0.00017 ***
popDummy:contDummy  -0.8977     0.4901  -1.832  0.07282 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.618 on 51 degrees of freedom
Multiple R-squared:  0.2999,    Adjusted R-squared:  0.2587 
F-statistic: 7.281 on 3 and 51 DF,  p-value: 0.0003721</code></pre>
</div>
</div>
<p>Let’s see if this model has less error (i.e.&nbsp;a smaller sum of squares than the t-test; 730.8276):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(glm_anova_model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 667.5443</code></pre>
</div>
</div>
<p>Yep, so this model is giving us a bit more insight as there is less error. Let’s visualise how much error there is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.65983</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6758679</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gapminder_americas_europe$t_fit = continent_ttest$coefficients[1] + # intercept</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   continent_ttest$coefficients[2]                       * # gradient</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   gapminder_americas_europe$contDummy</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(gapminder_americas_europe, aes(x = contDummy, y = lifeExp)) +</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     position = "jitter",</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       xend = contDummy,</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">#       yend = t_fit,</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       color = "resid"</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + </span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(aes(</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = -1.9, </span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     xend = -.1, </span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = -1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1],</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     yend = -1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1]),</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     color = "blue"</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + </span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(aes(</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0.1, </span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     xend = 1.9, </span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = 1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1],</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     yend = 1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1]),</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     color = "blue"</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compare the output of this lm function to an ANOVA function in R to confirm that these are the same thing (i.e.&nbsp;that ANOVA is a general linear model):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(aov(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df), type = "3")</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># temp_model &lt;- lm(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(temp_model)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(lm(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df), type = "3")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You’ll see that the 2 x 2 interaction p-values are identical between analyses, but that the individual factors are similar but not identical.</p>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">Regression</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<div class="cell">

</div>
<p>Now lets see how this looks for the above analyses:</p>
</section>
</section>
<section id="simple-regressions-and-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="simple-regressions-and-t-tests">Simple Regressions and t-tests</h2>
<p>As described in more detail in the <a href="../regressions/simpleRegressions.html">simple regression section</a>, the simplest general linear model could be formulated as:</p>
<p><span class="math display">\[
Y = a + bX + e
\]</span></p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>