<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - General Linear Models and Sum of Squares</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document">Report an error</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications">Request a clarification</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content">Suggest Content</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">General Linear Models and Sum of Squares</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Welcome</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">Installing R(Studio)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Statistics Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">Statistics Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">Scientific Notation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">R Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">Types of Scripts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">R Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">R Logic</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Describing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">Central Tendency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">Dispersion</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Distributions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">Normal Distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">Skewness</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/kurtosis.html" class="sidebar-item-text sidebar-link">Kurtosis (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">Transforming Data (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Correlation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">Correlations</a>
  </div>
</li>
          <li class="sidebar-item">
  correlations/cooksd.qmd
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Regressions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">Simple regression (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">Multiple Regressions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">General Linear Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link active">General Linear Models and Sum of Squares</a>
  </div>
</li>
          <li class="sidebar-item">
  GeneralLinearModels/One-Way Analysis of Variance
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/rVsAdjustedRSquared.html" class="sidebar-item-text sidebar-link">R-squared vs.&nbsp;Adjusted R-squared</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-are-general-linear-models" id="toc-what-are-general-linear-models" class="nav-link active" data-scroll-target="#what-are-general-linear-models">What are general linear models?</a></li>
  <li><a href="#mean-as-the-simplest-model-of-data" id="toc-mean-as-the-simplest-model-of-data" class="nav-link" data-scroll-target="#mean-as-the-simplest-model-of-data">Mean as the simplest model of data</a></li>
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests">T-Tests</a>
  <ul class="collapse">
  <li><a href="#r-squared-vs.-adjusted-r-squared" id="toc-r-squared-vs.-adjusted-r-squared" class="nav-link" data-scroll-target="#r-squared-vs.-adjusted-r-squared">R-squared vs.&nbsp;adjusted R-squared</a></li>
  </ul></li>
  <li><a href="#trying-to-understand-f-values" id="toc-trying-to-understand-f-values" class="nav-link" data-scroll-target="#trying-to-understand-f-values">trying to understand f-values</a>
  <ul class="collapse">
  <li><a href="#anovas" id="toc-anovas" class="nav-link" data-scroll-target="#anovas">ANOVAs</a></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  <li><a href="#simple-regressions-and-t-tests" id="toc-simple-regressions-and-t-tests" class="nav-link" data-scroll-target="#simple-regressions-and-t-tests">Simple Regressions and t-tests</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">General Linear Models and Sum of Squares</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="what-are-general-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="what-are-general-linear-models">What are general linear models?</h2>
<p>General linear models allow you to analyse data in which the <strong>dependent</strong> variable is continuous. For example, if you are analysing the height of a group of individuals, you might use one of the following analyses:</p>
<ul>
<li><p><strong>t-test</strong>, comparisons between two conditions e.g.&nbsp;are males taller than females?</p></li>
<li><p><strong>regression</strong>, one or more predictors of a single outcome e.g.&nbsp;does foot size, weight etc. predict height? (Note that <strong>correlations</strong> are equivalent to a regression with a single predictor)</p></li>
<li><p><strong>ANOVA</strong>, comparisons between 3 or more conditions or between multiple categorical factors, e.g.&nbsp;are there differences in height between sexes and nationalities?</p></li>
</ul>
<p><strong>Linear</strong> refers to the <strong>dependent variable</strong> being continuous.</p>
<p><strong>General</strong> refers to the fact that the <strong>independent variables</strong> can both be continuous (e.g.&nbsp;regression) or categorical (e.g.&nbsp;t-test or ANOVA).</p>
<p>In <strong>general linear models</strong> all analyses involve creating a model, and capturing what is and isn’t explained by the model (i.e.&nbsp;the <strong>error</strong> of the model). All analyses in general linear models can be formulated as:</p>
<p><span class="math display">\[
Data = Model + Error
\]</span></p>
<p>Data: The dependent variable in your analysis Model: A model which predicts a phenomenon. This could be multiple independent variables. Error: What data isn’t explained by the model.</p>
</section>
<section id="mean-as-the-simplest-model-of-data" class="level2">
<h2 class="anchored" data-anchor-id="mean-as-the-simplest-model-of-data">Mean as the simplest model of data</h2>
<p>If you want to estimate what someone’s life expectancy would be in 2007, you could look at the mean life expectancy using the gapminder data. In terms of how this corresponds to the above model:</p>
<p><span class="math display">\[
Data = Model + Error
\]</span></p>
<p><span class="math display">\[
estimatedLifeExpectancy = mean(lifeExpectancy) + Error
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new data frame that only focuses on data from 2007</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span>     </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67.00742</code></pre>
</div>
</div>
<p><span class="math display">\[
estimatedLifeExpectancy = 67.01 + Error
\]</span></p>
<p>Which could be visualised as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  gapminder_2007, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_2007<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 1.</em></p>
<p>In English, the above model and figure allow you to predict that anyone’s life expectancy will be 67 years. However, as you can also see, there’s a huge amount of error, i.e.&nbsp;variance in life expectancy that is not explained by the model. These errors can be squared and summed to give the <strong>sum of squares</strong>, a statistic of how much error there is around the model:</p>
<p><span class="math display">\[
SS = \sum(Y_i-\bar{Y})^2
\]</span></p>
<p>Which can be visualised as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 2.</em></p>
<p>You can directly compare <strong>fig.&nbsp;1. and fig.&nbsp;2.</strong> to see how much error is associated with each data point compared to the model. Fig. 2. is positive because it is the distance of the data-point from the mean squared. If you added together all the <strong>squares (pink lines)</strong> in fig.&nbsp;2. that would give you the <strong>sum of squares.</strong></p>
<p>As you may have guessed, it is possible to have more precise models that have less error, and thus a smaller <strong>sum of squares</strong>. The sum of squares around the mean is also the <strong>total sum of squares,</strong> and the <strong>total variance</strong>. When we calculate the proportion of the variance that a model explains, we are comparing it to this <strong>variance around the mean.</strong></p>
<p>Let’s explore those possibilities now.</p>
</section>
<section id="t-tests" class="level2">
<h2 class="anchored" data-anchor-id="t-tests">T-Tests</h2>
<p>T-tests are restricted to comparisons between 2 conditions/groups, so we will restrict the Gapminder data to allow a comparison between 2 continents. To see if life expectancy was different if you are born in Europe compared to the Americas, let’s first check what the sum of squares is when you just use the <strong>mean</strong> as the model of life expectancy across these contents:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  gapminder_2007,   <span class="co"># the data set</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">rank</span>(lifeExp), <span class="at">y=</span>lifeExp)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. 3.</em> The errors around the mean of life expectancy across Europe and American countries.</p>
<p>Once we square the errors in the pink lines above, we’ll get the <strong>squares:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="fu">rank</span>(lifeExp), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y is the square of the difference between each data point and the mean across all data poins. Once these are summed you will get the sum of squares.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>(lifeExp<span class="sc">-</span><span class="fu">mean</span>(lifeExp))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> <span class="fu">rank</span>(lifeExp),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 953.4478</code></pre>
</div>
</div>
<p>And when you add all of these together:</p>
<p><span class="math display">\[
SumOfSquares = \sum(Y_i-\bar{Y})^2 = 953.4478
\]</span></p>
<p>So if the model we create for a t-test would result in a smaller <strong>sum of squares</strong> then that suggests it’s a more precise model for estimating life expectancy than simply using the <strong>mean</strong> as a model. This is because this would mean there’s less <strong>error</strong> in this model. Let’s model this using a t-test. For this we will need to dummy code country:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a column to place 1 or -1 for each row dependent on the country</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>contDummy <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>contDummy[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>contDummy[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe <span class="ot">=</span> <span class="fu">cbind</span>(contDummy,gapminder_americas_europe)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["contDummy"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["country"],"name":[2],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[6],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"Albania","3":"Europe","4":"2007","5":"76.423","6":"3600523","7":"5937.030","_rn_":"1"},{"1":"-1","2":"Argentina","3":"Americas","4":"2007","5":"75.320","6":"40301927","7":"12779.380","_rn_":"2"},{"1":"1","2":"Austria","3":"Europe","4":"2007","5":"79.829","6":"8199783","7":"36126.493","_rn_":"3"},{"1":"1","2":"Belgium","3":"Europe","4":"2007","5":"79.441","6":"10392226","7":"33692.605","_rn_":"4"},{"1":"-1","2":"Bolivia","3":"Americas","4":"2007","5":"65.554","6":"9119152","7":"3822.137","_rn_":"5"},{"1":"1","2":"Bosnia and Herzegovina","3":"Europe","4":"2007","5":"74.852","6":"4552198","7":"7446.299","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now that we have dummy coded the continent, we can create a new model to try to predict an individual’s life expectancy based on which continent they are from</p>
<p><span class="math display">\[
Y = intercept + \beta * dummyVariable + Error
\]</span></p>
<p><span class="math display">\[
lifeExp = mean(lifeExp) + \beta * ContDummy + Error
\]</span></p>
<ul>
<li><p>Y being the predicted life expectancy.</p></li>
<li><p><span class="math inline">\(\bar{Y}\)</span> being the mean life expectancy regardless of continent. For a t-test this is also the <span class="math inline">\(intercept\)</span>.</p></li>
<li><p><span class="math inline">\(\beta\)</span> being how much to adjust the prediction based on which continent the person is from</p></li>
<li><p><span class="math inline">\(ContDummy\)</span> being 1 (Europe) or -1 (Americas) to reflect which continent the participant is from</p></li>
<li><p><span class="math inline">\(Error\)</span> being any error in the prediction not captured by the model</p></li>
</ul>
<p>To get the <span class="math inline">\(intercept\)</span> and <span class="math inline">\(\beta\)</span> for the above formula let’s use the lm function in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   75.62836 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>contDummy 
  2.02024 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_fit <span class="ot">=</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> <span class="co"># intercept</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>]                       <span class="sc">*</span> <span class="co"># gradient</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>contDummy</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder_americas_europe, <span class="fu">aes</span>(<span class="at">x =</span> contDummy, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xend =</span> contDummy,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">yend =</span> t_fit,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"resid"</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">-</span><span class="fl">1.9</span>, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fl">1.9</span>, </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="dv">1</span> <span class="sc">*</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span> continent_ttest<span class="sc">$</span>coefficients[<span class="dv">1</span>]),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. X. Countries in the americas are dummy coded as -1 and countries in Europe are dummy coded as 1. Note that jittering has been used to help visualise variation within continents, and so all countries in Americas had a</em> <span class="math inline">\(contDummy\)</span> score of -1, even if the jittering above makes it look like participants from Europe had slightly different <span class="math inline">\(contDummy\)</span> values to each other.</p>
<p>So now that we’ve visualised the predictions and the error, lets summarise these errors with their sum of squares:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to get the sum of squares, you can use the lm from earlier</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(continent_ttest<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 730.8276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to calculate this manually:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_res <span class="ot">=</span> gapminder_americas_europe<span class="sc">$</span>t_fit <span class="sc">-</span> gapminder_americas_europe<span class="sc">$</span>lifeExp</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>t_res_squared <span class="ot">=</span> gapminder_americas_europe<span class="sc">$</span>t_res<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>t_res_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 730.8276</code></pre>
</div>
</div>
<p>So the new sum of squares is 730.8276, which is smaller than it was when we just used the mean regardless of continent (953.4478) which also summarises the <strong>total variance</strong> (around the mean). In fact, we can use these 2 numbers to calculate the <span class="math inline">\(r^2\)</span> value (i.e.&nbsp;what proportion of the variance around the mean is explained by the model). The amount of variance explained by the model can be calculated by:</p>
<p><span class="math display">\[
totalSumOfSquares - modelSumOfSquares = totalError - modelError
\]</span></p>
<p>This allows us to calculate an r-value and thus a p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>this_r2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(gapminder_americas_europe<span class="sc">$</span>t_res_squared)<span class="sc">/</span><span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>this_r <span class="ot">=</span> <span class="fu">sqrt</span>(this_r2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>this_r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4832076</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  gapminder_americas_europe$lifeExp[gapminder_americas_europe$contDummy == 1] and gapminder_americas_europe$lifeExp[gapminder_americas_europe$contDummy == -1]
t = 4.018, df = 53, p-value = 0.0001864
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 2.023525 6.057435
sample estimates:
mean of x mean of y 
 77.64860  73.60812 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ contDummy, data = gapminder_americas_europe)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.6921  -2.1364   0.4494   2.5671   7.0449 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  75.6284     0.5028 150.416  &lt; 2e-16 ***
contDummy     2.0202     0.5028   4.018 0.000186 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.713 on 53 degrees of freedom
Multiple R-squared:  0.2335,    Adjusted R-squared:  0.219 
F-statistic: 16.14 on 1 and 53 DF,  p-value: 0.0001864</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>this_r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2334896</code></pre>
</div>
</div>
<p>You may notice above that the manually calculated <span class="math inline">\(r^2\)</span> value is identical to the “Multiple R-Squared”, rather than the “Adjusted R-squared”. So what’s the difference between r-squared and adjusted r-squared?</p>
<section id="r-squared-vs.-adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-vs.-adjusted-r-squared">R-squared vs.&nbsp;adjusted R-squared</h3>
<p>When completing a regression, there’s always a risk of “overfitting” the data, i.e.&nbsp;creating a model that includes predictors that have no meaningful association with the outcome variable. One reason that overfitting the data is a problem is that it is almost impossible for a predictor to have no association with an outcome variable. For that to happen you would need any data points that suggested a positive association between the outcome and the predictor to be equally balanced out by data points that suggest a negative association:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>no_association_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome   =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(no_association_df, <span class="fu">aes</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> outcome)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="generalLinearModels_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Fig. X.</em> An example of how unrealistically balanced your data needs to be to find no association. As this (almost) never happens in reality, samples are <em>biased</em> towards finding associations between predictor and outcome variables even when there aren’t any in the population. For example, let’s generate some random data, and see what R-Values we find. Remember, random data really shouldn’t have <em>any</em> association between predictor and outcome variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>random_df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_1 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_2 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_iv_3 =</span> <span class="fu">runif</span>(<span class="dv">100</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_dv =</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(random_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["random_iv_1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["random_iv_2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["random_iv_3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["random_dv"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.752425138","2":"0.83101279","3":"0.951230101","4":"0.252548574"},{"1":"0.500650707","2":"0.44326813","3":"0.322148668","4":"0.210040439"},{"1":"0.590196409","2":"0.29392859","3":"0.643916041","4":"0.610291340"},{"1":"0.888706747","2":"0.84638255","3":"0.584069768","4":"0.155559514"},{"1":"0.555519061","2":"0.71461164","3":"0.676228503","4":"0.119345602"},{"1":"0.413624720","2":"0.62132881","3":"0.728332494","4":"0.902643404"},{"1":"0.898445396","2":"0.92047487","3":"0.348495909","4":"0.131624694"},{"1":"0.753563248","2":"0.57886671","3":"0.850287445","4":"0.169481374"},{"1":"0.616117300","2":"0.56303126","3":"0.709433276","4":"0.155891096"},{"1":"0.979704127","2":"0.40871096","3":"0.430461259","4":"0.645812301"},{"1":"0.961405946","2":"0.10468431","3":"0.331664066","4":"0.004931157"},{"1":"0.852522480","2":"0.10283200","3":"0.661537620","4":"0.802680801"},{"1":"0.359749294","2":"0.65680862","3":"0.370796204","4":"0.489758944"},{"1":"0.379312604","2":"0.78204969","3":"0.927965853","4":"0.491036302"},{"1":"0.386248315","2":"0.36988569","3":"0.918745281","4":"0.662830343"},{"1":"0.181165684","2":"0.25696438","3":"0.891950361","4":"0.456993200"},{"1":"0.193942446","2":"0.11951954","3":"0.485034096","4":"0.588636027"},{"1":"0.100768282","2":"0.32286925","3":"0.214860959","4":"0.824309498"},{"1":"0.963127735","2":"0.61671602","3":"0.846213753","4":"0.611422325"},{"1":"0.640518413","2":"0.22441541","3":"0.776232615","4":"0.995800276"},{"1":"0.004519405","2":"0.39241495","3":"0.782468533","4":"0.569554344"},{"1":"0.914004130","2":"0.14103296","3":"0.008859622","4":"0.282611062"},{"1":"0.759834863","2":"0.87799541","3":"0.534610187","4":"0.759606491"},{"1":"0.651785642","2":"0.47816107","3":"0.692903442","4":"0.036804497"},{"1":"0.231817986","2":"0.87489814","3":"0.235201470","4":"0.624413111"},{"1":"0.594238371","2":"0.57043034","3":"0.064707547","4":"0.486328332"},{"1":"0.506247421","2":"0.24545839","3":"0.860776840","4":"0.114358137"},{"1":"0.415444903","2":"0.28645858","3":"0.759832457","4":"0.114385233"},{"1":"0.314520758","2":"0.52537841","3":"0.504655803","4":"0.620645686"},{"1":"0.972160826","2":"0.59817001","3":"0.789650837","4":"0.638652841"},{"1":"0.058294803","2":"0.60104065","3":"0.899779465","4":"0.464567557"},{"1":"0.767603423","2":"0.35936526","3":"0.023543625","4":"0.030439252"},{"1":"0.776085349","2":"0.05340522","3":"0.070470445","4":"0.808839323"},{"1":"0.645774147","2":"0.78288850","3":"0.940867142","4":"0.043510050"},{"1":"0.724541870","2":"0.92622856","3":"0.890207954","4":"0.448400018"},{"1":"0.062430590","2":"0.91210337","3":"0.448471538","4":"0.790152184"},{"1":"0.002362069","2":"0.19176528","3":"0.442550531","4":"0.418403808"},{"1":"0.785138838","2":"0.79351776","3":"0.371351884","4":"0.141021331"},{"1":"0.007867411","2":"0.19109304","3":"0.561409600","4":"0.959012520"},{"1":"0.318297715","2":"0.63303119","3":"0.263213669","4":"0.968002934"},{"1":"0.671293451","2":"0.25888129","3":"0.476008554","4":"0.235284489"},{"1":"0.124008040","2":"0.37334192","3":"0.655848806","4":"0.948010178"},{"1":"0.733521847","2":"0.89659585","3":"0.450982848","4":"0.137257197"},{"1":"0.416305429","2":"0.05508478","3":"0.097096049","4":"0.284814293"},{"1":"0.050291747","2":"0.32920796","3":"0.495751204","4":"0.069229383"},{"1":"0.082370051","2":"0.50752037","3":"0.259803070","4":"0.827669762"},{"1":"0.951652898","2":"0.70136500","3":"0.826589274","4":"0.133208644"},{"1":"0.209140492","2":"0.02806405","3":"0.423944858","4":"0.963895886"},{"1":"0.935187672","2":"0.90759299","3":"0.827037937","4":"0.207601154"},{"1":"0.644295011","2":"0.68523483","3":"0.640289615","4":"0.905396030"},{"1":"0.798028322","2":"0.53516895","3":"0.461881210","4":"0.774854080"},{"1":"0.366607268","2":"0.15321452","3":"0.047571099","4":"0.609911684"},{"1":"0.971643362","2":"0.23755968","3":"0.110220991","4":"0.355181640"},{"1":"0.887485929","2":"0.35596256","3":"0.220953791","4":"0.662521497"},{"1":"0.612680083","2":"0.49067431","3":"0.954680445","4":"0.728842426"},{"1":"0.178236119","2":"0.55206248","3":"0.162157042","4":"0.570491306"},{"1":"0.337063756","2":"0.10409146","3":"0.892082628","4":"0.674309045"},{"1":"0.461238437","2":"0.65925762","3":"0.095391917","4":"0.285081010"},{"1":"0.631443664","2":"0.90533472","3":"0.829046530","4":"0.087336329"},{"1":"0.707958494","2":"0.12644761","3":"0.117533812","4":"0.335552980"},{"1":"0.093783070","2":"0.67163606","3":"0.301259077","4":"0.385498171"},{"1":"0.400061089","2":"0.88544250","3":"0.540431713","4":"0.168579493"},{"1":"0.667614490","2":"0.72121250","3":"0.332968103","4":"0.998679422"},{"1":"0.940381252","2":"0.47098583","3":"0.817089852","4":"0.293465873"},{"1":"0.977190147","2":"0.87982047","3":"0.562244849","4":"0.370711869"},{"1":"0.447978216","2":"0.22964857","3":"0.868649535","4":"0.896102528"},{"1":"0.579249091","2":"0.92766931","3":"0.039815367","4":"0.142946953"},{"1":"0.121322882","2":"0.77543937","3":"0.683598693","4":"0.957600670"},{"1":"0.541273636","2":"0.50247109","3":"0.035309596","4":"0.338557439"},{"1":"0.858825828","2":"0.14851933","3":"0.654674490","4":"0.079821577"},{"1":"0.516015787","2":"0.06675135","3":"0.254274882","4":"0.964995837"},{"1":"0.176663359","2":"0.76214485","3":"0.693919079","4":"0.138761800"},{"1":"0.488441199","2":"0.29427993","3":"0.356518415","4":"0.473233929"},{"1":"0.250961483","2":"0.35895881","3":"0.642947903","4":"0.173582948"},{"1":"0.401136626","2":"0.53356412","3":"0.390633392","4":"0.761430498"},{"1":"0.159733994","2":"0.18440775","3":"0.583318556","4":"0.742334821"},{"1":"0.161586513","2":"0.72179832","3":"0.371037964","4":"0.717221132"},{"1":"0.361449490","2":"0.93870912","3":"0.527457830","4":"0.609332695"},{"1":"0.328454104","2":"0.83190977","3":"0.922519320","4":"0.982731701"},{"1":"0.833245743","2":"0.44338579","3":"0.519299019","4":"0.786410264"},{"1":"0.149479927","2":"0.78739893","3":"0.021436829","4":"0.457939824"},{"1":"0.960661704","2":"0.44056288","3":"0.119087223","4":"0.303832650"},{"1":"0.773104087","2":"0.73093099","3":"0.228774584","4":"0.750831693"},{"1":"0.775933703","2":"0.88955088","3":"0.259501949","4":"0.910537300"},{"1":"0.909252293","2":"0.22985840","3":"0.312518941","4":"0.506931319"},{"1":"0.863460821","2":"0.34332954","3":"0.187735886","4":"0.092168616"},{"1":"0.902024507","2":"0.38690765","3":"0.587552018","4":"0.647006344"},{"1":"0.769976420","2":"0.28526725","3":"0.588529330","4":"0.521053487"},{"1":"0.133678064","2":"0.82906302","3":"0.017494958","4":"0.453148528"},{"1":"0.290636196","2":"0.13448475","3":"0.107267339","4":"0.196478088"},{"1":"0.064296675","2":"0.36449677","3":"0.422814571","4":"0.370463840"},{"1":"0.530687334","2":"0.93486755","3":"0.354778621","4":"0.182748048"},{"1":"0.813322060","2":"0.40442875","3":"0.713606205","4":"0.642426180"},{"1":"0.934005270","2":"0.13925693","3":"0.341310182","4":"0.570871172"},{"1":"0.168902831","2":"0.78447397","3":"0.310134625","4":"0.616309591"},{"1":"0.098069369","2":"0.89731313","3":"0.904131378","4":"0.519451901"},{"1":"0.035313540","2":"0.79794339","3":"0.439288449","4":"0.153741756"},{"1":"0.489628237","2":"0.66511023","3":"0.075161752","4":"0.484025035"},{"1":"0.741807868","2":"0.71391903","3":"0.268806516","4":"0.483666933"},{"1":"0.578455625","2":"0.22069893","3":"0.785785239","4":"0.715545371"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>random_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(random_dv <span class="sc">~</span> random_iv_1, random_df)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>random_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(random_lm)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>random_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = random_dv ~ random_iv_1, data = random_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.51860 -0.26124 -0.01848  0.24262  0.53850 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.59823    0.05697  10.501   &lt;2e-16 ***
random_iv_1 -0.20678    0.09395  -2.201   0.0301 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2844 on 98 degrees of freedom
Multiple R-squared:  0.0471,    Adjusted R-squared:  0.03738 
F-statistic: 4.844 on 1 and 98 DF,  p-value: 0.03009</code></pre>
</div>
</div>
<p><strong>Note that the above output is generated each time this page is rendered (generated), and so <em>by chance</em> may happen to look like the random predictor is significant. If so, there’s a 95% chance that this predictor will not be significant next time the page is rendered</strong>.</p>
<p>Looking at the output above, we can see that 4.71% of the variance of random_dv was explained by <em>random_iv_1</em> before correction. Considering that these were randomly generated numbers, that’s 4.71% too much. However, the <em>Adjusted R-squared</em> is only 0.0374. Note that <em>Adjusted R-squared</em> can be a negative number, and a negative number suggests that based on the sample, the predictor(s) has(/have) no association with the outcome variable in the population.</p>
<p>A formula for the adjusted r-squared is:</p>
<p><span class="math display">\[
\bar{R^2} = 1-\frac{SS_{res}/df_{res}}{SS_{tot}/df_{tot}}
\]</span> <span class="math inline">\(\bar{R^2}\)</span> is the <em>Adjusted R-Squared</em> <span class="math inline">\(SS_{total}\)</span> is the <em>Sum of Squares</em> of the <em>total</em> (i.e.&nbsp;how much total variance there is around the mean to explain) <span class="math inline">\(SS_{res}\)</span> is the <em>Sum of Squares</em> of the <em>residuals</em> (i.e.&nbsp;how much isn’t explained by the model) <span class="math inline">\(df_{total}\)</span> is the <em>Degrees of Freedom</em> of the <em>total</em>. This is the number of data points - 1, so is N - 1 <span class="math inline">\(df_{res}\)</span> is the <em>Degrees of Freedom</em> of the <em>residuals</em>. The degrees of freedom for the residuals takes into account the number of data points and the number of predictors, and so is N - 1 - 1</p>
<p>Let’s use the above formula to manually calculate the <em>Adjusted R Squared</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span> <span class="fu">sum</span>(random_lm<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    random_df<span class="sc">$</span>random_dv <span class="sc">-</span> <span class="fu">mean</span>(random_df<span class="sc">$</span>random_dv)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>random_r_square <span class="ot">=</span> ss_total <span class="sc">-</span> ss_res</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>df_total <span class="ot">&lt;-</span> <span class="fu">length</span>(random_lm<span class="sc">$</span>residuals) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>df_res <span class="ot">&lt;-</span> <span class="fu">length</span>(random_lm<span class="sc">$</span>residuals) <span class="sc">-</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="co"># remove 1 from the number of data points</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="co"># remove another 1 to reflect there being 1 predictor</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>adjusted_random_r_square <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (ss_res<span class="sc">/</span>df_res)<span class="sc">/</span>(ss_total<span class="sc">/</span>df_total)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>adjusted_random_r_square</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03737638</code></pre>
</div>
</div>
<p>The number above should match the <em>Adjusted R-Squared</em> from the multiple regression above. Let’s explore what happens when we have multiple predictors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>random_lm_multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(random_dv <span class="sc">~</span> random_iv_1 <span class="sc">+</span> random_iv_2 <span class="sc">+</span> random_iv_3, random_df)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>random_multiple_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(random_lm_multiple)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>random_multiple_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = random_dv ~ random_iv_1 + random_iv_2 + random_iv_3, 
    data = random_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.54754 -0.23857  0.00963  0.23377  0.57801 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.64985    0.08978   7.238 1.12e-10 ***
random_iv_1 -0.20921    0.09389  -2.228   0.0282 *  
random_iv_2 -0.14868    0.10442  -1.424   0.1577    
random_iv_3  0.05322    0.10174   0.523   0.6021    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2842 on 96 degrees of freedom
Multiple R-squared:  0.06802,   Adjusted R-squared:  0.0389 
F-statistic: 2.335 on 3 and 96 DF,  p-value: 0.07864</code></pre>
</div>
</div>
<p>Two things to look for from the above: - The model with 3 predictors has higher <em>(Multiple) R-Squared</em> than the model with only 1 predictor. This reflects problems with over-fitting the model: the more predictors you include in your sample, the more variance in the outcome that will be explained by the predictors, even if those associations between the predictors are arbitrary (i.e.&nbsp;don’t reflect anything about the general population). - <em>Adjusted R-squared</em> values are less susceptible to this bias of overfitting the data (but is not completely invulnerable to it). All statistical tests are vulnerable to false positives and including <em>Adjusted R-squared</em> values.</p>
<p>Remember, the adjusted r-square is necessary for us to make claims about the general population. If we just wanted to make a claim about our sample, we would just use the r-squared, as we don’t need to correct our estimate.</p>
<p>To show that we’ve achieved the same as a t-test, let’s run a between subjects t-test that assumes the variance is equal between the groups (which is an assumption of a general linear model), and see if the p-values are the same:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#953.4478/730.8276</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>continent_ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># general linear models assume the variance between conditions is equal</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var.equal =</span> T</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>continent_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> contDummy, gapminder_americas_europe))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001863749</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>continent_model<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># p-value for the continent as a predictor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0001863749</code></pre>
</div>
</div>
<p>There are some advantages of conducting a t-test using the “lm” functionality:</p>
<ul>
<li><p>You can capture residuals</p></li>
<li><p>You have more flexibility to make more complex models</p></li>
</ul>
<p>Let’s now see how we can proceed if we have a more complex design, i.e.&nbsp;3 or more levels and/or more than 1 factor, using ANOVAs.</p>
</section>
</section>
<section id="trying-to-understand-f-values" class="level1">
<h1>trying to understand f-values</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manual calculation of F</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># between subject</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of squares between:</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#top_half &lt;- sum(continent_model$residuals^2)/1</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77.6486</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73.60812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.81202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>top_half <span class="ot">=</span> <span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">*</span> <span class="fu">sum</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  (</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp[gapminder_americas_europe<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>]) <span class="sc">-</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">^</span><span class="dv">2</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>top_half<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.01407</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> continent , gapminder_americas_europe), <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: lifeExp
            Sum Sq Df  F value    Pr(&gt;F)    
(Intercept) 135454  1 9823.186 &lt; 2.2e-16 ***
continent      223  1   16.145 0.0001864 ***
Residuals      731 53                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>continent_ttest<span class="sc">$</span>statistic<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       t 
16.14453 </code></pre>
</div>
</div>
<p>SSBetween: 185.5168</p>
<p>SSwithin: 953.4478</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> gapminder_americas_europe</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>]<span class="ot">&lt;-</span> (<span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>anova_df<span class="sc">$</span>sq_bt[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>]<span class="ot">&lt;-</span> (<span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">mean</span>(anova_df<span class="sc">$</span>lifeExp[anova_df<span class="sc">$</span>contDummy <span class="sc">==</span> <span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>bottom_half <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>betweenSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>totalVar <span class="ot">&lt;-</span> <span class="fu">sum</span>((gapminder_americas_europe<span class="sc">$</span>lifeExp <span class="sc">-</span> <span class="fu">mean</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>withinSS <span class="ot">&lt;-</span> totalVar <span class="sc">-</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>betweenSS<span class="sc">/</span>(withinSS<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp)<span class="sc">-</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32.89829</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(gapminder_americas_europe<span class="sc">$</span>lifeExp) <span class="sc">*</span> <span class="fu">sum</span>(anova_df<span class="sc">$</span>sq_bt)<span class="sc">/</span>bottom_half</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1386.928</code></pre>
</div>
</div>
<pre><code>16.145</code></pre>
<section id="anovas" class="level2">
<h2 class="anchored" data-anchor-id="anovas">ANOVAs</h2>
<p>ANOVAs are useful to compare between categorical conditions if you have more than 2 conditions you want to compare or if you have multiple categorical predictor factors you want to investigate. Let’s start with an example of a 2 x 2 design, in which continent and whether the population is “large” or “small” are categorical predictors of life expectancy. First, we need to make a new categorical variable, in which countries with a population greater than medium have a “large” population, and other countries have a “small” population:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popCategorical <span class="ot">=</span> <span class="st">"small"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popDummy <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popCategorical[gapminder_americas_europe<span class="sc">$</span>pop <span class="sc">&gt;</span> <span class="fu">median</span>(gapminder_americas_europe<span class="sc">$</span>pop)] <span class="ot">=</span> <span class="st">"large"</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>gapminder_americas_europe<span class="sc">$</span>popDummy[gapminder_americas_europe<span class="sc">$</span>pop <span class="sc">&gt;</span> <span class="fu">median</span>(gapminder_americas_europe<span class="sc">$</span>pop)] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> gapminder_americas_europe[ ,<span class="fu">c</span>(</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"popCategorical"</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"popDummy"</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"continent"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"contDummy"</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lifeExp"</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(<span class="fu">head</span>(anova_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["popCategorical"],"name":[1],"type":["chr"],"align":["left"]},{"label":["popDummy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["continent"],"name":[3],"type":["fct"],"align":["left"]},{"label":["contDummy"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lifeExp"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"small","2":"-1","3":"Europe","4":"1","5":"76.423","_rn_":"1"},{"1":"large","2":"1","3":"Americas","4":"-1","5":"75.320","_rn_":"2"},{"1":"small","2":"-1","3":"Europe","4":"1","5":"79.829","_rn_":"3"},{"1":"large","2":"1","3":"Europe","4":"1","5":"79.441","_rn_":"4"},{"1":"small","2":"-1","3":"Americas","4":"-1","5":"65.554","_rn_":"5"},{"1":"small","2":"-1","3":"Europe","4":"1","5":"74.852","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can now analyse this using a similar general linear model as the t-test above, but now have a second factor of <span class="math inline">\(popDummy\)</span> to try to make a more specific model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(lifeExp <span class="sc">~</span> popDummy <span class="sc">*</span> contDummy, <span class="at">data =</span> anova_df))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>glm_anova_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExp ~ popDummy * contDummy, data = anova_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.1815  -2.3171   0.4615   2.6663   6.6845 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         75.6598     0.4901 154.383  &lt; 2e-16 ***
popDummy             0.6759     0.4901   1.379  0.17388    
contDummy            1.9888     0.4901   4.058  0.00017 ***
popDummy:contDummy  -0.8977     0.4901  -1.832  0.07282 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.618 on 51 degrees of freedom
Multiple R-squared:  0.2999,    Adjusted R-squared:  0.2587 
F-statistic: 7.281 on 3 and 51 DF,  p-value: 0.0003721</code></pre>
</div>
</div>
<p>Let’s see if this model has less error (i.e.&nbsp;a smaller sum of squares than the t-test; 730.8276):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(glm_anova_model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 667.5443</code></pre>
</div>
</div>
<p>Yep, so this model is giving us a bit more insight as there is less error. Let’s visualise how much error there is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model<span class="sc">$</span>coefficients[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.65983</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>glm_anova_model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6758679</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gapminder_americas_europe$t_fit = continent_ttest$coefficients[1] + # intercept</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   continent_ttest$coefficients[2]                       * # gradient</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   gapminder_americas_europe$contDummy</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(gapminder_americas_europe, aes(x = contDummy, y = lifeExp)) +</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     position = "jitter",</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     arrow = arrow(length = unit(0.01, "npc"),ends = "first"),</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       xend = contDummy,</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co">#       yend = t_fit,</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       color = "resid"</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + </span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(aes(</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = -1.9, </span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     xend = -.1, </span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = -1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1],</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     yend = -1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1]),</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     color = "blue"</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) + </span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(aes(</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = 0.1, </span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     xend = 1.9, </span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = 1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1],</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     yend = 1 * continent_ttest$coefficients[2] + continent_ttest$coefficients[1]),</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     color = "blue"</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compare the output of this lm function to an ANOVA function in R to confirm that these are the same thing (i.e.&nbsp;that ANOVA is a general linear model):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(aov(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df), type = "3")</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># temp_model &lt;- lm(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df)</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(temp_model)</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># car::Anova(lm(lifeExp ~ popCategorical + continent + popCategorical:continent, data = anova_df), type = "3")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You’ll see that the 2 x 2 interaction p-values are identical between analyses, but that the individual factors are similar but not identical.</p>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">Regression</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<div class="cell">

</div>
<p>Now lets see how this looks for the above analyses:</p>
</section>
</section>
<section id="simple-regressions-and-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="simple-regressions-and-t-tests">Simple Regressions and t-tests</h2>
<p>As described in more detail in the <a href="../regressions/simpleRegressions.html">simple regression section</a>, the simplest general linear model could be formulated as:</p>
<p><span class="math display">\[
Y = a + bX + e
\]</span></p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>