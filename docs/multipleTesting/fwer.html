<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - Family-Wise Error (R)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document">
 <span class="menu-text">Report an error</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications">
 <span class="menu-text">Request a clarification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content">
 <span class="menu-text">Suggest Content</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Family-Wise Error (R)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Welcome</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">Installing R(Studio)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Statistics Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">Statistics Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">Scientific Notation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/probability.html" class="sidebar-item-text sidebar-link">Probability</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">R Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">Types of Scripts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">R Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">R Logic</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Describing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">Central Tendency (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">Dispersion (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Distributions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/binomial.html" class="sidebar-item-text sidebar-link">Binomial Distribution (R) - incomplete</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">Normal Distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">Skewness (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">Transforming Data (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Correlation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">Correlations (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/partialCorrelations.html" class="sidebar-item-text sidebar-link">Partial Correlations</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Regressions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">Simple regression (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">General Linear Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link">General Linear Models and Sum of Squares</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/TTests.html" class="sidebar-item-text sidebar-link">T-Tests(incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Item analyses</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../itemAnalyses/cronbachsAlpha.html" class="sidebar-item-text sidebar-link">Cronbach’s Alpha (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">Multiple testing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer.html" class="sidebar-item-text sidebar-link active">Family-Wise Error (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fdr.html" class="sidebar-item-text sidebar-link">False Discovery Rate(R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer_vs_fdr.html" class="sidebar-item-text sidebar-link">FWER, FDR, positive and negative effects(R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">Excel tutorial</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/formulas.html" class="sidebar-item-text sidebar-link">Formulas</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/if.html" class="sidebar-item-text sidebar-link">If function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/count.html" class="sidebar-item-text sidebar-link">Count and countifs function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/sum.html" class="sidebar-item-text sidebar-link">Sum and SumIf</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/averageIfs.html" class="sidebar-item-text sidebar-link">Averageifs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/anchoring.html" class="sidebar-item-text sidebar-link">Anchoring</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">Test yourself</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/allQuestions.html" class="sidebar-item-text sidebar-link">All questions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/questionMaker.html" class="sidebar-item-text sidebar-link">Question Maker</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bonferroni-correction" id="toc-bonferroni-correction" class="nav-link active" data-scroll-target="#bonferroni-correction">Bonferroni correction</a></li>
  <li><a href="#family-wise-error-rate-fwer" id="toc-family-wise-error-rate-fwer" class="nav-link" data-scroll-target="#family-wise-error-rate-fwer">Family-wise error rate (FWER)</a></li>
  <li><a href="#šidák-correction" id="toc-šidák-correction" class="nav-link" data-scroll-target="#šidák-correction">Šidák correction</a></li>
  <li><a href="#holm-bonferroni-method" id="toc-holm-bonferroni-method" class="nav-link" data-scroll-target="#holm-bonferroni-method">Holm-Bonferroni method</a></li>
  <li><a href="#holm-šidák-method" id="toc-holm-šidák-method" class="nav-link" data-scroll-target="#holm-šidák-method">Holm-Šidák method</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Family-Wise Error (R)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Click here for a reminder about what positive and negative effects are in the population
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the context of multiple testing we will refer to effects in the population that do exist as <strong>positives</strong>, and effects that don’t exist in the population as <strong>negatives</strong>. This means that a test on a negative effect should ideally you give you a non-significant (negative) result in your sample so that your sample reflects the population (and gives you a <strong>true negative</strong>). Similarly, if an effect in the population exists, ideally your test on your sample will give you a significant result to reflect a <strong>true positive</strong>.</p>
</div>
</div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Alpha threshold of .05 as a default
</div>
</div>
<div class="callout-body-container callout-body">
<p>The page below assumes that the alpha threshold for a false positive is .05, and so some formulas below have been simplified to reflect this convention. However, this <span class="math inline">\(\alpha\)</span> threshold of .05 is not an absolute rule, and so you would need to adapt the relevant formulas below if you decided you wanted to accept a different likelihood of false positives.</p>
</div>
</div>
<p>As mentioned in <a href="statsBasics.html">statistics basics</a>, researchers generally accept a 5% risk of a study reporting a significant finding when the effect found in their sample is not representative of the population (i.e.&nbsp;an <span class="math inline">\(\alpha\)</span> value of .05). However, what happens if you conduct multiple tests within a study? Applying the same <span class="math inline">\(\alpha\)</span> value of .05 to each test within your study becomes a problem of multiple testing increasing the risk of a false positive (unless you happen to only be investigating real effects, which you cannot be sure you are doing). To illustrate the issue, let’s create some random data in which you want to test if there are optimal combinations of <strong>height</strong> and <strong>foot size</strong> that predict <strong>maths ability</strong>. One thing you might be thinking is that this is a meaningless analysis, that there is no optimal height and foot-size in relation to maths ability - and that seems like a sensible opinion. However, without correcting for multiple testing, it’s almost guaranteed that the following analysis <strong>on randomised data</strong> will produce <strong>false-positives</strong>, i.e.&nbsp;identify certain combinations of height and foot-size that are associated with significantly higher or lower mathematics scores.</p>
<p>The analysis below will create 12 heights and 12 shoe sizes, generate 20 participants in each combination with a random score out of 100 in a maths test. Then there will be comparisons between each group and all other participants to identify if their especially good (or bad) at maths (which, again, is a ridiculous thing to believe).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a seed number so that the randomisation won't change with each update of the textbook (if this isn't done, then there is a .95^144 chance that the below example will not work)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>participants_per_condition <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">=</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">21</span> <span class="sc">*</span> <span class="fl">7.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>shoe_sizes <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>maths_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span><span class="fu">rep</span>(heights, <span class="at">each =</span> <span class="fu">length</span>(heights)<span class="sc">*</span> participants_per_condition),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">shoe =</span> <span class="fu">rep</span>(shoe_sizes, <span class="fu">length</span>(shoe_sizes) <span class="sc">*</span> participants_per_condition),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">maths  =</span> <span class="fu">rnorm</span>(participants_per_condition <span class="sc">*</span> <span class="fu">length</span>(shoe_sizes) <span class="sc">*</span> <span class="fu">length</span>(heights), <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Analyses </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
✔ purrr   0.3.5      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>maths_scores <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(height, shoe) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">mean</span>(maths),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(maths),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se   =</span> <span class="fu">sd</span>(maths)<span class="sc">/</span><span class="fu">length</span>(maths),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig  =</span> <span class="st">"no"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"red"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> maths_summarised</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'height'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">05</span>){</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>color[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"blue"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># setting yes and no colors </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>yes_no_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"#005599"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>yes_no_colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(yes_no_colors, <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'

The following object is masked from 'package:ggplot2':

    last_plot

The following object is masked from 'package:stats':

    filter

The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5a9cde28c2d6a7f09a2d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5a9cde28c2d6a7f09a2d">{"x":{"visdat":{"cbd0f514002":["function () ","plotlyVisDat"]},"cur_data":"cbd0f514002","attrs":{"cbd0f514002":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,7,8,9,10,11,13,14,15,4,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,14,15,4,5,6,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.7385791563896,75.8887845267525,77.0313855907168,71.0099314576603,74.0826340793847,72.8573454395648,77.157787390223,78.8914643026599,72.6257721439309,80.3330034802432,79.8284811164344,71.4844352751903,79.5340985540888,74.4193718392534,70.3517955288859,74.5032143583764,76.4148405334097,74.4315147901636,78.7202719238651,75.4237427621403,72.7650618815948,78.2483242842301,70.1806497527142,78.4134453537782,72.6220173153002,78.0257211930983,78.1683134207915,73.2071691819125,73.4729297682844,72.117043175476,69.7977313722539,69.3855290344695,69.8843732808939,73.5963065892318,74.1405111580095,79.2540458801265,72.3275832078852,70.1504527129533,78.7923641574883,69.3182700546353,79.8358548852349,74.806535355425,75.5096493513042,75.484771822848,75.2314323271947,72.2630695605376,81.714815201036,72.69567688446,73.6890614581264,72.5262576295495,70.4337436884626,74.1424051340434,75.2964591207041,76.9755873152605,71.5143223858284,74.2568753063069,74.0208133031811,75.2951302595719,71.9734847206799,72.81581007856,75.3003683759389,73.5469096873477,74.2364885125628,81.5952995838032,79.9755496814827,75.8254213272683,73.8996143408504,78.3615966138525,79.6560879862843,74.7016955629071,76.4632584860904,79.6801660419549,74.1879856306893,74.4340829621389,77.6739953611599,73.2362685588022,77.685243769978,75.8463536896274,78.6678812205851,73.3906324215224,70.0063283031668,73.2158152684318,73.7780070158598,79.0016578318833,67.1308293092393,72.8328024645303,70.3990532221068,75.9960310469288,73.7620849214799,74.5050473362303,73.5467937354408,77.6678265495976,71.9897622076481,75.2162721411937,69.0474672944395,76.6801359559392,68.1329075459476,74.9965710914244,77.7208202454622,74.8627506566865,78.9867236387825,78.4599179510586,76.8083601898603,70.9047091044027,80.8545079724287,70.0923484684888,74.9008954383879,71.3751855279493,77.4537216720972,74.3252986339069,75.8955893175789,79.3347664912116,78.0125058894023,76.3768868472714,76.1325684493683,70.6497748235197,72.8338641223051,77.6518475138595,69.8530742028117,74.3796514636901,76.7852114124903,74.7899024563712,76.5279530387993,76.4840021806908,70.9701929563534,74.4550131577245,76.566990476097,80.5337916050886,80.4704119425577,74.6621048604876,76.2310618774692,74.1200615641089,77.461954587731,71.57190575229,76.9424178629936,70.8196971752966,80.6255564765985,75.8917657489726],"error_z":{"array":[0.757065568517896,0.850490783583791,0.827828974733244,0.819021902951559,0.586926204178824,0.498287825993777,0.641996113976476,0.537392575808674,0.57217456534322,0.942009530906926,0.738228868545141,0.733100785491638,0.943794270716991,0.866861826447057,0.72676116165243,0.648955928668835,0.75340182813216,0.935010794875646,0.745910253525606,0.598167645373541,0.691430848742887,0.859522544855204,0.693842399420648,0.585788982720428,0.666335994217813,0.802574886238765,1.05024917370795,0.622550548942605,1.02397599604438,0.880928110860252,0.834590816092326,0.806748394897525,0.797562464882357,0.83236821497154,0.707058227623365,0.72545670816283,0.775729419378614,0.847271670584427,0.828501324488788,0.633389323357921,0.583589864049985,0.709982470615839,0.79041579677642,0.515494637462108,0.860121788297021,1.0016911639953,0.695911728924148,1.04020562504968,0.907145116765581,0.500981593359733,0.967935176310858,0.744239006582804,0.846203299579808,0.679591105684809,0.807543676932426,0.54549768148474,0.654230304241854,0.941991761134078,0.792354226350498,0.81722130427899,0.567477738043978,0.683020854255807,0.669313648787406,0.827452435882448,0.881016725866354,0.664975949603881,0.746170862218609,0.577260083976373,0.957912071718988,0.589097010149952,1.03384881830808,0.729805957458062,0.671153827394301,0.853391964985563,0.671645345278041,0.639263025588401,0.658683336984846,0.759314294180826,0.648090891866325,0.854859926831619,0.948040021054116,0.646628568644609,0.836270080677213,0.699419298073316,0.880720158315387,0.586345409809237,0.7042065812234,0.904244891605012,0.928624962176059,0.850445099992214,1.01831179035756,0.762758928793802,0.860004688047238,0.924411238016696,0.837416236964036,0.697295000219681,0.716649099449621,0.52438657727531,0.82571196970442,0.825937478927113,0.759355544342307,0.931691931892905,0.9004254257479,0.842064239441281,0.910660694991492,0.713363303395042,0.881977279086356,0.774194212067343,0.711547341954755,0.733254424627024,0.848324840675787,0.574737712880034,0.601959702093333,0.861646158537821,0.605343334511432,0.806834974831722,0.869857557261786,0.610262769733745,0.646890030124836,0.850298028838827,0.744067645727195,0.840977875747666,0.614362779555998,0.834728364170606,0.788685530343856,0.659847752985004,0.794803931885046,0.65885859759182,0.628386597030666,0.615577517815936,0.622976315685502,0.87841148051534,0.921492227057757,0.966022473212067,0.611308844027482,0.886145342644838,0.752170904592155,0.751247978534658]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null},{"x":[97.5,120,120,127.5,135,142.5],"y":[11,6,12,5,13,7],"z":[79.8332421894933,68.1183701380301,65.8642429036722,81.6091370844931,66.9957069186969,81.4772795849036],"error_z":{"array":[0.683846985440372,0.721200469416251,0.633482441450226,0.742634214799255,0.741488267146775,1.00049641744103]},"mode":"markers","type":"scatter3d","name":"yes","marker":{"color":"rgba(0,85,153,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,85,153,1)"}},"textfont":{"color":"rgba(0,85,153,1)","size":55},"error_y":{"color":"rgba(0,85,153,1)","width":55},"error_x":{"color":"rgba(0,85,153,1)","width":55},"line":{"color":"rgba(0,85,153,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>This figure is based on data that is randomly generated, and participants in conditions represented by the blue dots performed significantly worse or better when compared to all other participants. Participants in green dots did not perform significantly better or worse compared to all other participants. Note that some participants in higher groups did not perform <strong>significantly</strong> better than all others because they had a wider range of scores within their group.</em></p>
<p>The above figure shows that with an analysis on <strong>randomised data</strong> there were multiple combinations of foot-size and height that were associated with significantly better or worse performance in the maths task. As this is randomised data, it should illustrate the risk of <strong>multiple testing</strong> <strong>without</strong> <strong>correction.</strong> You may be wondering how likely was it that we would get a false-positive. Assuming that the comparisons you are making are meaningless, the risk of a false positive can be summarised as:</p>
<p><span class="math display">\[
falsePositive_{risk} = (1-\alpha)^{comparisons}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> referring to your accepted risk of a false positive</p></li>
<li><p><span class="math inline">\(comparisons\)</span> referring to the number of comparisons you make</p></li>
</ul>
<p>Now let’s discuss some corrections for multiple testing and see whether they successfully reduce the number of false positives in our hypothetical scenario.</p>
<section id="bonferroni-correction" class="level2">
<h2 class="anchored" data-anchor-id="bonferroni-correction">Bonferroni correction</h2>
<p>A simple correction to avoid the risk of false positives is to divide the <span class="math inline">\(a\)</span> threshold by the number of tests:</p>
<p><span class="math display">\[
\alpha = \frac{.5}{m}
\]</span></p>
<ul>
<li><span class="math inline">\(m\)</span> is the number of comparisons</li>
</ul>
<p>In some ways, this does the job of correcting for false-positives well, as your p-value threshold is directly proportionate to the number of tests you complete. Let’s see if a Bonferroni correction removes all the false-positives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the "sig" column</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>sig <span class="ot">=</span> <span class="st">"no"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>color <span class="ot">=</span> <span class="st">"green"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">=</span> <span class="fu">length</span>(heights) <span class="sc">*</span> <span class="fu">length</span>(shoe_size)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># here is where the new alpha threshold is applied</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">05</span><span class="sc">/</span>comparisons){</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>color[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"blue"</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ce72a1747371cb92581a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ce72a1747371cb92581a">{"x":{"visdat":{"cbd077ad80c6":["function () ","plotlyVisDat"]},"cur_data":"cbd077ad80c6","attrs":{"cbd077ad80c6":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.7385791563896,75.8887845267525,77.0313855907168,71.0099314576603,74.0826340793847,72.8573454395648,77.157787390223,78.8914643026599,72.6257721439309,80.3330034802432,79.8284811164344,71.4844352751903,79.5340985540888,74.4193718392534,70.3517955288859,74.5032143583764,76.4148405334097,74.4315147901636,78.7202719238651,75.4237427621403,72.7650618815948,78.2483242842301,70.1806497527142,78.4134453537782,72.6220173153002,78.0257211930983,78.1683134207915,73.2071691819125,73.4729297682844,72.117043175476,69.7977313722539,69.3855290344695,69.8843732808939,73.5963065892318,74.1405111580095,79.2540458801265,72.3275832078852,70.1504527129533,78.7923641574883,69.3182700546353,79.8358548852349,74.806535355425,75.5096493513042,79.8332421894933,75.484771822848,75.2314323271947,72.2630695605376,81.714815201036,72.69567688446,73.6890614581264,72.5262576295495,70.4337436884626,74.1424051340434,75.2964591207041,76.9755873152605,71.5143223858284,74.2568753063069,74.0208133031811,75.2951302595719,71.9734847206799,72.81581007856,75.3003683759389,73.5469096873477,74.2364885125628,81.5952995838032,79.9755496814827,75.8254213272683,73.8996143408504,78.3615966138525,79.6560879862843,74.7016955629071,76.4632584860904,79.6801660419549,74.1879856306893,68.1183701380301,74.4340829621389,77.6739953611599,73.2362685588022,77.685243769978,75.8463536896274,65.8642429036722,78.6678812205851,73.3906324215224,70.0063283031668,73.2158152684318,81.6091370844931,73.7780070158598,79.0016578318833,67.1308293092393,72.8328024645303,70.3990532221068,75.9960310469288,73.7620849214799,74.5050473362303,73.5467937354408,77.6678265495976,71.9897622076481,75.2162721411937,69.0474672944395,76.6801359559392,68.1329075459476,74.9965710914244,77.7208202454622,74.8627506566865,78.9867236387825,66.9957069186969,78.4599179510586,76.8083601898603,70.9047091044027,80.8545079724287,70.0923484684888,81.4772795849036,74.9008954383879,71.3751855279493,77.4537216720972,74.3252986339069,75.8955893175789,79.3347664912116,78.0125058894023,76.3768868472714,76.1325684493683,70.6497748235197,72.8338641223051,77.6518475138595,69.8530742028117,74.3796514636901,76.7852114124903,74.7899024563712,76.5279530387993,76.4840021806908,70.9701929563534,74.4550131577245,76.566990476097,80.5337916050886,80.4704119425577,74.6621048604876,76.2310618774692,74.1200615641089,77.461954587731,71.57190575229,76.9424178629936,70.8196971752966,80.6255564765985,75.8917657489726],"error_z":{"array":[0.757065568517896,0.850490783583791,0.827828974733244,0.819021902951559,0.586926204178824,0.498287825993777,0.641996113976476,0.537392575808674,0.57217456534322,0.942009530906926,0.738228868545141,0.733100785491638,0.943794270716991,0.866861826447057,0.72676116165243,0.648955928668835,0.75340182813216,0.935010794875646,0.745910253525606,0.598167645373541,0.691430848742887,0.859522544855204,0.693842399420648,0.585788982720428,0.666335994217813,0.802574886238765,1.05024917370795,0.622550548942605,1.02397599604438,0.880928110860252,0.834590816092326,0.806748394897525,0.797562464882357,0.83236821497154,0.707058227623365,0.72545670816283,0.775729419378614,0.847271670584427,0.828501324488788,0.633389323357921,0.583589864049985,0.709982470615839,0.79041579677642,0.515494637462108,0.860121788297021,1.0016911639953,0.695911728924148,1.04020562504968,0.907145116765581,0.500981593359733,0.967935176310858,0.744239006582804,0.846203299579808,0.679591105684809,0.807543676932426,0.54549768148474,0.654230304241854,0.941991761134078,0.792354226350498,0.81722130427899,0.567477738043978,0.683020854255807,0.669313648787406,0.827452435882448,0.881016725866354,0.664975949603881,0.746170862218609,0.577260083976373,0.957912071718988,0.589097010149952,1.03384881830808,0.729805957458062,0.671153827394301,0.853391964985563,0.671645345278041,0.639263025588401,0.658683336984846,0.759314294180826,0.648090891866325,0.854859926831619,0.948040021054116,0.646628568644609,0.836270080677213,0.699419298073316,0.880720158315387,0.586345409809237,0.7042065812234,0.904244891605012,0.928624962176059,0.850445099992214,1.01831179035756,0.762758928793802,0.860004688047238,0.924411238016696,0.837416236964036,0.697295000219681,0.716649099449621,0.52438657727531,0.82571196970442,0.825937478927113,0.759355544342307,0.931691931892905,0.9004254257479,0.842064239441281,0.910660694991492,0.713363303395042,0.881977279086356,0.774194212067343,0.711547341954755,0.733254424627024,0.848324840675787,0.574737712880034,0.601959702093333,0.861646158537821,0.605343334511432,0.806834974831722,0.869857557261786,0.610262769733745,0.646890030124836,0.850298028838827,0.744067645727195,0.840977875747666,0.614362779555998,0.834728364170606,0.788685530343856,0.659847752985004,0.794803931885046,0.65885859759182,0.628386597030666,0.615577517815936,0.622976315685502,0.87841148051534,0.921492227057757,0.966022473212067,0.611308844027482,0.886145342644838,0.752170904592155,0.751247978534658,0.683846985440372,0.721200469416251,0.633482441450226,0.742634214799255,0.741488267146775,1.00049641744103]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>All the points are red above, confirming that there were no false-positives. <strong>However,</strong> this was the new <strong>alpha</strong> value:</p>
<p><span class="math display">\[
\alpha = \frac{.05}{N_{tests}} = \frac{.05}{144} = 0.0003472222
\]</span></p>
<p>Which means that you would need either to be investigating a <a href="../statsBasics/statsBasics.html#what-is-power-and-what-is-the-beta-value">very large effect or testing very many participants</a>. Bonferroni correction is thus very conservative, and increases the risk of a false-negative (incorrectly concluding that there is no effect). There is also an impact on <strong>family-wise error rate</strong> which needs to be explained before you consider other corrections.</p>
</section>
<section id="family-wise-error-rate-fwer" class="level2">
<h2 class="anchored" data-anchor-id="family-wise-error-rate-fwer">Family-wise error rate (FWER)</h2>
<p>If our aim is to reduce the risk of a <strong>study</strong> reporting <strong>at least one</strong> false-positive to 5%, this is the <strong>family-wise error rate (FWER)</strong> and is distinct to the risk of a <strong>single statistical test</strong> giving you a false positive which is the <span class="math inline">\(\alpha\)</span> threshold. Without correcting the for multiple testing the <strong>family-wise</strong> <strong>error rate</strong> would increase with more tests (as shown above). However, some corrections for multiple testing are so conservative that the <strong>family-wise error rate</strong> will drop below 5%.</p>
<p>A problem with <strong>Bonferroni</strong> corrections is that they do not maintain a <strong>family-wise error rate</strong> of .05. The more tests you conduct, the lower the family-wise error rate is. To illustrate this, we first need to calculate the likelihood that there are <strong>not</strong> any false-positives across all tests. For each individual test the likelihood is:</p>
<p><span class="math display">\[
1-\alpha_{bonferroni}
\]</span></p>
<p>If you ran 2 tests, a <strong>Bonferroni</strong> correction means that for each tests there is only a .025 (.05 divided by 2) chance that the test would give a false-positive. So for this example of 2 tests you would get:</p>
<p><span class="math display">\[
1 - .025 = .975
\]</span></p>
<p>A 97.5% chance of avoiding a false positive for one test alone. For each test you run, you multiply this likelihood by itself to calculate the likelihood that <strong>all your tests</strong> are <strong>not false-positives</strong>. So if there are 2 tests:</p>
<p><span class="math display">\[
(1 - .025) * (1 - .025) = .975 * .975 = .950625
\]</span></p>
<p>Or, you could just take the likelihood for any individual test’s false-positive and apply the power of the number of tests, e.g.:</p>
<p><span class="math display">\[
(1-.025)^2 = .975^2 = .950625
\]</span></p>
<p>Or more generally</p>
<p><span class="math display">\[
(1 - \alpha_{bonferroni})^m
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{bonferroni}\)</span> is the <strong>Bonferroni</strong> corrected alpha value</p></li>
<li><p><span class="math inline">\(m\)</span> is still the number of tests</p></li>
</ul>
<p>Now that we have the likelihood of getting no false-positives, we can calculate the <strong>family-wise error rate (FWER)</strong> by subtracting this likelihood from 1:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha_{bonferroni})^m
\]</span></p>
<p>If there are 2 tests, the FWER is:</p>
<p><span class="math display">\[
FWER = 1 - (1 - .05)^2 = 1 - .975^2 = 1 - .950625 = .049375
\]</span></p>
<p>Whilst this is very similar to our original <span class="math inline">\(\alpha\)</span> threshold of .05, it is more conservative because the threshold for a false-positive is stricter (i.e.&nbsp;lower) than .05. Let’s check these out for Šidák and Holm-Bonferroni corrections.</p>
</section>
<section id="šidák-correction" class="level2">
<h2 class="anchored" data-anchor-id="šidák-correction">Šidák correction</h2>
<p>A less conservative correction is Šidák which aims to maintain a <a href="multipleTesting.html#family-wise-error-rate">family-wise error rate</a> across all your tests. If your philosophy is that you only want a 5% chance of a false positive across your whole study, then Šidák’s formula successfully calculates the required <span class="math inline">\(\alpha\)</span> value:</p>
<p><span class="math display">\[
\alpha_{Šidák} = 1 - (1-.05)^{(1/m)}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{Šidák}\)</span> is the Šidák corrected</p></li>
<li><p><span class="math inline">\(.05\)</span> is included as the FWER that this formula aims to achieve. If you wanted a higher or lower FWER you would need to adjust this number in your formula</p></li>
<li><p><span class="math inline">\(m\)</span> is (still) the number of tests you conduct in your study</p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Optional - how do we get Šidák’s formula?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those of you interested in how we get to Šidák’s formula, we use algebra to re-organise the FWER formula above to focus on calculating Alpha rather than FWER:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha)^m
\]</span></p>
<p>Let’s minus 1 from both sides:</p>
<p><span class="math display">\[
FWER - 1 = -(1 - \alpha)^m
\]</span></p>
<p>Then multiply both sides by -1:</p>
<p><span class="math display">\[
1 - FWER = (1 - \alpha)^m
\]</span></p>
<p>Then apply the power of (1/m) to both sides:</p>
<p><span class="math display">\[
(1 - FWER)^{1/m} = 1 - \alpha
\]</span></p>
<p>Followed by adding alpha to both sides:</p>
<p><span class="math display">\[
\alpha + (1 - FWER)^{1/m} = 1
\]</span></p>
<p>Then subtracting <span class="math inline">\((1 - FWER)^{1/m}\)</span> from both sides:</p>
<p><span class="math display">\[
\alpha = 1 - (1 - FWER)^{1/m}
\]</span></p>
<p>Boom, you’re done.</p>
</div>
</div>
<p>Now let’s apply Šidák’s corrected <span class="math inline">\(\alpha\)</span> to the above maths test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the "sig" column</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>sig <span class="ot">=</span> <span class="st">"no"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>color <span class="ot">=</span> <span class="st">"green"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sidak_alpha <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">144</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">=</span> <span class="fu">length</span>(heights) <span class="sc">*</span> <span class="fu">length</span>(shoe_size)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># here is where the new alpha threshold is applied</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> sidak_alpha){</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>color[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"blue"</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8c7589d3814c5cd02bd4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8c7589d3814c5cd02bd4">{"x":{"visdat":{"cbd0ec513ae":["function () ","plotlyVisDat"]},"cur_data":"cbd0ec513ae","attrs":{"cbd0ec513ae":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.7385791563896,75.8887845267525,77.0313855907168,71.0099314576603,74.0826340793847,72.8573454395648,77.157787390223,78.8914643026599,72.6257721439309,80.3330034802432,79.8284811164344,71.4844352751903,79.5340985540888,74.4193718392534,70.3517955288859,74.5032143583764,76.4148405334097,74.4315147901636,78.7202719238651,75.4237427621403,72.7650618815948,78.2483242842301,70.1806497527142,78.4134453537782,72.6220173153002,78.0257211930983,78.1683134207915,73.2071691819125,73.4729297682844,72.117043175476,69.7977313722539,69.3855290344695,69.8843732808939,73.5963065892318,74.1405111580095,79.2540458801265,72.3275832078852,70.1504527129533,78.7923641574883,69.3182700546353,79.8358548852349,74.806535355425,75.5096493513042,79.8332421894933,75.484771822848,75.2314323271947,72.2630695605376,81.714815201036,72.69567688446,73.6890614581264,72.5262576295495,70.4337436884626,74.1424051340434,75.2964591207041,76.9755873152605,71.5143223858284,74.2568753063069,74.0208133031811,75.2951302595719,71.9734847206799,72.81581007856,75.3003683759389,73.5469096873477,74.2364885125628,81.5952995838032,79.9755496814827,75.8254213272683,73.8996143408504,78.3615966138525,79.6560879862843,74.7016955629071,76.4632584860904,79.6801660419549,74.1879856306893,68.1183701380301,74.4340829621389,77.6739953611599,73.2362685588022,77.685243769978,75.8463536896274,65.8642429036722,78.6678812205851,73.3906324215224,70.0063283031668,73.2158152684318,81.6091370844931,73.7780070158598,79.0016578318833,67.1308293092393,72.8328024645303,70.3990532221068,75.9960310469288,73.7620849214799,74.5050473362303,73.5467937354408,77.6678265495976,71.9897622076481,75.2162721411937,69.0474672944395,76.6801359559392,68.1329075459476,74.9965710914244,77.7208202454622,74.8627506566865,78.9867236387825,66.9957069186969,78.4599179510586,76.8083601898603,70.9047091044027,80.8545079724287,70.0923484684888,81.4772795849036,74.9008954383879,71.3751855279493,77.4537216720972,74.3252986339069,75.8955893175789,79.3347664912116,78.0125058894023,76.3768868472714,76.1325684493683,70.6497748235197,72.8338641223051,77.6518475138595,69.8530742028117,74.3796514636901,76.7852114124903,74.7899024563712,76.5279530387993,76.4840021806908,70.9701929563534,74.4550131577245,76.566990476097,80.5337916050886,80.4704119425577,74.6621048604876,76.2310618774692,74.1200615641089,77.461954587731,71.57190575229,76.9424178629936,70.8196971752966,80.6255564765985,75.8917657489726],"error_z":{"array":[0.757065568517896,0.850490783583791,0.827828974733244,0.819021902951559,0.586926204178824,0.498287825993777,0.641996113976476,0.537392575808674,0.57217456534322,0.942009530906926,0.738228868545141,0.733100785491638,0.943794270716991,0.866861826447057,0.72676116165243,0.648955928668835,0.75340182813216,0.935010794875646,0.745910253525606,0.598167645373541,0.691430848742887,0.859522544855204,0.693842399420648,0.585788982720428,0.666335994217813,0.802574886238765,1.05024917370795,0.622550548942605,1.02397599604438,0.880928110860252,0.834590816092326,0.806748394897525,0.797562464882357,0.83236821497154,0.707058227623365,0.72545670816283,0.775729419378614,0.847271670584427,0.828501324488788,0.633389323357921,0.583589864049985,0.709982470615839,0.79041579677642,0.515494637462108,0.860121788297021,1.0016911639953,0.695911728924148,1.04020562504968,0.907145116765581,0.500981593359733,0.967935176310858,0.744239006582804,0.846203299579808,0.679591105684809,0.807543676932426,0.54549768148474,0.654230304241854,0.941991761134078,0.792354226350498,0.81722130427899,0.567477738043978,0.683020854255807,0.669313648787406,0.827452435882448,0.881016725866354,0.664975949603881,0.746170862218609,0.577260083976373,0.957912071718988,0.589097010149952,1.03384881830808,0.729805957458062,0.671153827394301,0.853391964985563,0.671645345278041,0.639263025588401,0.658683336984846,0.759314294180826,0.648090891866325,0.854859926831619,0.948040021054116,0.646628568644609,0.836270080677213,0.699419298073316,0.880720158315387,0.586345409809237,0.7042065812234,0.904244891605012,0.928624962176059,0.850445099992214,1.01831179035756,0.762758928793802,0.860004688047238,0.924411238016696,0.837416236964036,0.697295000219681,0.716649099449621,0.52438657727531,0.82571196970442,0.825937478927113,0.759355544342307,0.931691931892905,0.9004254257479,0.842064239441281,0.910660694991492,0.713363303395042,0.881977279086356,0.774194212067343,0.711547341954755,0.733254424627024,0.848324840675787,0.574737712880034,0.601959702093333,0.861646158537821,0.605343334511432,0.806834974831722,0.869857557261786,0.610262769733745,0.646890030124836,0.850298028838827,0.744067645727195,0.840977875747666,0.614362779555998,0.834728364170606,0.788685530343856,0.659847752985004,0.794803931885046,0.65885859759182,0.628386597030666,0.615577517815936,0.622976315685502,0.87841148051534,0.921492227057757,0.966022473212067,0.611308844027482,0.886145342644838,0.752170904592155,0.751247978534658,0.683846985440372,0.721200469416251,0.633482441450226,0.742634214799255,0.741488267146775,1.00049641744103]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Good news - no false positives 😺. However, the <span class="math inline">\(\alpha\)</span> threshold is simarly conservative as a <strong>Bonferroni</strong> correction:</p>
<ul>
<li><p>Bonferroni: 0.0003472</p></li>
<li><p>Šidák: 0.0003561</p></li>
</ul>
<p>And so both would require unusually strong effects or extremely large sample sizes to detect true-positive results.</p>
</section>
<section id="holm-bonferroni-method" class="level2">
<h2 class="anchored" data-anchor-id="holm-bonferroni-method">Holm-Bonferroni method</h2>
<p>The <strong>Holm-Bonferroni</strong> method orders the p-values from the relevant tests in order of significance, and applies a Bonferroni correction threshold to the most significant results, and gradually reduces the threshold as you proceed through the ranks. To illustrate this, let’s imagine a researcher ran 4 tests, and got the following 4 p-values (already ranked)</p>
<ul>
<li><p><span class="math inline">\(p_1\)</span> = .005</p></li>
<li><p><span class="math inline">\(p_2\)</span> = .0125</p></li>
<li><p><span class="math inline">\(p_3\)</span> = .03</p></li>
<li><p><span class="math inline">\(p_4\)</span> = .049</p></li>
</ul>
<p>If we were to apply a Bonferroni correction, all p-values would need to be less than .05/4 = .0125 to be significant. Considering the fact that all results would be significant with an uncorrected <span class="math inline">\(\alpha\)</span> threshold, it seems that rejecting 3 out of 4 p-values could reflect an overly conservative <span class="math inline">\(\alpha\)</span>. Holm-Bonferroni only compares the most significant result against a <strong>Bonferroni</strong> corrected threshold, and then reduces the denominator by 1 for each comparison made (<span class="math inline">\(k\)</span> below):</p>
<p><span class="math display">\[
\frac{.05}{m + 1 - k}
\]</span></p>
<ul>
<li><p><span class="math inline">\(m\)</span> is the number of tests/comparisons</p></li>
<li><p><span class="math inline">\(k\)</span> is the rank of the current comparison’s p-value (1 for the smallest p-value)</p></li>
</ul>
<p>Let’s apply this formula to each of our 4 p-values:</p>
<ul>
<li><p><span class="math inline">\(p_1\)</span> = .005 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 1) = .0125\)</span> <strong>significant</strong></p></li>
<li><p><span class="math inline">\(p_2\)</span> = .0125 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 2) = .0167\)</span> <strong>significant</strong></p></li>
<li><p><span class="math inline">\(p_3\)</span> = .03 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 3) = .025\)</span> <u><strong><em>not</em></strong></u> <strong>significant</strong></p></li>
</ul>
<p>Once you reach a non-significant result, you stop your comparisons as you’ve identified the p-values that are at too high a risk of a false-positive. To highlight the weirdness of what would happen if you continued:</p>
<ul>
<li><span class="math inline">\(p_4\)</span> = .049 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 4) = .05\)</span> <span style="color:red"><strong>significant!?!?!?!?</strong></span></li>
</ul>
<p>As <span class="math inline">\(p_3\)</span> is more significant than <span class="math inline">\(p_4\)</span> it would be <strong><em>strange</em></strong> to conclude that the finding associated with <span class="math inline">\(p_4\)</span> is significant but <span class="math inline">\(p_3\)</span> isn’t.</p>
<p>An advantage of this approach is that you won’t only capture the most significant result(s) in the way that you would with a <strong>Bonferroni</strong> correction, but the scaling adjustment is (arguably) an acceptable risk to <strong>false-positives</strong> compared to the risk of <strong>false-negatives</strong> for <strong>all</strong> p-values that a <strong>Bonferroni correction</strong> involves.</p>
<p>But what about the <strong>family-wise error rate (FWER)?</strong> Well, remember that <strong>FWER</strong> refers to the risk of <strong><em>at least</em></strong> <strong>one false positive</strong>, so the FWER formula is identical to a Bonferroni correction as the likelihood of the first false positive across all tests is the Bonferroni corrected alpha value:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha_{bonferroni})^m
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Optional - likelihood of a second false-positive?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Whilst FWER is identical for Bonferroni and Holm-Bonferroni corrections, Holm-Bonferroni has a higher risk of getting multiple false-positives. Let’s illustrate this with <a href="../distributions/binomial.html">binomial</a> mathematics, starting with the likelihood of a Bonferroni test’s likelihood of 2 false positives if there are 2 tests:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bonferroni_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both tests are false-positives"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the first test is a false-positive"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the second test is a false-positive"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Neither test is a false-positive"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">first.test =</span> <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">025</span>,.<span class="dv">975</span>,.<span class="dv">975</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">second.test =</span> <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>,.<span class="dv">025</span>,.<span class="dv">975</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>bonferroni_comb<span class="sc">$</span>likelihood <span class="ot">=</span> bonferroni_comb<span class="sc">$</span>first.test <span class="sc">*</span> bonferroni_comb<span class="sc">$</span>second.test</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(bonferroni_comb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 54%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">description</th>
<th style="text-align: right;">first.test</th>
<th style="text-align: right;">second.test</th>
<th style="text-align: right;">likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Both tests are false-positives</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.000625</td>
</tr>
<tr class="even">
<td style="text-align: left;">Only the first test is a false-positive</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.024375</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Only the second test is a false-positive</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.024375</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neither test is a false-positive</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.950625</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bonferroni_comb<span class="sc">$</span>likelihood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>If you add all the likelihoods together you get 1, confirming that we have addressed all outcomes’ likelihoods. The likelihood of 2 false-positives is .0025. We can visualise the above as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"first result p-value"</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"second result p-value"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .<span class="dv">05</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  )   <span class="sc">+</span> </span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">05</span>,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"orange"</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fwer_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The area for each color on the above figure represents the likelihood of its respective outcome:</p>
<ul>
<li><span style="color:red">Red</span>: “Both tests are false-positives”, p = 0.000625, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:green">Green</span>: “Only the first test is a false-positive”, p = 0.024375, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:blue">Blue</span>: “Only the second test is a false-positive”, p = 0.024375, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:orange">Orange</span>: “Neither test is a false-positive”, p = 0.950625, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
</ul>
<p>Let’s now compare the above table to a Bonferroni-Holm methodology. It’s a little more complicated by the fact that there are 2 different p-value thresholds, which makes it more difficult to calculate outcomes that are <a href="../statsBasics/probability.html#mutually-exclusive-outcomes">mutually exclusive</a>. We will try to be precise to avoid making references to overlapping outcomes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bonferroni_holm_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives, but only the first test is &lt;.025"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives, but only the second test is &lt;.025"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives and both &lt; .025"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the first test is a false-positive"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the second test is a false-positive"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Neither test is a false-positive"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">first.test =</span> <span class="fu">c</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY test that it &lt; .025</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of .025 to .05 as ONLY the OTHER test is &lt; .025</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as both tests are &lt; .025</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY false-positive</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">95</span>,  <span class="co"># likelihood of 0 to .95 as the other test is significant</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">975</span>  <span class="co"># likelihood of 0 to .975 as the other test is not significant</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">second.test =</span> <span class="fu">c</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of .025 to .05 as ONLY the OTHER test is &lt; .025</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY test that it &lt; .025</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as both tests are &lt;.025</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">95</span>,  <span class="co"># likelihood of 0 to .025 as it is the ONLY false-positive</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .95 as the other test is significant</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">975</span>  <span class="co"># likelihood of 0 to .975 as the other test is not significant</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>bonferroni_holm_comb<span class="sc">$</span>likelihood <span class="ot">=</span> bonferroni_holm_comb<span class="sc">$</span>first.test <span class="sc">*</span> bonferroni_holm_comb<span class="sc">$</span>second.test</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::kable(bonferroni_holm_comb)</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bonferroni_holm_comb<span class="sc">$</span>likelihood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Looks like we succeeded 😸. Now let’s visualise the above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"First result p-value"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Second result p-value"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">0</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .<span class="dv">025</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">025</span>,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span>,</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.05</span>,</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"purple"</span>,</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  )   <span class="sc">+</span> </span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.0</span>,</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.05</span>,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"brown"</span>,</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.025</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.025</span>,</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"black"</span>,</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fwer_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><span style="color:red">Red</span>: “Both are false positives, but only the first test is &lt;.025”, p = 0.000625, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:green">Green</span>: “Both are false positives, but only the second test is &lt;.025”, p = 0.000625, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:blue">Blue</span>: “Both are false positives and both &lt; .025”, p = 0.024375, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:brown">Brown</span>: “Only the first test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
<li><span style="color:purple">Purple</span>: “Only the second test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
<li><span style="color:grey">Grey</span>: “Neither test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
</ul>
</div>
</div>
</div>
</section>
<section id="holm-šidák-method" class="level2">
<h2 class="anchored" data-anchor-id="holm-šidák-method">Holm-Šidák method</h2>
<p>Combining the principles above, you can apply Holm’s philosophy</p>
<p><span class="math display">\[
\frac{.05}{m + 1 - k}
\]</span></p>
<p>to the Šidák correction:</p>
<p><span class="math display">\[
\alpha_{Šidák} = 1 - (1-.05)^{(1/m)}
\]</span></p>
<p>to get</p>
<p><span class="math display">\[
\alpha_{h-s} = 1 - ( 1 - .05)^{1/(m + 1-k)}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{h-s}\)</span> refers to the Holm-Šidák alpha value</p></li>
<li><p><span class="math inline">\(m\)</span> refers to the number of tests</p></li>
<li><p><span class="math inline">\(k\)</span> refers to the rank of the current test you are calculating the threshold for</p></li>
</ul>
<p>An advantage of using this Holm-Šidák method is that it will maintain a FWER of .05 in the same way that the Šidák method does. This is because the FWER reflects the likelihood of <strong>at least</strong> one false-positive (as described <a href="#holm-bonferroni-method">above</a>), and the Šidák method maintains a FWER of .05.</p>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<p>An alpha value of .05 suggests that 5% of published studies are false-positives?</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>viewof multiple_testing_1_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'True'</span><span class="op">,</span><span class="st">'False'</span>])<span class="op">;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>correct_multiple_testing_1 <span class="op">=</span> <span class="st">'False'</span><span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>multiple_testing_1_result <span class="op">=</span> {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(multiple_testing_1_response <span class="op">==</span> correct_multiple_testing_1){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct! It suggests that 5% of studies that investigate effects that do not exist in the population will find them in the sample. However, if no studies are investigating effects that are real in the population then 100% of published studies would be false positives, even though 95% of studies conducted would be correct negatives.'</span><span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><span><span id="ojs-element-id-1"></span></span></p>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<p>Which correction is more useful for keeping the alpha and FWER rates the same</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>viewof multiple_testing_2_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'Bonferroni'</span><span class="op">,</span><span class="st">'Šidák'</span>])<span class="op">;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>correct_multiple_testing_2 <span class="op">=</span> <span class="st">'Šidák'</span><span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>multiple_testing_2_result <span class="op">=</span> {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(multiple_testing_2_response <span class="op">==</span> correct_multiple_testing_2){</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct!'</span><span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><span><span id="ojs-element-id-2"></span></span></p>


<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${multiple_testing_1_result}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${multiple_testing_2_result}</span>`", "cellName":"ojs-element-id-2"}
]}
</script>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof multiple_testing_1_response = Inputs.radio(['True','False']);\ncorrect_multiple_testing_1 = 'False';\nmultiple_testing_1_result = {\n  if(multiple_testing_1_response == correct_multiple_testing_1){\n    return 'Correct! It suggests that 5% of studies that investigate effects that do not exist in the population will find them in the sample. However, if no studies are investigating effects that are real in the population then 100% of published studies would be false positives, even though 95% of studies conducted would be correct negatives.';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof multiple_testing_2_response = Inputs.radio(['Bonferroni','Šidák']);\ncorrect_multiple_testing_2 = 'Šidák';\nmultiple_testing_2_result = {\n  if(multiple_testing_2_response == correct_multiple_testing_2){\n    return 'Correct!';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('multiple_testing_1_response')"},{"methodName":"interpretQuiet","source":"shinyInput('multiple_testing_2_response')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../multipleTesting";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>