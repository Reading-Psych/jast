<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - Family-Wise Error (R)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document" rel="" target="">
 <span class="menu-text">Report an error</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications" rel="" target="">
 <span class="menu-text">Request a clarification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content" rel="" target="">
 <span class="menu-text">Suggest Content</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../multipleTesting/fwer.html">Multiple testing</a></li><li class="breadcrumb-item"><a href="../multipleTesting/fwer.html">Family-Wise Error (R)</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Welcome</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installing R(Studio)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">R Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Types of Scripts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Logic</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Statistics Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scientific Notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Describing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Central Tendency (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dispersion (R,Python)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binomial Distribution (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normal Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Skewness (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforming Data (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Correlation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlations (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/partialCorrelations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Partial Correlations (R,Python)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/cooksd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cook’s Distance (R, incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Regressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple regression (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regressions (R, incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">General Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Linear Models and Sum of Squares</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/TTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T-Tests(incomplete)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Item analyses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../itemAnalyses/cronbachsAlpha.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cronbach’s Alpha (R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Multiple testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Family-Wise Error (R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fdr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">False Discovery Rate(R)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer_vs_fdr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FWER, FDR, Positive and Negative effects(R)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Excel tutorial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/formulas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Formulas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/if.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">If function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/count.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Count and countifs function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/sum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sum and SumIf</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/averageIfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Averageifs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/anchoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anchoring</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
 <span class="menu-text">Test yourself</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/allQuestions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">All questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/questionMaker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Maker</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#bonferroni-correction" id="toc-bonferroni-correction" class="nav-link active" data-scroll-target="#bonferroni-correction">Bonferroni correction</a></li>
  <li><a href="#family-wise-error-rate-fwer" id="toc-family-wise-error-rate-fwer" class="nav-link" data-scroll-target="#family-wise-error-rate-fwer">Family-wise error rate (FWER)</a></li>
  <li><a href="#šidák-correction" id="toc-šidák-correction" class="nav-link" data-scroll-target="#šidák-correction">Šidák correction</a></li>
  <li><a href="#holm-bonferroni-method" id="toc-holm-bonferroni-method" class="nav-link" data-scroll-target="#holm-bonferroni-method">Holm-Bonferroni method</a></li>
  <li><a href="#holm-šidák-method" id="toc-holm-šidák-method" class="nav-link" data-scroll-target="#holm-šidák-method">Holm-Šidák method</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Family-Wise Error (R)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Course Overview
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-fig-height="5" data-fig-width="10">
<div class="cell-output-display">
<div>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 1718.00 1052.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1048)">
<title>
Course Overview
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1048 1714,-1048 1714,4 -4,4"></polygon> <!-- ancova --> <g id="node1" class="node">
<title>
ancova
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="270,-396 0,-396 0,-324 270,-324 270,-396"></polygon> <text text-anchor="middle" x="135" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">ANCOVA</text> </g> <!-- between_anova --> <g id="node2" class="node">
<title>
between_anova
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="558.11,-396 287.89,-396 287.89,-324 558.11,-324 558.11,-396"></polygon> <text text-anchor="middle" x="423" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Between Subject ANOVA</text> </g> <!-- binomial --> <g id="node3" class="node">
<title>
binomial
</title>
<g id="a_node3"><a href="../distributions/binomial.html" title="Binomial Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="414,-828 144,-828 144,-756 414,-756 414,-828"></polygon> <text text-anchor="middle" x="279" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Binomial Distribution</text> </a> </g> </g> <!-- contingency --> <g id="node4" class="node">
<title>
contingency
</title>
<g id="a_node4"><a href="../categorical/contingency.html" title="Contingency"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="342,-720 72,-720 72,-648 342,-648 342,-720"></polygon> <text text-anchor="middle" x="207" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Contingency</text> </a> </g> </g> <!-- binomial&#45;&gt;contingency --> <g id="edge1" class="edge">
<title>
binomial-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M255.22,-756C247.44,-744.54 238.79,-731.81 231,-720.33"></path> </g> <!-- normal --> <g id="node17" class="node">
<title>
normal
</title>
<g id="a_node17"><a href="../distributions/normal.html" title="Normal Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="846,-720 576,-720 576,-648 846,-648 846,-720"></polygon> <text text-anchor="middle" x="711" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Normal Distribution</text> </a> </g> </g> <!-- binomial&#45;&gt;normal --> <g id="edge2" class="edge">
<title>
binomial-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M414.21,-757.82C465.69,-745.19 524.32,-730.81 575.8,-718.17"></path> </g> <!-- chisquare --> <g id="node6" class="node">
<title>
chisquare
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="270,-612 0,-612 0,-540 270,-540 270,-612"></polygon> <text text-anchor="middle" x="135" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Chi Square</text> </g> <!-- contingency&#45;&gt;chisquare --> <g id="edge3" class="edge">
<title>
contingency-&gt;chisquare
</title>
<path fill="none" stroke="black" stroke-width="5" d="M183.22,-648C175.44,-636.54 166.79,-623.81 159,-612.33"></path> </g> <!-- central_tendency --> <g id="node5" class="node">
<title>
central_tendency
</title>
<g id="a_node5"><a href="../describingData/centralTendency.html" title="Central Tendency"> <polygon fill="white" stroke="#006688" stroke-width="5" points="918,-936 648,-936 648,-864 918,-864 918,-936"></polygon> <text text-anchor="middle" x="783" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Central Tendency</text> </a> </g> </g> <!-- dispersion --> <g id="node9" class="node">
<title>
dispersion
</title>
<g id="a_node9"><a href="../describingData/dispersion.html" title="Dispersion"> <polygon fill="white" stroke="#006688" stroke-width="5" points="846,-828 576,-828 576,-756 846,-756 846,-828"></polygon> <text text-anchor="middle" x="711" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Dispersion</text> </a> </g> </g> <!-- central_tendency&#45;&gt;dispersion --> <g id="edge4" class="edge">
<title>
central_tendency-&gt;dispersion
</title>
<path fill="none" stroke="black" stroke-width="5" d="M759.22,-864C751.44,-852.54 742.79,-839.81 735,-828.33"></path> </g> <!-- cooksd --> <g id="node7" class="node">
<title>
cooksd
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="930,-288 660,-288 660,-216 930,-216 930,-288"></polygon> <text text-anchor="middle" x="795" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Cook’s D</text> </g> <!-- correlations --> <g id="node8" class="node">
<title>
correlations
</title>
<g id="a_node8"><a href="../distributions/correlations.html" title="Correlations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1218,-396 948,-396 948,-324 1218,-324 1218,-396"></polygon> <text text-anchor="middle" x="1083" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Correlations</text> </a> </g> </g> <!-- correlations&#45;&gt;cooksd --> <g id="edge5" class="edge">
<title>
correlations-&gt;cooksd
</title>
<path fill="none" stroke="black" stroke-width="5" d="M987.9,-324C956.61,-312.48 921.82,-299.68 890.49,-288.15"></path> </g> <!-- partial_correlations --> <g id="node18" class="node">
<title>
partial_correlations
</title>
<g id="a_node18"><a href="../correlations/partialCorrelations.html" title="Partial Correlations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1218,-288 948,-288 948,-216 1218,-216 1218,-288"></polygon> <text text-anchor="middle" x="1083" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Partial Correlations</text> </a> </g> </g> <!-- correlations&#45;&gt;partial_correlations --> <g id="edge6" class="edge">
<title>
correlations-&gt;partial_correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1083,-324C1083,-312.54 1083,-299.81 1083,-288.33"></path> </g> <!-- simple_regression --> <g id="node22" class="node">
<title>
simple_regression
</title>
<g id="a_node22"><a href="../regressions/simpleRegressions.html" title="Simple Regression"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1506,-288 1236,-288 1236,-216 1506,-216 1506,-288"></polygon> <text text-anchor="middle" x="1371" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Simple Regression</text> </a> </g> </g> <!-- correlations&#45;&gt;simple_regression --> <g id="edge7" class="edge">
<title>
correlations-&gt;simple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1178.1,-324C1209.39,-312.48 1244.18,-299.68 1275.51,-288.15"></path> </g> <!-- dispersion&#45;&gt;normal --> <g id="edge8" class="edge">
<title>
dispersion-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M711,-756C711,-744.54 711,-731.81 711,-720.33"></path> </g> <!-- fdr --> <g id="node10" class="node">
<title>
fdr
</title>
<g id="a_node10"><a href="../multipleTesting/fdr.html" title="False Discovery Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1422,-828 1152,-828 1152,-756 1422,-756 1422,-828"></polygon> <text text-anchor="middle" x="1287" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">False Discovery Rate</text> </a> </g> </g> <!-- fwer_vs_fdr --> <g id="node12" class="node">
<title>
fwer_vs_fdr
</title>
<g id="a_node12"><a href="../multipleTesting/fwer_vs_fdr.html" title="FWER vs. FDR"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1566,-720 1296,-720 1296,-648 1566,-648 1566,-720"></polygon> <text text-anchor="middle" x="1431" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">FWER vs.&nbsp;FDR</text> </a> </g> </g> <!-- fdr&#45;&gt;fwer_vs_fdr --> <g id="edge9" class="edge">
<title>
fdr-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1334.55,-756C1350.12,-744.54 1367.41,-731.81 1383.01,-720.33"></path> </g> <!-- fwer --> <g id="node11" class="node">
<title>
fwer
</title>
<g id="a_node11"><a href="../multipleTesting/fwer.html" title="Family-Wise Error Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1710,-828 1440,-828 1440,-756 1710,-756 1710,-828"></polygon> <text text-anchor="middle" x="1575" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Family-Wise Error Rate</text> </a> </g> </g> <!-- fwer&#45;&gt;fwer_vs_fdr --> <g id="edge10" class="edge">
<title>
fwer-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1527.45,-756C1511.88,-744.54 1494.59,-731.81 1478.99,-720.33"></path> </g> <!-- glm --> <g id="node13" class="node">
<title>
glm
</title>
<g id="a_node13"><a href="../GeneralLinearModels/generalLinearModels.html" title="General Linear Models"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="558,-612 288,-612 288,-540 558,-540 558,-612"></polygon> <text text-anchor="middle" x="423" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">General Linear Models</text> </a> </g> </g> <!-- ttests --> <g id="node26" class="node">
<title>
ttests
</title>
<g id="a_node26"><a href="../GeneralLinearModels/TTests.html" title="T-Tests"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="558,-504 288,-504 288,-432 558,-432 558,-504"></polygon> <text text-anchor="middle" x="423" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">T-Tests</text> </a> </g> </g> <!-- glm&#45;&gt;ttests --> <g id="edge11" class="edge">
<title>
glm-&gt;ttests
</title>
<path fill="none" stroke="black" stroke-width="5" d="M423,-540C423,-528.54 423,-515.81 423,-504.33"></path> </g> <!-- kurtosis --> <g id="node14" class="node">
<title>
kurtosis
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="846,-612 576,-612 576,-540 846,-540 846,-612"></polygon> <text text-anchor="middle" x="711" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Kurtosis</text> </g> <!-- mediation --> <g id="node15" class="node">
<title>
mediation
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="1506,-72 1236,-72 1236,0 1506,0 1506,-72"></polygon> <text text-anchor="middle" x="1371" y="-28.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Mediation</text> </g> <!-- multiple_regression --> <g id="node16" class="node">
<title>
multiple_regression
</title>
<g id="a_node16"><a href="../regressions/multipleRegressions.html" title="Multiple Regression"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="1506,-180 1236,-180 1236,-108 1506,-108 1506,-180"></polygon> <text text-anchor="middle" x="1371" y="-136.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Multiple Regression</text> </a> </g> </g> <!-- multiple_regression&#45;&gt;mediation --> <g id="edge12" class="edge">
<title>
multiple_regression-&gt;mediation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1371,-108C1371,-96.54 1371,-83.81 1371,-72.33"></path> </g> <!-- normal&#45;&gt;correlations --> <g id="edge13" class="edge">
<title>
normal-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M846.13,-678.94C957.99,-672.43 1104.58,-655.58 1143,-612 1195.91,-551.97 1175.7,-506.7 1147,-432 1141.94,-418.83 1133.19,-406.58 1123.75,-396.09"></path> </g> <!-- normal&#45;&gt;glm --> <g id="edge14" class="edge">
<title>
normal-&gt;glm
</title>
<path fill="none" stroke="black" stroke-width="5" d="M615.9,-648C584.61,-636.48 549.82,-623.68 518.49,-612.15"></path> </g> <!-- normal&#45;&gt;kurtosis --> <g id="edge15" class="edge">
<title>
normal-&gt;kurtosis
</title>
<path fill="none" stroke="black" stroke-width="5" d="M711,-648C711,-636.54 711,-623.81 711,-612.33"></path> </g> <!-- skewness --> <g id="node23" class="node">
<title>
skewness
</title>
<g id="a_node23"><a href="../distributions/skewness.html" title="Skewness"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1134,-612 864,-612 864,-540 1134,-540 1134,-612"></polygon> <text text-anchor="middle" x="999" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Skewness</text> </a> </g> </g> <!-- normal&#45;&gt;skewness --> <g id="edge16" class="edge">
<title>
normal-&gt;skewness
</title>
<path fill="none" stroke="black" stroke-width="5" d="M806.1,-648C837.39,-636.48 872.18,-623.68 903.51,-612.15"></path> </g> <!-- permutation --> <g id="node19" class="node">
<title>
permutation
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="1422,-1044 1152,-1044 1152,-972 1422,-972 1422,-1044"></polygon> <text text-anchor="middle" x="1287" y="-1000.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Permutations</text> </g> <!-- probability --> <g id="node20" class="node">
<title>
probability
</title>
<g id="a_node20"><a href="../statsBasics/probability.html" title="Probability"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1350,-936 1080,-936 1080,-864 1350,-864 1350,-936"></polygon> <text text-anchor="middle" x="1215" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Probability</text> </a> </g> </g> <!-- probability&#45;&gt;fdr --> <g id="edge21" class="edge">
<title>
probability-&gt;fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1238.78,-864C1246.56,-852.54 1255.21,-839.81 1263,-828.33"></path> </g> <!-- probability&#45;&gt;fwer --> <g id="edge20" class="edge">
<title>
probability-&gt;fwer
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1333.88,-864C1373.1,-852.45 1416.71,-839.61 1455.94,-828.06"></path> </g> <!-- nonparametric --> <g id="node27" class="node">
<title>
nonparametric
</title>
<polygon fill="white" stroke="black" stroke-width="5" points="1134,-828 864,-828 864,-756 1134,-756 1134,-828"></polygon> <text text-anchor="middle" x="999" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">nonparametric</text> </g> <!-- probability&#45;&gt;nonparametric --> <g id="edge22" class="edge">
<title>
probability-&gt;nonparametric
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1143.67,-864C1120.2,-852.48 1094.11,-839.68 1070.62,-828.15"></path> </g> <!-- repeated_measures_anova --> <g id="node21" class="node">
<title>
repeated_measures_anova
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="846,-396 576,-396 576,-324 846,-324 846,-396"></polygon> <text text-anchor="middle" x="711" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Within Subject ANOVA</text> </g> <!-- simple_regression&#45;&gt;multiple_regression --> <g id="edge17" class="edge">
<title>
simple_regression-&gt;multiple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1371,-216C1371,-204.54 1371,-191.81 1371,-180.33"></path> </g> <!-- transforming --> <g id="node25" class="node">
<title>
transforming
</title>
<g id="a_node25"><a href="../distributions/transforming.html" title="Transforming Data"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1138,-504 850,-504 850,-432 1138,-432 1138,-504"></polygon> <text text-anchor="middle" x="994" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Transforming Data</text> </a> </g> </g> <!-- skewness&#45;&gt;transforming --> <g id="edge18" class="edge">
<title>
skewness-&gt;transforming
</title>
<path fill="none" stroke="black" stroke-width="5" d="M997.35,-540C996.81,-528.54 996.21,-515.81 995.67,-504.33"></path> </g> <!-- stats_basics --> <g id="node24" class="node">
<title>
stats_basics
</title>
<g id="a_node24"><a href="../statsBasics/statsBasics.html" title="Statistics Basics"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1134,-1044 864,-1044 864,-972 1134,-972 1134,-1044"></polygon> <text text-anchor="middle" x="999" y="-1000.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Statistics Basics</text> </a> </g> </g> <!-- stats_basics&#45;&gt;central_tendency --> <g id="edge23" class="edge">
<title>
stats_basics-&gt;central_tendency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M927.67,-972C904.2,-960.48 878.11,-947.68 854.62,-936.15"></path> </g> <!-- stats_basics&#45;&gt;probability --> <g id="edge24" class="edge">
<title>
stats_basics-&gt;probability
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1070.33,-972C1093.8,-960.48 1119.89,-947.68 1143.38,-936.15"></path> </g> <!-- transforming&#45;&gt;correlations --> <g id="edge19" class="edge">
<title>
transforming-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1023.39,-432C1033.01,-420.54 1043.7,-407.81 1053.34,-396.33"></path> </g> <!-- ttests&#45;&gt;ancova --> <g id="edge25" class="edge">
<title>
ttests-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M327.9,-432C296.61,-420.48 261.82,-407.68 230.49,-396.15"></path> </g> <!-- ttests&#45;&gt;between_anova --> <g id="edge26" class="edge">
<title>
ttests-&gt;between_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M423,-432C423,-420.54 423,-407.81 423,-396.33"></path> </g> <!-- ttests&#45;&gt;repeated_measures_anova --> <g id="edge27" class="edge">
<title>
ttests-&gt;repeated_measures_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M518.1,-432C549.39,-420.48 584.18,-407.68 615.51,-396.15"></path> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p><span style="color:red"><strong>Red</strong></span> means that the page does not exist yet</p>
<p><span style="color:orange"><strong>Orange</strong></span> means that the page is started</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click here for a reminder about what positive and negative effects are in the population
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the context of multiple testing we will refer to effects in the population that do exist as <strong>positives</strong>, and effects that don’t exist in the population as <strong>negatives</strong>. This means that a test on a negative effect should ideally you give you a non-significant (negative) result in your sample so that your sample reflects the population (and gives you a <strong>true negative</strong>). Similarly, if an effect in the population exists, ideally your test on your sample will give you a significant result to reflect a <strong>true positive</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alpha threshold of .05 as a default
</div>
</div>
<div class="callout-body-container callout-body">
<p>The page below assumes that the alpha threshold for a false positive is .05, and so some formulas below have been simplified to reflect this convention. However, this <span class="math inline">\(\alpha\)</span> threshold of .05 is not an absolute rule, and so you would need to adapt the relevant formulas below if you decided you wanted to accept a different likelihood of false positives.</p>
</div>
</div>
<p>As mentioned in <a href="statsBasics.html">statistics basics</a>, researchers generally accept a 5% risk of a study reporting a significant finding when the effect found in their sample is not representative of the population (i.e.&nbsp;an <span class="math inline">\(\alpha\)</span> value of .05). However, what happens if you conduct multiple tests within a study? Applying the same <span class="math inline">\(\alpha\)</span> value of .05 to each test within your study becomes a problem of multiple testing increasing the risk of a false positive (unless you happen to only be investigating real effects, which you cannot be sure you are doing). To illustrate the issue, let’s create some random data in which you want to test if there are optimal combinations of <strong>height</strong> and <strong>foot size</strong> that predict <strong>maths ability</strong>. One thing you might be thinking is that this is a meaningless analysis, that there is no optimal height and foot-size in relation to maths ability - and that seems like a sensible opinion. However, without correcting for multiple testing, it’s almost guaranteed that the following analysis <strong>on randomised data</strong> will produce <strong>false-positives</strong>, i.e.&nbsp;identify certain combinations of height and foot-size that are associated with significantly higher or lower mathematics scores.</p>
<p>The analysis below will create 12 heights and 12 shoe sizes, generate 20 participants in each combination with a random score out of 100 in a maths test. Then there will be comparisons between each group and all other participants to identify if their especially good (or bad) at maths (which, again, is a ridiculous thing to believe).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a seed number so that the randomisation won't change with each update of the textbook (if this isn't done, then there is a .95^144 chance that the below example will not work)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>participants_per_condition <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>heights <span class="ot">=</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">21</span> <span class="sc">*</span> <span class="fl">7.5</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>shoe_sizes <span class="ot">=</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>maths_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span><span class="fu">rep</span>(heights, <span class="at">each =</span> <span class="fu">length</span>(heights)<span class="sc">*</span> participants_per_condition),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">shoe =</span> <span class="fu">rep</span>(shoe_sizes, <span class="fu">length</span>(shoe_sizes) <span class="sc">*</span> participants_per_condition),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">maths  =</span> <span class="fu">rnorm</span>(participants_per_condition <span class="sc">*</span> <span class="fu">length</span>(shoe_sizes) <span class="sc">*</span> <span class="fu">length</span>(heights), <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Analyses </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.2     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>maths_scores <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(height, shoe) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">mean</span>(maths),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(maths),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se   =</span> <span class="fu">sd</span>(maths)<span class="sc">/</span><span class="fu">length</span>(maths),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig  =</span> <span class="st">"no"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="st">"red"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> maths_summarised</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'height'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">05</span>){</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>color[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"blue"</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># setting yes and no colors </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>yes_no_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"#005599"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>yes_no_colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(yes_no_colors, <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-fwer-uncorrected-prop-false-pos" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5a9cde28c2d6a7f09a2d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5a9cde28c2d6a7f09a2d">{"x":{"visdat":{"11c0840382e6f":["function () ","plotlyVisDat"]},"cur_data":"11c0840382e6f","attrs":{"11c0840382e6f":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,7,8,9,10,11,13,14,15,4,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,14,15,4,5,6,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.738579156389605,75.88878452675246,77.031385590716781,71.009931457660329,74.082634079384661,72.857345439564767,77.157787390222992,78.891464302659898,72.625772143930931,80.333003480243249,79.828481116434403,71.484435275190265,79.534098554088757,74.419371839253444,70.351795528885916,74.503214358376383,76.414840533409659,74.431514790163646,78.720271923865141,75.423742762140336,72.765061881594804,78.248324284230122,70.180649752714189,78.413445353778201,72.622017315300198,78.025721193098335,78.168313420791534,73.207169181912462,73.47292976828443,72.117043175475956,69.797731372253892,69.385529034469471,69.884373280893925,73.596306589231759,74.140511158009502,79.254045880126512,72.327583207885198,70.150452712953324,78.792364157488336,69.318270054635292,79.83585488523488,74.806535355425041,75.509649351304176,75.484771822848032,75.231432327194696,72.263069560537588,81.714815201035989,72.695676884460013,73.689061458126432,72.526257629549519,70.433743688462599,74.142405134043429,75.296459120704114,76.975587315260512,71.514322385828379,74.256875306306938,74.020813303181072,75.295130259571934,71.973484720679863,72.815810078559963,75.30036837593893,73.54690968734775,74.236488512562829,81.595299583803154,79.97554968148269,75.825421327268273,73.899614340850363,78.361596613852456,79.656087986284305,74.701695562907062,76.463258486090425,79.680166041954877,74.187985630689269,74.434082962138945,77.673995361159925,73.236268558802195,77.685243769977959,75.846353689627392,78.667881220585116,73.39063242152244,70.006328303166825,73.215815268431754,73.778007015859842,79.001657831883335,67.130829309239317,72.832802464530346,70.399053222106772,75.996031046928763,73.762084921479911,74.505047336230291,73.546793735440829,77.667826549597592,71.989762207648141,75.216272141193741,69.047467294439542,76.680135955939249,68.13290754594756,74.996571091424414,77.720820245462207,74.862750656686458,78.986723638782536,78.4599179510586,76.808360189860309,70.904709104402713,80.854507972428692,70.09234846848878,74.900895438387892,71.375185527949313,77.453721672097188,74.325298633906939,75.895589317578867,79.334766491211624,78.01250588940232,76.376886847271365,76.13256844936825,70.649774823519692,72.833864122305087,77.651847513859479,69.853074202811655,74.379651463690095,76.78521141249027,74.789902456371237,76.527953038799339,76.484002180690837,70.970192956353358,74.455013157724522,76.566990476097033,80.533791605088581,80.470411942557746,74.662104860487574,76.231061877469202,74.120061564108866,77.461954587731014,71.571905752290036,76.942417862993622,70.819697175296568,80.625556476598476,75.891765748972645],"error_z":{"array":[0.7570655685178963,0.85049078358379082,0.82782897473324368,0.81902190295155908,0.58692620417882391,0.49828782599377702,0.64199611397647627,0.53739257580867394,0.57217456534321998,0.94200953090692585,0.73822886854514091,0.73310078549163804,0.94379427071699096,0.86686182644705723,0.72676116165242999,0.64895592866883489,0.75340182813216017,0.93501079487564631,0.74591025352560569,0.59816764537354139,0.69143084874288718,0.85952254485520396,0.69384239942064796,0.58578898272042834,0.66633599421781264,0.80257488623876472,1.0502491737079471,0.62255054894260453,1.0239759960443828,0.88092811086025224,0.83459081609232633,0.80674839489752492,0.79756246488235683,0.83236821497154023,0.70705822762336468,0.72545670816282959,0.77572941937861373,0.84727167058442721,0.82850132448878766,0.63338932335792131,0.58358986404998547,0.70998247061583897,0.79041579677641993,0.51549463746210833,0.86012178829702113,1.0016911639953008,0.69591172892414799,1.0402056250496767,0.90714511676558141,0.50098159335973302,0.96793517631085846,0.74423900658280362,0.84620329957980811,0.67959110568480863,0.80754367693242557,0.54549768148474009,0.6542303042418538,0.94199176113407757,0.79235422635049824,0.81722130427899042,0.56747773804397794,0.68302085425580705,0.66931364878740585,0.82745243588244777,0.88101672586635382,0.66497594960388118,0.74617086221860929,0.57726008397637296,0.95791207171898773,0.58909701014995197,1.0338488183080756,0.72980595745806198,0.67115382739430096,0.85339196498556336,0.67164534527804132,0.63926302558840109,0.65868333698484571,0.75931429418082641,0.64809089186632485,0.85485992683161915,0.94804002105411622,0.64662856864460916,0.8362700806772132,0.6994192980733156,0.88072015831538653,0.58634540980923666,0.70420658122340041,0.90424489160501165,0.9286249621760595,0.85044509999221352,1.0183117903575578,0.76275892879380169,0.86000468804723751,0.92441123801669645,0.83741623696403644,0.69729500021968072,0.71664909944962052,0.52438657727530991,0.82571196970441973,0.825937478927113,0.75935554434230723,0.93169193189290511,0.90042542574789997,0.84206423944128106,0.91066069499149249,0.7133633033950415,0.88197727908635648,0.77419421206734285,0.71154734195475522,0.73325442462702406,0.84832484067578695,0.57473771288003417,0.60195970209333338,0.86164615853782112,0.60534333451143196,0.80683497483172206,0.86985755726178604,0.61026276973374516,0.64689003012483592,0.85029802883882721,0.74406764572719497,0.84097787574766636,0.61436277955599761,0.83472836417060614,0.78868553034385613,0.65984775298500353,0.79480393188504583,0.65885859759182019,0.62838659703066635,0.61557751781593573,0.62297631568550238,0.87841148051534046,0.92149222705775746,0.96602247321206725,0.61130884402748153,0.88614534264483813,0.75217090459215474,0.75124797853465808]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null},{"x":[97.5,120,120,127.5,135,142.5],"y":[11,6,12,5,13,7],"z":[79.833242189493305,68.118370138030073,65.864242903672192,81.609137084493142,66.995706918696911,81.477279584903641],"error_z":{"array":[0.68384698544037248,0.72120046941625082,0.63348244145022625,0.74263421479925495,0.74148826714677507,1.0004964174410342]},"mode":"markers","type":"scatter3d","name":"yes","marker":{"color":"rgba(0,85,153,1)","size":[55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,85,153,1)"}},"textfont":{"color":"rgba(0,85,153,1)","size":55},"error_y":{"color":"rgba(0,85,153,1)","width":55},"error_x":{"color":"rgba(0,85,153,1)","width":55},"line":{"color":"rgba(0,85,153,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<figcaption class="figure-caption">Figure&nbsp;1: Visualisation of an analysis on whether height and shoe size predict mathematic scores. Note that all data is randomly generated. The participants have been grouped based on heights and show sizes and then compared to all other participants using t-tests to see if their maths score is significantly higher or lower than all other participants. Groups represented by the blue dots performed significantly worse or better when compared to all other participants. Groups in red dots did not perform significantly better or worse compared to all other participants. Note that some higher groups did not perform significantly better than all others because they had a wider range of scores within their group, thus increasing their standard error.</figcaption>
</figure>
</div>
</div>
<p>The above figure shows that with an analysis on <strong>randomised data</strong> there were multiple combinations of foot-size and height that were associated with significantly better or worse performance in the maths task. As this is randomised data, it should illustrate the risk of <strong>multiple testing</strong> <strong>without</strong> <strong>correction.</strong> You may be wondering how likely was it that we would get a false-positive. Assuming that the comparisons you are making are meaningless, the risk of a false positive can be summarised as:</p>
<p><span class="math display">\[
falsePositive_{risk} = (1-\alpha)^{comparisons}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha\)</span> referring to your accepted risk of a false positive</p></li>
<li><p><span class="math inline">\(comparisons\)</span> referring to the number of comparisons you make</p></li>
</ul>
<p>Now let’s discuss some corrections for multiple testing and see whether they successfully reduce the number of false positives in our hypothetical scenario.</p>
<section id="bonferroni-correction" class="level2">
<h2 class="anchored" data-anchor-id="bonferroni-correction">Bonferroni correction</h2>
<p>A simple correction to avoid the risk of false positives is to divide the <span class="math inline">\(a\)</span> threshold by the number of tests:</p>
<p><span class="math display">\[
\alpha = \frac{.5}{m}
\]</span></p>
<ul>
<li><span class="math inline">\(m\)</span> is the number of comparisons</li>
</ul>
<p>In some ways, this does the job of correcting for false-positives well, as your p-value threshold is directly proportionate to the number of tests you complete. Let’s see if a Bonferroni correction removes all the false-positives:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the "sig" column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>sig <span class="ot">=</span> <span class="st">"no"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">=</span> <span class="fu">length</span>(heights) <span class="sc">*</span> <span class="fu">length</span>(shoe_size)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># here is where the new alpha threshold is applied</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">05</span><span class="sc">/</span>comparisons){</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-fwer-bonferroni-corrected-prop-false-pos" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ce72a1747371cb92581a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ce72a1747371cb92581a">{"x":{"visdat":{"11c0830b139f5":["function () ","plotlyVisDat"]},"cur_data":"11c0830b139f5","attrs":{"11c0830b139f5":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.738579156389605,75.88878452675246,77.031385590716781,71.009931457660329,74.082634079384661,72.857345439564767,77.157787390222992,78.891464302659898,72.625772143930931,80.333003480243249,79.828481116434403,71.484435275190265,79.534098554088757,74.419371839253444,70.351795528885916,74.503214358376383,76.414840533409659,74.431514790163646,78.720271923865141,75.423742762140336,72.765061881594804,78.248324284230122,70.180649752714189,78.413445353778201,72.622017315300198,78.025721193098335,78.168313420791534,73.207169181912462,73.47292976828443,72.117043175475956,69.797731372253892,69.385529034469471,69.884373280893925,73.596306589231759,74.140511158009502,79.254045880126512,72.327583207885198,70.150452712953324,78.792364157488336,69.318270054635292,79.83585488523488,74.806535355425041,75.509649351304176,79.833242189493305,75.484771822848032,75.231432327194696,72.263069560537588,81.714815201035989,72.695676884460013,73.689061458126432,72.526257629549519,70.433743688462599,74.142405134043429,75.296459120704114,76.975587315260512,71.514322385828379,74.256875306306938,74.020813303181072,75.295130259571934,71.973484720679863,72.815810078559963,75.30036837593893,73.54690968734775,74.236488512562829,81.595299583803154,79.97554968148269,75.825421327268273,73.899614340850363,78.361596613852456,79.656087986284305,74.701695562907062,76.463258486090425,79.680166041954877,74.187985630689269,68.118370138030073,74.434082962138945,77.673995361159925,73.236268558802195,77.685243769977959,75.846353689627392,65.864242903672192,78.667881220585116,73.39063242152244,70.006328303166825,73.215815268431754,81.609137084493142,73.778007015859842,79.001657831883335,67.130829309239317,72.832802464530346,70.399053222106772,75.996031046928763,73.762084921479911,74.505047336230291,73.546793735440829,77.667826549597592,71.989762207648141,75.216272141193741,69.047467294439542,76.680135955939249,68.13290754594756,74.996571091424414,77.720820245462207,74.862750656686458,78.986723638782536,66.995706918696911,78.4599179510586,76.808360189860309,70.904709104402713,80.854507972428692,70.09234846848878,81.477279584903641,74.900895438387892,71.375185527949313,77.453721672097188,74.325298633906939,75.895589317578867,79.334766491211624,78.01250588940232,76.376886847271365,76.13256844936825,70.649774823519692,72.833864122305087,77.651847513859479,69.853074202811655,74.379651463690095,76.78521141249027,74.789902456371237,76.527953038799339,76.484002180690837,70.970192956353358,74.455013157724522,76.566990476097033,80.533791605088581,80.470411942557746,74.662104860487574,76.231061877469202,74.120061564108866,77.461954587731014,71.571905752290036,76.942417862993622,70.819697175296568,80.625556476598476,75.891765748972645],"error_z":{"array":[0.7570655685178963,0.85049078358379082,0.82782897473324368,0.81902190295155908,0.58692620417882391,0.49828782599377702,0.64199611397647627,0.53739257580867394,0.57217456534321998,0.94200953090692585,0.73822886854514091,0.73310078549163804,0.94379427071699096,0.86686182644705723,0.72676116165242999,0.64895592866883489,0.75340182813216017,0.93501079487564631,0.74591025352560569,0.59816764537354139,0.69143084874288718,0.85952254485520396,0.69384239942064796,0.58578898272042834,0.66633599421781264,0.80257488623876472,1.0502491737079471,0.62255054894260453,1.0239759960443828,0.88092811086025224,0.83459081609232633,0.80674839489752492,0.79756246488235683,0.83236821497154023,0.70705822762336468,0.72545670816282959,0.77572941937861373,0.84727167058442721,0.82850132448878766,0.63338932335792131,0.58358986404998547,0.70998247061583897,0.79041579677641993,0.51549463746210833,0.86012178829702113,1.0016911639953008,0.69591172892414799,1.0402056250496767,0.90714511676558141,0.50098159335973302,0.96793517631085846,0.74423900658280362,0.84620329957980811,0.67959110568480863,0.80754367693242557,0.54549768148474009,0.6542303042418538,0.94199176113407757,0.79235422635049824,0.81722130427899042,0.56747773804397794,0.68302085425580705,0.66931364878740585,0.82745243588244777,0.88101672586635382,0.66497594960388118,0.74617086221860929,0.57726008397637296,0.95791207171898773,0.58909701014995197,1.0338488183080756,0.72980595745806198,0.67115382739430096,0.85339196498556336,0.67164534527804132,0.63926302558840109,0.65868333698484571,0.75931429418082641,0.64809089186632485,0.85485992683161915,0.94804002105411622,0.64662856864460916,0.8362700806772132,0.6994192980733156,0.88072015831538653,0.58634540980923666,0.70420658122340041,0.90424489160501165,0.9286249621760595,0.85044509999221352,1.0183117903575578,0.76275892879380169,0.86000468804723751,0.92441123801669645,0.83741623696403644,0.69729500021968072,0.71664909944962052,0.52438657727530991,0.82571196970441973,0.825937478927113,0.75935554434230723,0.93169193189290511,0.90042542574789997,0.84206423944128106,0.91066069499149249,0.7133633033950415,0.88197727908635648,0.77419421206734285,0.71154734195475522,0.73325442462702406,0.84832484067578695,0.57473771288003417,0.60195970209333338,0.86164615853782112,0.60534333451143196,0.80683497483172206,0.86985755726178604,0.61026276973374516,0.64689003012483592,0.85029802883882721,0.74406764572719497,0.84097787574766636,0.61436277955599761,0.83472836417060614,0.78868553034385613,0.65984775298500353,0.79480393188504583,0.65885859759182019,0.62838659703066635,0.61557751781593573,0.62297631568550238,0.87841148051534046,0.92149222705775746,0.96602247321206725,0.61130884402748153,0.88614534264483813,0.75217090459215474,0.75124797853465808,0.68384698544037248,0.72120046941625082,0.63348244145022625,0.74263421479925495,0.74148826714677507,1.0004964174410342]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<figcaption class="figure-caption">Figure&nbsp;2: Same visualisation as above, but this time the alpha threshold has a bonferroni correction.</figcaption>
</figure>
</div>
</div>
<p>All the points are red above, confirming that there were no false-positives. <strong>However,</strong> this was the new <strong>alpha</strong> value:</p>
<p><span class="math display">\[
\alpha = \frac{.05}{N_{tests}} = \frac{.05}{144} = 0.0003472222
\]</span></p>
<p>Which means that you would need either to be investigating a <a href="../statsBasics/statsBasics.html#what-is-power-and-what-is-the-beta-value">very large effect or testing very many participants</a>. Bonferroni correction is thus very conservative, and increases the risk of a false-negative (incorrectly concluding that there is no effect). There is also an impact on <strong>family-wise error rate</strong> which needs to be explained before you consider other corrections.</p>
</section>
<section id="family-wise-error-rate-fwer" class="level2">
<h2 class="anchored" data-anchor-id="family-wise-error-rate-fwer">Family-wise error rate (FWER)</h2>
<p>If our aim is to reduce the risk of a <strong>study</strong> reporting <strong>at least one</strong> false-positive to 5%, this is the <strong>family-wise error rate (FWER)</strong> and is distinct to the risk of a <strong>single statistical test</strong> giving you a false positive which is the <span class="math inline">\(\alpha\)</span> threshold. Without correcting the for multiple testing the <strong>family-wise</strong> <strong>error rate</strong> would increase with more tests (as shown above). However, some corrections for multiple testing are so conservative that the <strong>family-wise error rate</strong> will drop below 5%.</p>
<p>A problem with <strong>Bonferroni</strong> corrections is that they do not maintain a <strong>family-wise error rate</strong> of .05. The more tests you conduct, the lower the family-wise error rate is. To illustrate this, we first need to calculate the likelihood that there are <strong>not</strong> any false-positives across all tests. For each individual test the likelihood is:</p>
<p><span class="math display">\[
1-\alpha_{bonferroni}
\]</span></p>
<p>If you ran 2 tests, a <strong>Bonferroni</strong> correction means that for each tests there is only a .025 (.05 divided by 2) chance that the test would give a false-positive. So for this example of 2 tests you would get:</p>
<p><span class="math display">\[
1 - .025 = .975
\]</span></p>
<p>A 97.5% chance of avoiding a false positive for one test alone. For each test you run, you multiply this likelihood by itself to calculate the likelihood that <strong>all your tests</strong> are <strong>not false-positives</strong>. So if there are 2 tests:</p>
<p><span class="math display">\[
(1 - .025) * (1 - .025) = .975 * .975 = .950625
\]</span></p>
<p>Or, you could just take the likelihood for any individual test’s false-positive and apply the power of the number of tests, e.g.:</p>
<p><span class="math display">\[
(1-.025)^2 = .975^2 = .950625
\]</span></p>
<p>Or more generally</p>
<p><span class="math display">\[
(1 - \alpha_{bonferroni})^m
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{bonferroni}\)</span> is the <strong>Bonferroni</strong> corrected alpha value</p></li>
<li><p><span class="math inline">\(m\)</span> is still the number of tests</p></li>
</ul>
<p>Now that we have the likelihood of getting no false-positives, we can calculate the <strong>family-wise error rate (FWER)</strong> by subtracting this likelihood from 1:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha_{bonferroni})^m
\]</span></p>
<p>If there are 2 tests, the FWER is:</p>
<p><span class="math display">\[
FWER = 1 - (1 - .05)^2 = 1 - .975^2 = 1 - .950625 = .049375
\]</span></p>
<p>Whilst this is very similar to our original <span class="math inline">\(\alpha\)</span> threshold of .05, it is more conservative because the threshold for a false-positive is stricter (i.e.&nbsp;lower) than .05. Let’s check these out for Šidák and Holm-Bonferroni corrections.</p>
</section>
<section id="šidák-correction" class="level2">
<h2 class="anchored" data-anchor-id="šidák-correction">Šidák correction</h2>
<p>A less conservative correction is Šidák which aims to maintain a <a href="multipleTesting.html#family-wise-error-rate">family-wise error rate</a> across all your tests. If your philosophy is that you only want a 5% chance of a false positive across your whole study, then Šidák’s formula successfully calculates the required <span class="math inline">\(\alpha\)</span> value:</p>
<p><span class="math display">\[
\alpha_{Šidák} = 1 - (1-.05)^{(1/m)}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{Šidák}\)</span> is the Šidák corrected</p></li>
<li><p><span class="math inline">\(.05\)</span> is included as the FWER that this formula aims to achieve. If you wanted a higher or lower FWER you would need to adjust this number in your formula</p></li>
<li><p><span class="math inline">\(m\)</span> is (still) the number of tests you conduct in your study</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional - how do we get Šidák’s formula?
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those of you interested in how we get to Šidák’s formula, we use algebra to re-organise the FWER formula above to focus on calculating Alpha rather than FWER:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha)^m
\]</span></p>
<p>Let’s minus 1 from both sides:</p>
<p><span class="math display">\[
FWER - 1 = -(1 - \alpha)^m
\]</span></p>
<p>Then multiply both sides by -1:</p>
<p><span class="math display">\[
1 - FWER = (1 - \alpha)^m
\]</span></p>
<p>Then apply the power of (1/m) to both sides:</p>
<p><span class="math display">\[
(1 - FWER)^{1/m} = 1 - \alpha
\]</span></p>
<p>Followed by adding alpha to both sides:</p>
<p><span class="math display">\[
\alpha + (1 - FWER)^{1/m} = 1
\]</span></p>
<p>Then subtracting <span class="math inline">\((1 - FWER)^{1/m}\)</span> from both sides:</p>
<p><span class="math display">\[
\alpha = 1 - (1 - FWER)^{1/m}
\]</span></p>
<p>Boom, you’re done.</p>
</div>
</div>
<p>Now let’s apply Šidák’s corrected <span class="math inline">\(\alpha\)</span> to the above maths test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the "sig" column</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>maths_summarised<span class="sc">$</span>sig <span class="ot">=</span> <span class="st">"no"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sidak_alpha <span class="ot">=</span>  <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">05</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">144</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>comparisons <span class="ot">=</span> <span class="fu">length</span>(heights) <span class="sc">*</span> <span class="fu">length</span>(shoe_size)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(height <span class="cf">in</span> heights){</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(shoe_size <span class="cf">in</span> shoe_sizes){</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    exp_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    con_group_scores <span class="ot">=</span> maths_scores<span class="sc">$</span>maths[maths_scores<span class="sc">$</span>height <span class="sc">!=</span> height <span class="sc">&amp;</span> maths_scores<span class="sc">$</span>shoe <span class="sc">!=</span> shoe_size]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    this_t.test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(exp_group_scores, con_group_scores)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># here is where the new alpha threshold is applied</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_t.test<span class="sc">$</span>p.value <span class="sc">&lt;</span> sidak_alpha){</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      maths_summarised<span class="sc">$</span>sig[maths_summarised<span class="sc">$</span>height <span class="sc">==</span> height <span class="sc">&amp;</span> maths_summarised<span class="sc">$</span>shoe <span class="sc">==</span> shoe_size] <span class="ot">=</span> <span class="st">"yes"</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> maths_summarised, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="sc">~</span>height, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="sc">~</span>shoe,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span><span class="sc">~</span>score, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>sig, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">error_z =</span> <span class="fu">list</span>(<span class="at">array=</span><span class="sc">~</span>se), </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> yes_no_colors</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-fwer-Šidák-corrected-prop-false-pos" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8c7589d3814c5cd02bd4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8c7589d3814c5cd02bd4">{"x":{"visdat":{"11c084c188746":["function () ","plotlyVisDat"]},"cur_data":"11c084c188746","attrs":{"11c084c188746":{"x":{},"y":{},"z":{},"error_z":{"array":{}},"mode":"markers","color":{},"size":1,"colors":["red","#005599"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"height"},"yaxis":{"title":"shoe"},"zaxis":{"title":"score"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[75,75,75,75,75,75,75,75,75,75,75,75,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,82.5,90,90,90,90,90,90,90,90,90,90,90,90,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,97.5,105,105,105,105,105,105,105,105,105,105,105,105,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,112.5,120,120,120,120,120,120,120,120,120,120,120,120,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,127.5,135,135,135,135,135,135,135,135,135,135,135,135,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,142.5,150,150,150,150,150,150,150,150,150,150,150,150,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5,157.5],"y":[4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15,4,5,6,7,8,9,10,11,12,13,14,15],"z":[72.738579156389605,75.88878452675246,77.031385590716781,71.009931457660329,74.082634079384661,72.857345439564767,77.157787390222992,78.891464302659898,72.625772143930931,80.333003480243249,79.828481116434403,71.484435275190265,79.534098554088757,74.419371839253444,70.351795528885916,74.503214358376383,76.414840533409659,74.431514790163646,78.720271923865141,75.423742762140336,72.765061881594804,78.248324284230122,70.180649752714189,78.413445353778201,72.622017315300198,78.025721193098335,78.168313420791534,73.207169181912462,73.47292976828443,72.117043175475956,69.797731372253892,69.385529034469471,69.884373280893925,73.596306589231759,74.140511158009502,79.254045880126512,72.327583207885198,70.150452712953324,78.792364157488336,69.318270054635292,79.83585488523488,74.806535355425041,75.509649351304176,79.833242189493305,75.484771822848032,75.231432327194696,72.263069560537588,81.714815201035989,72.695676884460013,73.689061458126432,72.526257629549519,70.433743688462599,74.142405134043429,75.296459120704114,76.975587315260512,71.514322385828379,74.256875306306938,74.020813303181072,75.295130259571934,71.973484720679863,72.815810078559963,75.30036837593893,73.54690968734775,74.236488512562829,81.595299583803154,79.97554968148269,75.825421327268273,73.899614340850363,78.361596613852456,79.656087986284305,74.701695562907062,76.463258486090425,79.680166041954877,74.187985630689269,68.118370138030073,74.434082962138945,77.673995361159925,73.236268558802195,77.685243769977959,75.846353689627392,65.864242903672192,78.667881220585116,73.39063242152244,70.006328303166825,73.215815268431754,81.609137084493142,73.778007015859842,79.001657831883335,67.130829309239317,72.832802464530346,70.399053222106772,75.996031046928763,73.762084921479911,74.505047336230291,73.546793735440829,77.667826549597592,71.989762207648141,75.216272141193741,69.047467294439542,76.680135955939249,68.13290754594756,74.996571091424414,77.720820245462207,74.862750656686458,78.986723638782536,66.995706918696911,78.4599179510586,76.808360189860309,70.904709104402713,80.854507972428692,70.09234846848878,81.477279584903641,74.900895438387892,71.375185527949313,77.453721672097188,74.325298633906939,75.895589317578867,79.334766491211624,78.01250588940232,76.376886847271365,76.13256844936825,70.649774823519692,72.833864122305087,77.651847513859479,69.853074202811655,74.379651463690095,76.78521141249027,74.789902456371237,76.527953038799339,76.484002180690837,70.970192956353358,74.455013157724522,76.566990476097033,80.533791605088581,80.470411942557746,74.662104860487574,76.231061877469202,74.120061564108866,77.461954587731014,71.571905752290036,76.942417862993622,70.819697175296568,80.625556476598476,75.891765748972645],"error_z":{"array":[0.7570655685178963,0.85049078358379082,0.82782897473324368,0.81902190295155908,0.58692620417882391,0.49828782599377702,0.64199611397647627,0.53739257580867394,0.57217456534321998,0.94200953090692585,0.73822886854514091,0.73310078549163804,0.94379427071699096,0.86686182644705723,0.72676116165242999,0.64895592866883489,0.75340182813216017,0.93501079487564631,0.74591025352560569,0.59816764537354139,0.69143084874288718,0.85952254485520396,0.69384239942064796,0.58578898272042834,0.66633599421781264,0.80257488623876472,1.0502491737079471,0.62255054894260453,1.0239759960443828,0.88092811086025224,0.83459081609232633,0.80674839489752492,0.79756246488235683,0.83236821497154023,0.70705822762336468,0.72545670816282959,0.77572941937861373,0.84727167058442721,0.82850132448878766,0.63338932335792131,0.58358986404998547,0.70998247061583897,0.79041579677641993,0.51549463746210833,0.86012178829702113,1.0016911639953008,0.69591172892414799,1.0402056250496767,0.90714511676558141,0.50098159335973302,0.96793517631085846,0.74423900658280362,0.84620329957980811,0.67959110568480863,0.80754367693242557,0.54549768148474009,0.6542303042418538,0.94199176113407757,0.79235422635049824,0.81722130427899042,0.56747773804397794,0.68302085425580705,0.66931364878740585,0.82745243588244777,0.88101672586635382,0.66497594960388118,0.74617086221860929,0.57726008397637296,0.95791207171898773,0.58909701014995197,1.0338488183080756,0.72980595745806198,0.67115382739430096,0.85339196498556336,0.67164534527804132,0.63926302558840109,0.65868333698484571,0.75931429418082641,0.64809089186632485,0.85485992683161915,0.94804002105411622,0.64662856864460916,0.8362700806772132,0.6994192980733156,0.88072015831538653,0.58634540980923666,0.70420658122340041,0.90424489160501165,0.9286249621760595,0.85044509999221352,1.0183117903575578,0.76275892879380169,0.86000468804723751,0.92441123801669645,0.83741623696403644,0.69729500021968072,0.71664909944962052,0.52438657727530991,0.82571196970441973,0.825937478927113,0.75935554434230723,0.93169193189290511,0.90042542574789997,0.84206423944128106,0.91066069499149249,0.7133633033950415,0.88197727908635648,0.77419421206734285,0.71154734195475522,0.73325442462702406,0.84832484067578695,0.57473771288003417,0.60195970209333338,0.86164615853782112,0.60534333451143196,0.80683497483172206,0.86985755726178604,0.61026276973374516,0.64689003012483592,0.85029802883882721,0.74406764572719497,0.84097787574766636,0.61436277955599761,0.83472836417060614,0.78868553034385613,0.65984775298500353,0.79480393188504583,0.65885859759182019,0.62838659703066635,0.61557751781593573,0.62297631568550238,0.87841148051534046,0.92149222705775746,0.96602247321206725,0.61130884402748153,0.88614534264483813,0.75217090459215474,0.75124797853465808,0.68384698544037248,0.72120046941625082,0.63348244145022625,0.74263421479925495,0.74148826714677507,1.0004964174410342]},"mode":"markers","type":"scatter3d","name":"no","marker":{"color":"rgba(255,0,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<figcaption class="figure-caption">Figure&nbsp;3: Same visualisation as above, but this time the alpha threshold has a Šidák correction.</figcaption>
</figure>
</div>
</div>
<p>Good news - no false positives 😺. However, the <span class="math inline">\(\alpha\)</span> threshold is simarly conservative as a <strong>Bonferroni</strong> correction:</p>
<ul>
<li><p>Bonferroni: 0.0003472</p></li>
<li><p>Šidák: 0.0003561</p></li>
</ul>
<p>And so both would require unusually strong effects or extremely large sample sizes to detect true-positive results.</p>
</section>
<section id="holm-bonferroni-method" class="level2">
<h2 class="anchored" data-anchor-id="holm-bonferroni-method">Holm-Bonferroni method</h2>
<p>The <strong>Holm-Bonferroni</strong> method orders the p-values from the relevant tests in order of significance, and applies a Bonferroni correction threshold to the most significant results, and gradually reduces the threshold as you proceed through the ranks. To illustrate this, let’s imagine a researcher ran 4 tests, and got the following 4 p-values (already ranked)</p>
<ul>
<li><p><span class="math inline">\(p_1\)</span> = .005</p></li>
<li><p><span class="math inline">\(p_2\)</span> = .0125</p></li>
<li><p><span class="math inline">\(p_3\)</span> = .03</p></li>
<li><p><span class="math inline">\(p_4\)</span> = .049</p></li>
</ul>
<p>If we were to apply a Bonferroni correction, all p-values would need to be less than .05/4 = .0125 to be significant. Considering the fact that all results would be significant with an uncorrected <span class="math inline">\(\alpha\)</span> threshold, it seems that rejecting 3 out of 4 p-values could reflect an overly conservative <span class="math inline">\(\alpha\)</span>. Holm-Bonferroni only compares the most significant result against a <strong>Bonferroni</strong> corrected threshold, and then reduces the denominator by 1 for each comparison made (<span class="math inline">\(k\)</span> below):</p>
<p><span class="math display">\[
\frac{.05}{m + 1 - k}
\]</span></p>
<ul>
<li><p><span class="math inline">\(m\)</span> is the number of tests/comparisons</p></li>
<li><p><span class="math inline">\(k\)</span> is the rank of the current comparison’s p-value (1 for the smallest p-value)</p></li>
</ul>
<p>Let’s apply this formula to each of our 4 p-values:</p>
<ul>
<li><p><span class="math inline">\(p_1\)</span> = .005 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 1) = .0125\)</span> <strong>significant</strong></p></li>
<li><p><span class="math inline">\(p_2\)</span> = .0125 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 2) = .0167\)</span> <strong>significant</strong></p></li>
<li><p><span class="math inline">\(p_3\)</span> = .03 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 3) = .025\)</span> <u><strong><em>not</em></strong></u> <strong>significant</strong></p></li>
</ul>
<p>Once you reach a non-significant result, you stop your comparisons as you’ve identified the p-values that are at too high a risk of a false-positive. To highlight the weirdness of what would happen if you continued:</p>
<ul>
<li><span class="math inline">\(p_4\)</span> = .049 compared to the threshold of <span class="math inline">\(.05/(4 + 1 - 4) = .05\)</span> <span style="color:red"><strong>significant!?!?!?!?</strong></span></li>
</ul>
<p>As <span class="math inline">\(p_3\)</span> is more significant than <span class="math inline">\(p_4\)</span> it would be <strong><em>strange</em></strong> to conclude that the finding associated with <span class="math inline">\(p_4\)</span> is significant but <span class="math inline">\(p_3\)</span> isn’t.</p>
<p>An advantage of this approach is that you won’t only capture the most significant result(s) in the way that you would with a <strong>Bonferroni</strong> correction, but the scaling adjustment is (arguably) an acceptable risk to <strong>false-positives</strong> compared to the risk of <strong>false-negatives</strong> for <strong>all</strong> p-values that a <strong>Bonferroni correction</strong> involves.</p>
<p>But what about the <strong>family-wise error rate (FWER)?</strong> Well, remember that <strong>FWER</strong> refers to the risk of <strong><em>at least</em></strong> <strong>one false positive</strong>, so the FWER formula is identical to a Bonferroni correction as the likelihood of the first false positive across all tests is the Bonferroni corrected alpha value:</p>
<p><span class="math display">\[
FWER = 1 - (1 - \alpha_{bonferroni})^m
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional - likelihood of a second false-positive?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Whilst FWER is identical for Bonferroni and Holm-Bonferroni corrections, Holm-Bonferroni has a higher risk of getting multiple false-positives. Let’s illustrate this with <a href="../distributions/binomial.html">binomial</a> mathematics, starting with the likelihood of a Bonferroni test’s likelihood of 2 false positives if there are 2 tests:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>bonferroni_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both tests are false-positives"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the first test is a false-positive"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the second test is a false-positive"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Neither test is a false-positive"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">first.test =</span> <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">025</span>,.<span class="dv">975</span>,.<span class="dv">975</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">second.test =</span> <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>,.<span class="dv">025</span>,.<span class="dv">975</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>bonferroni_comb<span class="sc">$</span>likelihood <span class="ot">=</span> bonferroni_comb<span class="sc">$</span>first.test <span class="sc">*</span> bonferroni_comb<span class="sc">$</span>second.test</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(bonferroni_comb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 54%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">description</th>
<th style="text-align: right;">first.test</th>
<th style="text-align: right;">second.test</th>
<th style="text-align: right;">likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Both tests are false-positives</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.000625</td>
</tr>
<tr class="even">
<td style="text-align: left;">Only the first test is a false-positive</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.024375</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Only the second test is a false-positive</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.024375</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neither test is a false-positive</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.950625</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bonferroni_comb<span class="sc">$</span>likelihood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>If you add all the likelihoods together you get 1, confirming that we have addressed all outcomes’ likelihoods. The likelihood of 2 false-positives is .0025. We can visualise the above as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"first result p-value"</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"second result p-value"</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .<span class="dv">05</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  )   <span class="sc">+</span> </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">05</span>,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"orange"</span>,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fwer_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The area for each color on the above figure represents the likelihood of its respective outcome:</p>
<ul>
<li><span style="color:red">Red</span>: “Both tests are false-positives”, p = 0.000625, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:green">Green</span>: “Only the first test is a false-positive”, p = 0.024375, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:blue">Blue</span>: “Only the second test is a false-positive”, p = 0.024375, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:orange">Orange</span>: “Neither test is a false-positive”, p = 0.950625, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
</ul>
<p>Let’s now compare the above table to a Bonferroni-Holm methodology. It’s a little more complicated by the fact that there are 2 different p-value thresholds, which makes it more difficult to calculate outcomes that are <a href="../statsBasics/probability.html#mutually-exclusive-outcomes">mutually exclusive</a>. We will try to be precise to avoid making references to overlapping outcomes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bonferroni_holm_comb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives, but only the first test is &lt;.025"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives, but only the second test is &lt;.025"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Both are false positives and both &lt; .025"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the first test is a false-positive"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Only the second test is a false-positive"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Neither test is a false-positive"</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">first.test =</span> <span class="fu">c</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY test that it &lt; .025</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of .025 to .05 as ONLY the OTHER test is &lt; .025</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as both tests are &lt; .025</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY false-positive</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">95</span>,  <span class="co"># likelihood of 0 to .95 as the other test is significant</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">975</span>  <span class="co"># likelihood of 0 to .975 as the other test is not significant</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">second.test =</span> <span class="fu">c</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of .025 to .05 as ONLY the OTHER test is &lt; .025</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as it is the ONLY test that it &lt; .025</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .025 as both tests are &lt;.025</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">95</span>,  <span class="co"># likelihood of 0 to .025 as it is the ONLY false-positive</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">025</span>, <span class="co"># likelihood of 0 to .95 as the other test is significant</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">975</span>  <span class="co"># likelihood of 0 to .975 as the other test is not significant</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>bonferroni_holm_comb<span class="sc">$</span>likelihood <span class="ot">=</span> bonferroni_holm_comb<span class="sc">$</span>first.test <span class="sc">*</span> bonferroni_holm_comb<span class="sc">$</span>second.test</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::kable(bonferroni_holm_comb)</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(bonferroni_holm_comb<span class="sc">$</span>likelihood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Looks like we succeeded 😸. Now let’s visualise the above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"First result p-value"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Second result p-value"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">0</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"blue"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> .<span class="dv">025</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">05</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> .<span class="dv">025</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">05</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.05</span>,</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> .<span class="dv">025</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"purple"</span>,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  )   <span class="sc">+</span> </span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.0</span>,</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> .<span class="dv">025</span>,</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.05</span>,</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"brown"</span>,</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.025</span>,</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">0.025</span>,</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">1</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"black"</span>,</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fwer_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><span style="color:red">Red</span>: “Both are false positives, but only the first test is &lt;.025”, p = 0.000625, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:green">Green</span>: “Both are false positives, but only the second test is &lt;.025”, p = 0.000625, i.e.&nbsp;takes 0.024375 of the total area of the above figure</li>
<li><span style="color:blue">Blue</span>: “Both are false positives and both &lt; .025”, p = 0.024375, i.e.&nbsp;takes 0.000625 of the total area of the above figure</li>
<li><span style="color:brown">Brown</span>: “Only the first test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
<li><span style="color:purple">Purple</span>: “Only the second test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
<li><span style="color:grey">Grey</span>: “Neither test is a false-positive”, p = 0.02375, i.e.&nbsp;takes 0.950625 of the total area of the above figure</li>
</ul>
</div>
</div>
</div>
</section>
<section id="holm-šidák-method" class="level2">
<h2 class="anchored" data-anchor-id="holm-šidák-method">Holm-Šidák method</h2>
<p>Combining the principles above, you can apply Holm’s philosophy</p>
<p><span class="math display">\[
\frac{.05}{m + 1 - k}
\]</span></p>
<p>to the Šidák correction:</p>
<p><span class="math display">\[
\alpha_{Šidák} = 1 - (1-.05)^{(1/m)}
\]</span></p>
<p>to get</p>
<p><span class="math display">\[
\alpha_{h-s} = 1 - ( 1 - .05)^{1/(m + 1-k)}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\alpha_{h-s}\)</span> refers to the Holm-Šidák alpha value</p></li>
<li><p><span class="math inline">\(m\)</span> refers to the number of tests</p></li>
<li><p><span class="math inline">\(k\)</span> refers to the rank of the current test you are calculating the threshold for</p></li>
</ul>
<p>An advantage of using this Holm-Šidák method is that it will maintain a FWER of .05 in the same way that the Šidák method does. This is because the FWER reflects the likelihood of <strong>at least</strong> one false-positive (as described <a href="#holm-bonferroni-method">above</a>), and the Šidák method maintains a FWER of .05.</p>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<p>An alpha value of .05 suggests that 5% of published studies are false-positives?</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>viewof fwer1_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'True'</span><span class="op">,</span><span class="st">'False'</span>])<span class="op">;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>correct_fwer1 <span class="op">=</span> <span class="st">'False'</span><span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>fwer_1color <span class="op">=</span> {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fwer1_response <span class="op">==</span> correct_fwer1){</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'blue'</span><span class="op">;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'red'</span><span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  }   </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>fwer1_result <span class="op">=</span> {</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fwer1_response <span class="op">==</span> correct_fwer1){</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct! It suggests that 5% of studies that investigate effects that do not exist in the population will find them in the sample. However, if no studies are investigating effects that are real in the population then 100% of published studies would be false positives, even though 95% of studies conducted would be correct negatives.'</span><span class="op">;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><strong><span><span id="ojs-element-id-1"></span></span></strong></p>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<p>Which correction is more useful for keeping the alpha and FWER rates the same</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>viewof fwer2_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'Bonferroni'</span><span class="op">,</span><span class="st">'Šidák'</span>])<span class="op">;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>correct_fwer2 <span class="op">=</span> <span class="st">'Šidák'</span><span class="op">;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fwer2_result <span class="op">=</span> {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fwer2_response <span class="op">==</span> correct_fwer2){</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct!'</span><span class="op">;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><strong><span><span id="ojs-element-id-2"></span></span></strong></p>


<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${fwer1_result}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${fwer2_result}</span>`", "cellName":"ojs-element-id-2"}
]}
</script>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof fwer1_response = Inputs.radio(['True','False']);\ncorrect_fwer1 = 'False';\nfwer_1color = {\n  if(fwer1_response == correct_fwer1){\n    return 'blue';\n  } else {\n    return 'red';\n  }   \n}\nfwer1_result = {\n  if(fwer1_response == correct_fwer1){\n    return 'Correct! It suggests that 5% of studies that investigate effects that do not exist in the population will find them in the sample. However, if no studies are investigating effects that are real in the population then 100% of published studies would be false positives, even though 95% of studies conducted would be correct negatives.';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof fwer2_response = Inputs.radio(['Bonferroni','Šidák']);\ncorrect_fwer2 = 'Šidák';\nfwer2_result = {\n  if(fwer2_response == correct_fwer2){\n    return 'Correct!';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('fwer1_response')"},{"methodName":"interpretQuiet","source":"shinyInput('fwer2_response')"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../multipleTesting";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>