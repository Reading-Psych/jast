<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Just Another Statistics Textbook - Permutations (R)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo/logo.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo/logo.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Just Another Statistics Textbook</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/possible-errors-in-the-document">
 <span class="menu-text">Report an error</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/requests-for-clarifications">
 <span class="menu-text">Request a clarification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Reading-Psych/jast/discussions/categories/suggest-content">
 <span class="menu-text">Suggest Content</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Permutations (R)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Welcome</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../installing.html" class="sidebar-item-text sidebar-link">Installing R(Studio)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">R Basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/filetypes.html" class="sidebar-item-text sidebar-link">Types of Scripts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/fundamentals.html" class="sidebar-item-text sidebar-link">R Fundamentals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rBasics/logic.html" class="sidebar-item-text sidebar-link">R Logic</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Statistics Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/statsBasics.html" class="sidebar-item-text sidebar-link">Statistics Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/eNumbers.html" class="sidebar-item-text sidebar-link">Scientific Notation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statsBasics/probability.html" class="sidebar-item-text sidebar-link">Probability (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Describing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/centralTendency.html" class="sidebar-item-text sidebar-link">Central Tendency (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../describingData/dispersion.html" class="sidebar-item-text sidebar-link">Dispersion (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Distributions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/binomial.html" class="sidebar-item-text sidebar-link">Binomial Distribution (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/normal.html" class="sidebar-item-text sidebar-link">Normal Distribution</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/skewness.html" class="sidebar-item-text sidebar-link">Skewness (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../distributions/transforming.html" class="sidebar-item-text sidebar-link">Transforming Data (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Correlation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/correlations.html" class="sidebar-item-text sidebar-link">Correlations (R,Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../correlations/partialCorrelations.html" class="sidebar-item-text sidebar-link">Partial Correlations (R,Python)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Regressions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/simpleRegressions.html" class="sidebar-item-text sidebar-link">Simple regression (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regressions/multipleRegressions.html" class="sidebar-item-text sidebar-link">Multiple Regressions (R, incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">General Linear Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/generalLinearModels.html" class="sidebar-item-text sidebar-link">General Linear Models and Sum of Squares (R, Python)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/TTests.html" class="sidebar-item-text sidebar-link">T-Tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/oneWayAnova.html" class="sidebar-item-text sidebar-link">One Way ANOVA (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/repeatedAnova.html" class="sidebar-item-text sidebar-link">Repeated Measures ANOVAs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/mixedAnova.html" class="sidebar-item-text sidebar-link">Mixed ANOVA (incomplete)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GeneralLinearModels/ancova.html" class="sidebar-item-text sidebar-link">ANCOVA (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Categorical</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../categorical/contingency.html" class="sidebar-item-text sidebar-link">Contingency (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">Item analyses</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../itemAnalyses/cronbachsAlpha.html" class="sidebar-item-text sidebar-link">Cronbach’s Alpha (R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">Multiple testing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer.html" class="sidebar-item-text sidebar-link">Family-Wise Error (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fdr.html" class="sidebar-item-text sidebar-link">False Discovery Rate(R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../multipleTesting/fwer_vs_fdr.html" class="sidebar-item-text sidebar-link">FWER, FDR, Positive and Negative effects(R)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">Permutations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permutations.html" class="sidebar-item-text sidebar-link active">Permutations (R)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permVsTtest.html" class="sidebar-item-text sidebar-link">Permutation vs.&nbsp;t tests (incomplete)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">Excel tutorial</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/formulas.html" class="sidebar-item-text sidebar-link">Formulas</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/if.html" class="sidebar-item-text sidebar-link">If function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/count.html" class="sidebar-item-text sidebar-link">Count and countifs function</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/sum.html" class="sidebar-item-text sidebar-link">Sum and SumIf</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/averageIfs.html" class="sidebar-item-text sidebar-link">Averageifs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../excelIntro/anchoring.html" class="sidebar-item-text sidebar-link">Anchoring</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">Test yourself</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/allQuestions.html" class="sidebar-item-text sidebar-link">All questions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extras/questionMaker.html" class="sidebar-item-text sidebar-link">Question Maker</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#permutation-analysis" id="toc-permutation-analysis" class="nav-link active" data-scroll-target="#permutation-analysis">Permutation analysis</a>
  <ul class="collapse">
  <li><a href="#simple-comparisons-between-2-conditions" id="toc-simple-comparisons-between-2-conditions" class="nav-link" data-scroll-target="#simple-comparisons-between-2-conditions">Simple comparisons between 2 conditions</a>
  <ul class="collapse">
  <li><a href="#using-permutations-to-compare-of-correlations-between-groups" id="toc-using-permutations-to-compare-of-correlations-between-groups" class="nav-link" data-scroll-target="#using-permutations-to-compare-of-correlations-between-groups">Using permutations to compare of correlations between groups</a></li>
  </ul></li>
  <li><a href="#comparisons-between-more-than-2-conditions" id="toc-comparisons-between-more-than-2-conditions" class="nav-link" data-scroll-target="#comparisons-between-more-than-2-conditions">Comparisons between more than 2 conditions</a></li>
  <li><a href="#monte-carlo-permutations" id="toc-monte-carlo-permutations" class="nav-link" data-scroll-target="#monte-carlo-permutations">Monte Carlo permutations</a></li>
  </ul></li>
  <li><a href="#caveats" id="toc-caveats" class="nav-link" data-scroll-target="#caveats">Caveats</a>
  <ul class="collapse">
  <li><a href="#within-subject-analyses-have-important-restrictions-in-valid-permutations" id="toc-within-subject-analyses-have-important-restrictions-in-valid-permutations" class="nav-link" data-scroll-target="#within-subject-analyses-have-important-restrictions-in-valid-permutations">Within-subject analyses have important restrictions in valid permutations</a></li>
  </ul></li>
  <li><a href="#consolidation-questions" id="toc-consolidation-questions" class="nav-link" data-scroll-target="#consolidation-questions">Consolidation Questions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Permutations (R)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Course Overview
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<div class="cell" data-fig-height="5" data-fig-width="10">
<div class="cell-output-display">
<div>
<p>
<svg width="960" height="480" viewbox="0.00 0.00 1654.00 1052.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1048)">
<title>
Course Overview
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1048 1650,-1048 1650,4 -4,4"></polygon> <!-- ancova --> <g id="node1" class="node">
<title>
ancova
</title>
<g id="a_node1"><a href="../GeneralLinearModels/ancova.html" title="ANCOVA"> <polygon fill="red" stroke="#006688" stroke-width="5" points="1107,-288 837,-288 837,-216 1107,-216 1107,-288"></polygon> <text text-anchor="middle" x="972" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">ANCOVA</text> </a> </g> </g> <!-- permutation --> <g id="node17" class="node">
<title>
permutation
</title>
<g id="a_node17"><a href="permutations.html" title="Permutations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1107,-180 837,-180 837,-108 1107,-108 1107,-180"></polygon> <text text-anchor="middle" x="972" y="-136.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Permutations</text> </a> </g> </g> <!-- ancova&#45;&gt;permutation --> <g id="edge29" class="edge">
<title>
ancova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-216C972,-204.54 972,-191.81 972,-180.33"></path> </g> <!-- between_anova --> <g id="node2" class="node">
<title>
between_anova
</title>
<g id="a_node2"><a href="../GeneralLinearModels/oneWayAnova.html" title="One-way ANOVA"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="1395,-396 1125,-396 1125,-324 1395,-324 1395,-396"></polygon> <text text-anchor="middle" x="1260" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">One-way ANOVA</text> </a> </g> </g> <!-- between_anova&#45;&gt;ancova --> <g id="edge1" class="edge">
<title>
between_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1164.9,-324C1133.61,-312.48 1098.82,-299.68 1067.49,-288.15"></path> </g> <!-- between_anova&#45;&gt;permutation --> <g id="edge31" class="edge">
<title>
between_anova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1230.67,-324C1203.3,-292.87 1160.16,-247.53 1116,-216 1097.17,-202.56 1075.41,-190.37 1054.61,-180.03"></path> </g> <!-- binomial --> <g id="node3" class="node">
<title>
binomial
</title>
<g id="a_node3"><a href="../distributions/binomial.html" title="Binomial Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1032,-828 762,-828 762,-756 1032,-756 1032,-828"></polygon> <text text-anchor="middle" x="897" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Binomial Distribution</text> </a> </g> </g> <!-- contingency --> <g id="node4" class="node">
<title>
contingency
</title>
<g id="a_node4"><a href="../categorical/contingency.html" title="Contingency"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1154,-612 884,-612 884,-540 1154,-540 1154,-612"></polygon> <text text-anchor="middle" x="1019" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Contingency</text> </a> </g> </g> <!-- binomial&#45;&gt;contingency --> <g id="edge2" class="edge">
<title>
binomial-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M917.15,-755.66C939.82,-715.89 976.43,-651.68 999.03,-612.03"></path> </g> <!-- normal --> <g id="node15" class="node">
<title>
normal
</title>
<g id="a_node15"><a href="../distributions/normal.html" title="Normal Distribution"> <polygon fill="white" stroke="#006688" stroke-width="5" points="825,-720 555,-720 555,-648 825,-648 825,-720"></polygon> <text text-anchor="middle" x="690" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Normal Distribution</text> </a> </g> </g> <!-- binomial&#45;&gt;normal --> <g id="edge3" class="edge">
<title>
binomial-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M828.65,-756C806.15,-744.48 781.15,-731.68 758.63,-720.15"></path> </g> <!-- central_tendency --> <g id="node5" class="node">
<title>
central_tendency
</title>
<g id="a_node5"><a href="../describingData/centralTendency.html" title="Central Tendency"> <polygon fill="white" stroke="#006688" stroke-width="5" points="907,-936 637,-936 637,-864 907,-864 907,-936"></polygon> <text text-anchor="middle" x="772" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Central Tendency</text> </a> </g> </g> <!-- dispersion --> <g id="node7" class="node">
<title>
dispersion
</title>
<g id="a_node7"><a href="../describingData/dispersion.html" title="Dispersion"> <polygon fill="white" stroke="#006688" stroke-width="5" points="744,-828 474,-828 474,-756 744,-756 744,-828"></polygon> <text text-anchor="middle" x="609" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Dispersion</text> </a> </g> </g> <!-- central_tendency&#45;&gt;dispersion --> <g id="edge4" class="edge">
<title>
central_tendency-&gt;dispersion
</title>
<path fill="none" stroke="black" stroke-width="5" d="M718.18,-864C700.46,-852.48 680.77,-839.68 663.05,-828.15"></path> </g> <!-- correlations --> <g id="node6" class="node">
<title>
correlations
</title>
<g id="a_node6"><a href="../distributions/correlations.html" title="Correlations"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="531,-396 261,-396 261,-324 531,-324 531,-396"></polygon> <text text-anchor="middle" x="396" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Correlations</text> </a> </g> </g> <!-- partial_correlations --> <g id="node16" class="node">
<title>
partial_correlations
</title>
<g id="a_node16"><a href="../correlations/partialCorrelations.html" title="Partial Correlations"> <polygon fill="white" stroke="#006688" stroke-width="5" points="558,-288 288,-288 288,-216 558,-216 558,-288"></polygon> <text text-anchor="middle" x="423" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Partial Correlations</text> </a> </g> </g> <!-- correlations&#45;&gt;partial_correlations --> <g id="edge5" class="edge">
<title>
correlations-&gt;partial_correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M404.92,-324C407.83,-312.54 411.08,-299.81 414,-288.33"></path> </g> <!-- correlations&#45;&gt;permutation --> <g id="edge32" class="edge">
<title>
correlations-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M480.51,-323.93C575.21,-284.7 718.97,-225.38 745,-216 779.86,-203.43 818.18,-190.95 853.25,-180.04"></path> </g> <!-- simple_regression --> <g id="node20" class="node">
<title>
simple_regression
</title>
<g id="a_node20"><a href="../regressions/simpleRegressions.html" title="Simple Regression"> <polygon fill="white" stroke="#006688" stroke-width="5" points="270,-288 0,-288 0,-216 270,-216 270,-288"></polygon> <text text-anchor="middle" x="135" y="-244.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Simple Regression</text> </a> </g> </g> <!-- correlations&#45;&gt;simple_regression --> <g id="edge6" class="edge">
<title>
correlations-&gt;simple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M309.82,-324C281.46,-312.48 249.93,-299.68 221.54,-288.15"></path> </g> <!-- dispersion&#45;&gt;normal --> <g id="edge7" class="edge">
<title>
dispersion-&gt;normal
</title>
<path fill="none" stroke="black" stroke-width="5" d="M635.75,-756C644.5,-744.54 654.23,-731.81 663,-720.33"></path> </g> <!-- fdr --> <g id="node8" class="node">
<title>
fdr
</title>
<g id="a_node8"><a href="../multipleTesting/fdr.html" title="False Discovery Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1358,-828 1088,-828 1088,-756 1358,-756 1358,-828"></polygon> <text text-anchor="middle" x="1223" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">False Discovery Rate</text> </a> </g> </g> <!-- fwer_vs_fdr --> <g id="node10" class="node">
<title>
fwer_vs_fdr
</title>
<g id="a_node10"><a href="../multipleTesting/fwer_vs_fdr.html" title="FWER vs. FDR"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1502,-720 1232,-720 1232,-648 1502,-648 1502,-720"></polygon> <text text-anchor="middle" x="1367" y="-676.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">FWER vs.&nbsp;FDR</text> </a> </g> </g> <!-- fdr&#45;&gt;fwer_vs_fdr --> <g id="edge8" class="edge">
<title>
fdr-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1270.55,-756C1286.12,-744.54 1303.41,-731.81 1319.01,-720.33"></path> </g> <!-- fwer --> <g id="node9" class="node">
<title>
fwer
</title>
<g id="a_node9"><a href="../multipleTesting/fwer.html" title="Family-Wise Error Rate"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1646,-828 1376,-828 1376,-756 1646,-756 1646,-828"></polygon> <text text-anchor="middle" x="1511" y="-784.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Family-Wise Error Rate</text> </a> </g> </g> <!-- fwer&#45;&gt;fwer_vs_fdr --> <g id="edge9" class="edge">
<title>
fwer-&gt;fwer_vs_fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1463.45,-756C1447.88,-744.54 1430.59,-731.81 1414.99,-720.33"></path> </g> <!-- glm --> <g id="node11" class="node">
<title>
glm
</title>
<g id="a_node11"><a href="../GeneralLinearModels/generalLinearModels.html" title="General Linear Models"> <polygon fill="white" stroke="#006688" stroke-width="5" points="866,-612 596,-612 596,-540 866,-540 866,-612"></polygon> <text text-anchor="middle" x="731" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">General Linear Models</text> </a> </g> </g> <!-- ttests --> <g id="node24" class="node">
<title>
ttests
</title>
<g id="a_node24"><a href="../GeneralLinearModels/TTests.html" title="T-Tests"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1107,-504 837,-504 837,-432 1107,-432 1107,-504"></polygon> <text text-anchor="middle" x="972" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">T-Tests</text> </a> </g> </g> <!-- glm&#45;&gt;ttests --> <g id="edge10" class="edge">
<title>
glm-&gt;ttests
</title>
<path fill="none" stroke="black" stroke-width="5" d="M810.58,-540C836.77,-528.48 865.88,-515.68 892.09,-504.15"></path> </g> <!-- mediation --> <g id="node12" class="node">
<title>
mediation
</title>
<polygon fill="red" stroke="#006688" stroke-width="5" points="270,-72 0,-72 0,0 270,0 270,-72"></polygon> <text text-anchor="middle" x="135" y="-28.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Mediation</text> </g> <!-- mixed_anova --> <g id="node13" class="node">
<title>
mixed_anova
</title>
<g id="a_node13"><a href="../GeneralLinearModels/mixedAnova.html" title="Mixed ANOVA"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="1107,-396 837,-396 837,-324 1107,-324 1107,-396"></polygon> <text text-anchor="middle" x="972" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Mixed ANOVA</text> </a> </g> </g> <!-- mixed_anova&#45;&gt;ancova --> <g id="edge11" class="edge">
<title>
mixed_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-324C972,-312.54 972,-299.81 972,-288.33"></path> </g> <!-- multiple_regression --> <g id="node14" class="node">
<title>
multiple_regression
</title>
<g id="a_node14"><a href="../regressions/multipleRegressions.html" title="Multiple Regression"> <polygon fill="orange" stroke="#006688" stroke-width="5" points="270,-180 0,-180 0,-108 270,-108 270,-180"></polygon> <text text-anchor="middle" x="135" y="-136.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Multiple Regression</text> </a> </g> </g> <!-- multiple_regression&#45;&gt;mediation --> <g id="edge12" class="edge">
<title>
multiple_regression-&gt;mediation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M135,-108C135,-96.54 135,-83.81 135,-72.33"></path> </g> <!-- normal&#45;&gt;contingency --> <g id="edge14" class="edge">
<title>
normal-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M798.64,-648C834.48,-636.45 874.34,-623.61 910.19,-612.06"></path> </g> <!-- normal&#45;&gt;correlations --> <g id="edge13" class="edge">
<title>
normal-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M622.95,-647.82C609.28,-637.89 596.27,-625.92 587,-612 541.67,-543.95 599.91,-495.98 549,-432 537.33,-417.34 521.93,-405.57 505.4,-396.16"></path> </g> <!-- normal&#45;&gt;glm --> <g id="edge15" class="edge">
<title>
normal-&gt;glm
</title>
<path fill="none" stroke="black" stroke-width="5" d="M703.54,-648C707.97,-636.54 712.89,-623.81 717.34,-612.33"></path> </g> <!-- skewness --> <g id="node21" class="node">
<title>
skewness
</title>
<g id="a_node21"><a href="../distributions/skewness.html" title="Skewness"> <polygon fill="white" stroke="#006688" stroke-width="5" points="536,-612 266,-612 266,-540 536,-540 536,-612"></polygon> <text text-anchor="middle" x="401" y="-568.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Skewness</text> </a> </g> </g> <!-- normal&#45;&gt;skewness --> <g id="edge16" class="edge">
<title>
normal-&gt;skewness
</title>
<path fill="none" stroke="black" stroke-width="5" d="M594.57,-648C563.17,-636.48 528.26,-623.68 496.82,-612.15"></path> </g> <!-- probability --> <g id="node18" class="node">
<title>
probability
</title>
<g id="a_node18"><a href="../statsBasics/probability.html" title="Probability"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1276,-936 1006,-936 1006,-864 1276,-864 1276,-936"></polygon> <text text-anchor="middle" x="1141" y="-892.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Probability</text> </a> </g> </g> <!-- probability&#45;&gt;contingency --> <g id="edge20" class="edge">
<title>
probability-&gt;contingency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1104.47,-863.94C1094.99,-853.19 1085.6,-840.8 1079,-828 1042.23,-756.72 1027.55,-662.41 1022.04,-612.12"></path> </g> <!-- probability&#45;&gt;fdr --> <g id="edge22" class="edge">
<title>
probability-&gt;fdr
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1168.08,-864C1176.94,-852.54 1186.79,-839.81 1195.67,-828.33"></path> </g> <!-- probability&#45;&gt;fwer --> <g id="edge21" class="edge">
<title>
probability-&gt;fwer
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1263.18,-864C1303.49,-852.45 1348.31,-839.61 1388.64,-828.06"></path> </g> <!-- repeated_measures_anova --> <g id="node19" class="node">
<title>
repeated_measures_anova
</title>
<g id="a_node19"><a href="../GeneralLinearModels/repeatedAnova.html" title="Repeated Measures"> <polygon fill="red" stroke="#006688" stroke-width="5" points="819,-396 549,-396 549,-324 819,-324 819,-396"></polygon> <text text-anchor="middle" x="684" y="-352.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Repeated Measures</text> </a> </g> </g> <!-- repeated_measures_anova&#45;&gt;ancova --> <g id="edge23" class="edge">
<title>
repeated_measures_anova-&gt;ancova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M779.1,-324C810.39,-312.48 845.18,-299.68 876.51,-288.15"></path> </g> <!-- repeated_measures_anova&#45;&gt;permutation --> <g id="edge30" class="edge">
<title>
repeated_measures_anova-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M713.33,-324C740.7,-292.87 783.84,-247.53 828,-216 846.83,-202.56 868.59,-190.37 889.39,-180.03"></path> </g> <!-- simple_regression&#45;&gt;multiple_regression --> <g id="edge17" class="edge">
<title>
simple_regression-&gt;multiple_regression
</title>
<path fill="none" stroke="black" stroke-width="5" d="M135,-216C135,-204.54 135,-191.81 135,-180.33"></path> </g> <!-- transforming --> <g id="node23" class="node">
<title>
transforming
</title>
<g id="a_node23"><a href="../distributions/transforming.html" title="Transforming Data"> <polygon fill="white" stroke="#006688" stroke-width="5" points="540,-504 252,-504 252,-432 540,-432 540,-504"></polygon> <text text-anchor="middle" x="396" y="-460.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Transforming Data</text> </a> </g> </g> <!-- skewness&#45;&gt;transforming --> <g id="edge18" class="edge">
<title>
skewness-&gt;transforming
</title>
<path fill="none" stroke="black" stroke-width="5" d="M399.35,-540C398.81,-528.54 398.21,-515.81 397.67,-504.33"></path> </g> <!-- stats_basics --> <g id="node22" class="node">
<title>
stats_basics
</title>
<g id="a_node22"><a href="../statsBasics/statsBasics.html" title="Statistics Basics"> <polygon fill="white" stroke="#006688" stroke-width="5" points="1051,-1044 781,-1044 781,-972 1051,-972 1051,-1044"></polygon> <text text-anchor="middle" x="916" y="-1000.8" font-family="Helvetica,Arial,sans-serif" font-size="24.00">Statistics Basics</text> </a> </g> </g> <!-- stats_basics&#45;&gt;central_tendency --> <g id="edge24" class="edge">
<title>
stats_basics-&gt;central_tendency
</title>
<path fill="none" stroke="black" stroke-width="5" d="M868.45,-972C852.88,-960.54 835.59,-947.81 819.99,-936.33"></path> </g> <!-- stats_basics&#45;&gt;probability --> <g id="edge25" class="edge">
<title>
stats_basics-&gt;probability
</title>
<path fill="none" stroke="black" stroke-width="5" d="M990.3,-972C1014.75,-960.48 1041.93,-947.68 1066.4,-936.15"></path> </g> <!-- transforming&#45;&gt;correlations --> <g id="edge19" class="edge">
<title>
transforming-&gt;correlations
</title>
<path fill="none" stroke="black" stroke-width="5" d="M396,-432C396,-420.54 396,-407.81 396,-396.33"></path> </g> <!-- ttests&#45;&gt;between_anova --> <g id="edge27" class="edge">
<title>
ttests-&gt;between_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1067.1,-432C1098.39,-420.48 1133.18,-407.68 1164.51,-396.15"></path> </g> <!-- ttests&#45;&gt;mixed_anova --> <g id="edge26" class="edge">
<title>
ttests-&gt;mixed_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M972,-432C972,-420.54 972,-407.81 972,-396.33"></path> </g> <!-- ttests&#45;&gt;permutation --> <g id="edge33" class="edge">
<title>
ttests-&gt;permutation
</title>
<path fill="none" stroke="black" stroke-width="5" d="M1107.25,-463.29C1219.41,-457.03 1366.37,-440.32 1404,-396 1501.55,-281.11 1267.68,-206.55 1107.33,-170.5"></path> </g> <!-- ttests&#45;&gt;repeated_measures_anova --> <g id="edge28" class="edge">
<title>
ttests-&gt;repeated_measures_anova
</title>
<path fill="none" stroke="black" stroke-width="5" d="M876.9,-432C845.61,-420.48 810.82,-407.68 779.49,-396.15"></path> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<p><span style="color:red"><strong>Red</strong></span> means that the page does not exist yet</p>
<p><span style="color:orange"><strong>Orange</strong></span> means that the page is started</p>
</div>
</div>
</div>
<section id="permutation-analysis" class="level1">
<h1>Permutation analysis</h1>
<section id="simple-comparisons-between-2-conditions" class="level2">
<h2 class="anchored" data-anchor-id="simple-comparisons-between-2-conditions">Simple comparisons between 2 conditions</h2>
<p>We have used the word permutation before in calculating <a href="statsBasics/probability.html">probabilities</a> and Fisher’s exact score within <a href="categorical/contingency.html">contingency</a>, in that it refers to a specific combination of items. In the context of <strong>permutation analysis</strong>, you compare the original permutation of items within categories and a range of other permutations of items within categories. For example, let’s imagine we want to see if cats are slower at running than dogs. We could measure the amount of time it took (in seconds) for cats and dogs to run 100 meters (assuming you are able to herd cats). We might get some data as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cat_dog_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal =</span> <span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(cat_dog_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["animal"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"cat","2":"20"},{"1":"cat","2":"9"},{"1":"cat","2":"9"},{"1":"dog","2":"5"},{"1":"dog","2":"6"},{"1":"dog","2":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>To compare between these groups we would like to do a t-test, but would only be able to do this if the data is parametric. Let’s check whether there’s any problem with this assumption by using a Shapiro-Wilk test for dogs and cats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"cat"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  cat_dog_df$time[cat_dog_df$animal == "cat"]
W = 0.75, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"dog"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  cat_dog_df$time[cat_dog_df$animal == "dog"]
W = 1, p-value = 1</code></pre>
</div>
</div>
<p>For cats there is a significant problem. As t-tests are dependent on the distributions of each group being parametric, we will use permutation analysis as a non-parametric solution. First, we want to capture how big the difference in means is, so that we can compare it to permutations we will describe later:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mean_diff <span class="ot">=</span> <span class="fu">mean</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"cat"</span>]) <span class="sc">-</span> <span class="fu">mean</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"dog"</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mean_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.666667</code></pre>
</div>
</div>
<p>So cats are <span class="math inline">\(6.\overline{6}\)</span> seconds slower than dogs on average. To capture how significant this difference is, we can create a distribution of possible differences that could have happened if we consider all permutations of data points being allocated to dogs and cats. Don’t woryr if this isn’t clear yet, the next steps should clarify the principle.</p>
<p>We currently have participants 1 to 3 as cats, and participants 4 to 6 as dogs. We need to identify all permutations participants 1 to 6 could have had as cats and dogs, and see how big the mean difference between cats and dogs would have been in each permutation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all permutations of participant numbers for cats, with each permutation as a column</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cat_perms <span class="ot">=</span> <span class="fu">combn</span>(<span class="dv">6</span>, <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation 1 as an example (this is the original permutation)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>cat_perms[,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation 2 as an example (participants 1, 2 and 4s data is "cat" in this permutation)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cat_perms[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the mean</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mean_diff_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(cat_perms)[<span class="dv">2</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cat_perms)){</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the relevant permutation</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  these_cats <span class="ot">=</span> cat_perms[,i]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># allocate the data points for these_cats to cats</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  cats_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[these_cats]</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># identify dogs</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  dogs_index <span class="ot">=</span> <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">%in%</span> these_cats)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  dogs_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[dogs_index]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store mean difference</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  mean_diff_perms[i] <span class="ot">=</span> <span class="fu">mean</span>(cats_rt) <span class="sc">-</span> <span class="fu">mean</span>(dogs_rt)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(mean_diff_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -6.666667 -5.333333 -5.333333 -4.666667 -4.666667 -4.000000 -4.000000
 [8] -3.333333 -2.666667 -2.000000  2.000000  2.666667  3.333333  4.000000
[15]  4.000000  4.666667  4.666667  5.333333  5.333333  6.666667</code></pre>
</div>
</div>
<p>We now have the mean difference from every possible permutation, we have a distribution of all possible outcomes. The question now becomes, was the outcome from the original data (or a more extreme outcome) unusually unlikely? Well, the original outcome was that cats were <span class="math inline">\(6.\overline{6}\)</span> seconds slower than dogs. Out of all the possible outcomes, there are only 2 that have that size of absolute difference or bigger (but in this case there aren’t any bigger absolute differences). The likelihood of getting this size of difference then is 2 out of all permutations, which is 20, i.e.&nbsp;<span class="math inline">\(\frac{2}{20} = \frac{1}{10} = .1\)</span> . So this wouldn’t be significant evidence. Note that if we had had a 1-tailed hypothesis that cats would be slower (or that dogs would be faster), then we wouldn’t have compared <span class="math inline">\(6.\overline{6}\)</span> to the <strong>absolute</strong> values of all outcomes, and so we would have found only a 1 in 20 chance of getting our outcome. You could summarise this in a table if it helps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::group_rows() masks kableExtra::group_rows()
✖ dplyr::lag()        masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"permutation difference"</span> <span class="ot">=</span> <span class="fu">sort</span>(mean_diff_perms),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"permutation absolute difference"</span> <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">sort</span>(mean_diff_perms)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"original_difference"</span> <span class="ot">=</span> mean_diff,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1 tailed"</span> <span class="ot">=</span> <span class="fu">ifelse</span>((<span class="fu">sort</span>(mean_diff_perms))<span class="sc">&lt;</span>mean_diff,<span class="st">"lower"</span>,<span class="st">"equal to or higher"</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2 tailed"</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(<span class="fu">sort</span>(mean_diff_perms))<span class="sc">&lt;</span>mean_diff,<span class="st">"lower"</span>,<span class="st">"equal to or higher"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> F</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">cell_spec</span>(.x, <span class="at">color =</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="st">"equal to or higher"</span>, <span class="st">"red"</span>,<span class="st">" black"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">escape =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> permutation difference </th>
   <th style="text-align:left;"> permutation absolute difference </th>
   <th style="text-align:left;"> original_difference </th>
   <th style="text-align:left;"> 1 tailed </th>
   <th style="text-align:left;"> 2 tailed </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">equal to or higher</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-3.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">3.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-2.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">2.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">-2</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">2</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">2</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">2</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">2.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">2.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">3.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">3.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">4.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">5.33333333333333</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">lower</span> </td>
  </tr>
  <tr>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: black !important;">6.66666666666667</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">equal to or higher</span> </td>
   <td style="text-align:left;"> <span style="     color: red !important;">equal to or higher</span> </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>The above table hopefully visualises how the original outcome only will occur 1 in 20 times, and the size of the original outcome will only occur 1 in 10 times.</p>
<p>Whilst we looked at mean differences above, you could also have done a t-test on each permutation to achieve the same goal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the mean</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ttest_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(cat_perms)[<span class="dv">2</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cat_perms)){</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the relevant permutation</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  these_cats <span class="ot">=</span> cat_perms[,i]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># allocate the data points for these_cats to cats</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  cats_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[these_cats]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># identify dogs</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  dogs_index <span class="ot">=</span> <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">%in%</span> these_cats)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  dogs_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[dogs_index]</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store t-test value (note that it can also be negative to reflect direction)</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  ttest_perms[i] <span class="ot">=</span> <span class="fu">t.test</span>(cats_rt,dogs_rt)<span class="sc">$</span>statistic</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(ttest_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.7960530 -1.2649111 -1.2649111 -1.0583005 -1.0583005 -0.8751899
 [7] -0.8751899 -0.7088812 -0.5547002 -0.4091966  0.4091966  0.5547002
[13]  0.7088812  0.8751899  0.8751899  1.0583005  1.0583005  1.2649111
[19]  1.2649111  1.7960530</code></pre>
</div>
</div>
<p>The original t-test value is 1.796 (see below)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(time <span class="sc">~</span> animal, cat_dog_df, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  time by animal
t = 1.7961, df = 4, p-value = 0.1469
alternative hypothesis: true difference in means between group cat and group dog is not equal to 0
95 percent confidence interval:
 -3.639061 16.972395
sample estimates:
mean in group cat mean in group dog 
         12.66667           6.00000 </code></pre>
</div>
</div>
<p>confirming that the result is just as significant (1 in 10 for a 2-tailed hypothesis, 1 in 20 for a <strong>correct</strong> 1-tailed hypothesis) regardless of whether you use t-tests or mean difference. This is useful/important because sometimes the analysis you want to do is going to be more complicated than a single comparison (e.g.&nbsp;an ANOVA), and so below we’ll address this.</p>
<p>But first, some of you might have been concerned about whether the extreme value of 20 was being disproportionately influential. To address this, we could do an analysis that compares <strong>medians</strong> rather than <strong>means</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original comparison</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"cat"</span>]) <span class="sc">-</span> <span class="fu">median</span>(cat_dog_df<span class="sc">$</span>time[cat_dog_df<span class="sc">$</span>animal<span class="sc">==</span><span class="st">"dog"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the mean</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>median_diff_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(cat_perms)[<span class="dv">2</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cat_perms)){</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the relevant permutation</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  these_cats <span class="ot">=</span> cat_perms[,i]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># allocate the data points for these_cats to cats</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  cats_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[these_cats]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># identify dogs</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  dogs_index <span class="ot">=</span> <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">%in%</span> these_cats)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  dogs_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[dogs_index]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># store mean difference</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  median_diff_perms[i] <span class="ot">=</span> <span class="fu">median</span>(cats_rt) <span class="sc">-</span> <span class="fu">median</span>(dogs_rt)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(median_diff_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -3 -3 -3 -3 -2 -2 -2 -2 -2 -2  2  2  2  2  2  2  3  3  3  3</code></pre>
</div>
</div>
<p>We can see now that our original outcome of 3 was quite likely. If we have a 2-tailed hypothesis then the likelihood of an absolute value of 3 (or greater) is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(median_diff_perms) <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">length</span>(median_diff_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or more elegantly</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(median_diff_perms) <span class="sc">&gt;=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
</div>
<p>40% (p-value of .4). Even if you correctly predicted dogs would be quicker…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((median_diff_perms) <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">length</span>(median_diff_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or more elegantly</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((median_diff_perms) <span class="sc">&gt;=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
</div>
<p>you would only get a p-value of .2, which is not approaching significant.</p>
<section id="using-permutations-to-compare-of-correlations-between-groups" class="level3">
<h3 class="anchored" data-anchor-id="using-permutations-to-compare-of-correlations-between-groups">Using permutations to compare of correlations between groups</h3>
<p>You can use a variety of outcomes, not just comparisons of means, medians and t-values. Let’s use correlation r-values to illustrate this. Let’s imagine if we wanted to test whether height and speed were differently associated within cats and dogs. Let’s add heights (in centimeters) to our data above with dogs and cats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cat_dog_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal =</span> <span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">45</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">70</span>,<span class="dv">75</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(cat_dog_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["animal"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["height"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"cat","2":"20","3":"50"},{"1":"cat","2":"9","3":"45"},{"1":"cat","2":"9","3":"50"},{"1":"dog","2":"5","3":"80"},{"1":"dog","2":"6","3":"70"},{"1":"dog","2":"7","3":"75"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>First, let’s check a Pearson correlation between time and height for each animal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate r-values for cats and dogs</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cat_dog_df <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r_value =</span> <span class="fu">cor.test</span>(height,time)<span class="sc">$</span>estimate) <span class="ot">-&gt;</span> cats_dogs_correlations</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>cats_dogs_correlations<span class="sc">$</span>r_value[cats_dogs_correlations<span class="sc">$</span>animal <span class="sc">==</span> <span class="st">"cat"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cor 
0.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cats_dogs_correlations<span class="sc">$</span>r_value[cats_dogs_correlations<span class="sc">$</span>animal <span class="sc">==</span> <span class="st">"dog"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> cor 
-0.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cats_dogs_correlations<span class="sc">$</span>r_value[cats_dogs_correlations<span class="sc">$</span>animal <span class="sc">==</span> <span class="st">"cat"</span>] <span class="sc">-</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  cats_dogs_correlations<span class="sc">$</span>r_value[cats_dogs_correlations<span class="sc">$</span>animal <span class="sc">==</span> <span class="st">"dog"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cor 
  1 </code></pre>
</div>
</div>
<p>Now, we can see that there seems to be a positive correlation between height and time for cats, and a negative association for dogs. But to see if the difference between these correlations is significant lets capture all possible permutation outcomes of this comparison between correlations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the mean</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>corr_diff_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(cat_perms)[<span class="dv">2</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(cat_perms)){</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the relevant permutation</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  these_cats <span class="ot">=</span> cat_perms[,i]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># allocate the data points for these_cats to cats</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  cats_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[these_cats]</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  cats_height <span class="ot">=</span> cat_dog_df<span class="sc">$</span>height[these_cats]</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># identify dogs</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  dogs_index <span class="ot">=</span> <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">%in%</span> these_cats)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  dogs_rt <span class="ot">=</span> cat_dog_df<span class="sc">$</span>time[dogs_index]</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  dogs_height <span class="ot">=</span> cat_dog_df<span class="sc">$</span>height[dogs_index]</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  corr_diff_perms[i] <span class="ot">=</span> <span class="fu">cor.test</span>(cats_rt,cats_height)<span class="sc">$</span>estimate <span class="sc">-</span> <span class="fu">cor.test</span>(dogs_rt,dogs_height)<span class="sc">$</span>estimate </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(corr_diff_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.00000000 -0.50702194 -0.42049220 -0.38067051 -0.25959598 -0.25870207
 [7] -0.17636806 -0.02508371 -0.02337287 -0.01747225  0.01747225  0.02337287
[13]  0.02508371  0.17636806  0.25870207  0.25959598  0.38067051  0.42049220
[19]  0.50702194  1.00000000</code></pre>
</div>
</div>
<p>As before, the difference between correlations was strongest in the comparison on the original data, and so the likelihood is 1 in 20 if you correctly expected dogs would have a more negative association between height and time than cats, and 1 in 10 if you expected there to be some difference in association of these variables between cats and dogs.</p>
<p><strong>Note - we don’t need data to be non-parametric for the above to be a useful solution</strong>. This use of permutation analysis is one of a few ways to try to identify whether there’s a significant difference between two correlations. Other methods include Fisher’s Z if you are comparing between two groups of participants like above. Steiger’s Z can be used to do within-subject comparison of correlations, which is distinct from above as you are comparing correlations between 3 variables. We don’t cover Fisher’s Z and Steiger’s Z on this website, so you may want to search online for further information about them.</p>
</section>
</section>
<section id="comparisons-between-more-than-2-conditions" class="level2">
<h2 class="anchored" data-anchor-id="comparisons-between-more-than-2-conditions">Comparisons between more than 2 conditions</h2>
<p>Above we highlighted that you can compare the original t-value against each permutation’s t-value to identify whether your outcome was significantly unlikely. You can use a similar logic to use an ANOVA’s f-value as an output, using the logic above, or another complex calculation. We’ll add foxes to the above example to allow for use to do a one-way ANOVA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>animal_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">animal =</span> <span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"fox"</span>,<span class="st">"fox"</span>,<span class="st">"fox"</span>),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time   =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">6</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA on real data</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>anova_animals<span class="ot">&lt;-</span><span class="fu">aov</span>(time<span class="sc">~</span>animal,animal_df)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_animals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
animal       2  84.67   42.33   2.908  0.131
Residuals    6  87.33   14.56               </code></pre>
</div>
</div>
<p>The ANOVA was not significant, but perhaps this was a consequence of there being an unusually slow cat distorting the distribution? Let’s see if the results are still not significant when we use permutation analysis to generate F values to compare with the original F value of 2.91.</p>
<p>First, we need to address the fact that there are now 3 categories of animal, and so we need to calculate new permutations to reflect these 9 animals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see pages on probability for explanations of the following lines</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># check how many unique permutations we should find with later code</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>unique_perms <span class="ot">=</span> <span class="fu">factorial</span>(<span class="dv">9</span>)<span class="sc">/</span>(<span class="fu">factorial</span>(<span class="dv">3</span>)<span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">3</span>)<span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">3</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate all permutations (allowing for repetitions, despite the "repetitions = F" input)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RcppAlgos)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>animal_combos <span class="ot">=</span> RcppAlgos<span class="sc">::</span><span class="fu">permuteGeneral</span>(<span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"dog"</span>,<span class="st">"fox"</span>,<span class="st">"fox"</span>,<span class="st">"fox"</span>),<span class="at">repetition =</span> F)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># identify repetitions</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>combos_repeats <span class="ot">=</span> <span class="fu">duplicated</span>(<span class="fu">paste</span>(</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">1</span>],</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">2</span>],</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">3</span>],</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">4</span>],</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">5</span>],</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">6</span>],</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">7</span>],</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">8</span>],</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  animal_combos[,<span class="dv">9</span>]</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co"># removing repetitions</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>animal_combos_clean <span class="ot">=</span> animal_combos[<span class="sc">!</span>combos_repeats,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have 1680 permutations, let’s apply them to the original data to get our distribution of outcomes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the ANOVA outputs (note that the matrix has swapped to 1 row per permutation rather than 1 column)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>anova_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(animal_combos_clean)[<span class="dv">1</span>])</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(anova_perms)){</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the relevant permutation</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  animal_df<span class="sc">$</span>perm_animal <span class="ot">=</span> animal_combos_clean[i,]</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ANOVA on real data</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  anova_animals <span class="ot">=</span> <span class="fu">aov</span>(time<span class="sc">~</span>perm_animal,animal_df)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  this_summary  <span class="ot">=</span> <span class="fu">summary</span>(anova_animals)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  anova_perms[i]   <span class="ot">=</span> this_summary[[<span class="dv">1</span>]][[<span class="st">"F value"</span>]][<span class="dv">1</span>]</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive (commented out as it's not very visibly accessible at this size)</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># sort(anova_perms)</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(anova_perms)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">2.908</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="permutations_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the f-value from the original data was unusually high. The above figure also confirms how ANOVAs are 2-tailed tests, i.e.&nbsp;there’s no possible negative F value that’s directional. To calculate the p-value, we will compare the original F value of 2.908 with all F values generated by permutation, to see how many were equal or greater than 2.908:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anova_perms<span class="sc">&gt;</span><span class="fl">2.908</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03571429</code></pre>
</div>
</div>
<p>Only .036 or 3.6% were equal to or higher than 2.908, so our p-value is .036 and is significant (less than .05).</p>
</section>
<section id="monte-carlo-permutations" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-permutations">Monte Carlo permutations</h2>
<p>In all the above we have only had a small number of participants, so it is still manageable to identify all permutations and then apply an original output against the outputs of all permutations. However, the number of possible permutations quickly goes up with the number of participants. Let’s focus on analyses in which there are comparisons between 2 groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pp_perm_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">participants =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>pp_perm_df<span class="sc">$</span>pp_per_group <span class="ot">=</span> pp_perm_df<span class="sc">$</span>participants<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>pp_perm_df<span class="sc">$</span>permutations <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pp_perm_df<span class="sc">$</span>participants)){</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  pp_perm_df<span class="sc">$</span>permutations[i] <span class="ot">=</span> <span class="fu">dim</span>(<span class="fu">combn</span>(pp_perm_df<span class="sc">$</span>participants[i], pp_perm_df<span class="sc">$</span>pp_per_group[i]))[<span class="dv">2</span>]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pp_perm_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> participants </th>
   <th style="text-align:right;"> pp_per_group </th>
   <th style="text-align:right;"> permutations </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 20 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 70 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 252 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 924 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 3432 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 12870 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 48620 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 184756 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Initially the above table was going to include calculations of how many permutations there are for 30 and 40 participants, but R was taking a long time to calculate them. <strong>This issue of computing power is relevant, as it rapidly becomes less computationally realistic to calculate every permutation the more participants you have.</strong></p>
<p>To address this, we can use <strong>Monte Carlo permutations</strong>, which is a fancy way of saying that you generate a random sample of permutations (e.g.&nbsp;10,000 permutations) to create a distribution from. As the permutations will be random, the analysis won’t be biased towards or away from significance. Let’s use Gapminder data to illustrate Monte Carlo permutations in action.</p>
<p>Let’s say we wanted to investigate whether continent was a good predictor of life expectancy. To simplify things, let’s compare Europe and the Americas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>gapminder_2007 <span class="ot">&lt;-</span> <span class="fu">subset</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  gapminder,   <span class="co"># the data set</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  year <span class="sc">==</span> <span class="dv">2007</span> <span class="sc">&amp;</span> (continent <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">"Americas"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(gapminder_2007)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["fct"],"align":["left"]},{"label":["continent"],"name":[2],"type":["fct"],"align":["left"]},{"label":["year"],"name":[3],"type":["int"],"align":["right"]},{"label":["lifeExp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pop"],"name":[5],"type":["int"],"align":["right"]},{"label":["gdpPercap"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Albania","2":"Europe","3":"2007","4":"76.423","5":"3600523","6":"5937.030"},{"1":"Argentina","2":"Americas","3":"2007","4":"75.320","5":"40301927","6":"12779.380"},{"1":"Austria","2":"Europe","3":"2007","4":"79.829","5":"8199783","6":"36126.493"},{"1":"Belgium","2":"Europe","3":"2007","4":"79.441","5":"10392226","6":"33692.605"},{"1":"Bolivia","2":"Americas","3":"2007","4":"65.554","5":"9119152","6":"3822.137"},{"1":"Bosnia and Herzegovina","2":"Europe","3":"2007","4":"74.852","5":"4552198","6":"7446.299"},{"1":"Brazil","2":"Americas","3":"2007","4":"72.390","5":"190010647","6":"9065.801"},{"1":"Bulgaria","2":"Europe","3":"2007","4":"73.005","5":"7322858","6":"10680.793"},{"1":"Canada","2":"Americas","3":"2007","4":"80.653","5":"33390141","6":"36319.235"},{"1":"Chile","2":"Americas","3":"2007","4":"78.553","5":"16284741","6":"13171.639"},{"1":"Colombia","2":"Americas","3":"2007","4":"72.889","5":"44227550","6":"7006.580"},{"1":"Costa Rica","2":"Americas","3":"2007","4":"78.782","5":"4133884","6":"9645.061"},{"1":"Croatia","2":"Europe","3":"2007","4":"75.748","5":"4493312","6":"14619.223"},{"1":"Cuba","2":"Americas","3":"2007","4":"78.273","5":"11416987","6":"8948.103"},{"1":"Czech Republic","2":"Europe","3":"2007","4":"76.486","5":"10228744","6":"22833.309"},{"1":"Denmark","2":"Europe","3":"2007","4":"78.332","5":"5468120","6":"35278.419"},{"1":"Dominican Republic","2":"Americas","3":"2007","4":"72.235","5":"9319622","6":"6025.375"},{"1":"Ecuador","2":"Americas","3":"2007","4":"74.994","5":"13755680","6":"6873.262"},{"1":"El Salvador","2":"Americas","3":"2007","4":"71.878","5":"6939688","6":"5728.354"},{"1":"Finland","2":"Europe","3":"2007","4":"79.313","5":"5238460","6":"33207.084"},{"1":"France","2":"Europe","3":"2007","4":"80.657","5":"61083916","6":"30470.017"},{"1":"Germany","2":"Europe","3":"2007","4":"79.406","5":"82400996","6":"32170.374"},{"1":"Greece","2":"Europe","3":"2007","4":"79.483","5":"10706290","6":"27538.412"},{"1":"Guatemala","2":"Americas","3":"2007","4":"70.259","5":"12572928","6":"5186.050"},{"1":"Haiti","2":"Americas","3":"2007","4":"60.916","5":"8502814","6":"1201.637"},{"1":"Honduras","2":"Americas","3":"2007","4":"70.198","5":"7483763","6":"3548.331"},{"1":"Hungary","2":"Europe","3":"2007","4":"73.338","5":"9956108","6":"18008.944"},{"1":"Iceland","2":"Europe","3":"2007","4":"81.757","5":"301931","6":"36180.789"},{"1":"Ireland","2":"Europe","3":"2007","4":"78.885","5":"4109086","6":"40675.996"},{"1":"Italy","2":"Europe","3":"2007","4":"80.546","5":"58147733","6":"28569.720"},{"1":"Jamaica","2":"Americas","3":"2007","4":"72.567","5":"2780132","6":"7320.880"},{"1":"Mexico","2":"Americas","3":"2007","4":"76.195","5":"108700891","6":"11977.575"},{"1":"Montenegro","2":"Europe","3":"2007","4":"74.543","5":"684736","6":"9253.896"},{"1":"Netherlands","2":"Europe","3":"2007","4":"79.762","5":"16570613","6":"36797.933"},{"1":"Nicaragua","2":"Americas","3":"2007","4":"72.899","5":"5675356","6":"2749.321"},{"1":"Norway","2":"Europe","3":"2007","4":"80.196","5":"4627926","6":"49357.190"},{"1":"Panama","2":"Americas","3":"2007","4":"75.537","5":"3242173","6":"9809.186"},{"1":"Paraguay","2":"Americas","3":"2007","4":"71.752","5":"6667147","6":"4172.838"},{"1":"Peru","2":"Americas","3":"2007","4":"71.421","5":"28674757","6":"7408.906"},{"1":"Poland","2":"Europe","3":"2007","4":"75.563","5":"38518241","6":"15389.925"},{"1":"Portugal","2":"Europe","3":"2007","4":"78.098","5":"10642836","6":"20509.648"},{"1":"Puerto Rico","2":"Americas","3":"2007","4":"78.746","5":"3942491","6":"19328.709"},{"1":"Romania","2":"Europe","3":"2007","4":"72.476","5":"22276056","6":"10808.476"},{"1":"Serbia","2":"Europe","3":"2007","4":"74.002","5":"10150265","6":"9786.535"},{"1":"Slovak Republic","2":"Europe","3":"2007","4":"74.663","5":"5447502","6":"18678.314"},{"1":"Slovenia","2":"Europe","3":"2007","4":"77.926","5":"2009245","6":"25768.258"},{"1":"Spain","2":"Europe","3":"2007","4":"80.941","5":"40448191","6":"28821.064"},{"1":"Sweden","2":"Europe","3":"2007","4":"80.884","5":"9031088","6":"33859.748"},{"1":"Switzerland","2":"Europe","3":"2007","4":"81.701","5":"7554661","6":"37506.419"},{"1":"Trinidad and Tobago","2":"Americas","3":"2007","4":"69.819","5":"1056608","6":"18008.509"},{"1":"Turkey","2":"Europe","3":"2007","4":"71.777","5":"71158647","6":"8458.276"},{"1":"United Kingdom","2":"Europe","3":"2007","4":"79.425","5":"60776238","6":"33203.261"},{"1":"United States","2":"Americas","3":"2007","4":"78.242","5":"301139947","6":"42951.653"},{"1":"Uruguay","2":"Americas","3":"2007","4":"76.384","5":"3447496","6":"10611.463"},{"1":"Venezuela","2":"Americas","3":"2007","4":"73.747","5":"26084662","6":"11415.806"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The table above has 55 rows, and so it would be computationally intensive (possibly impossible for most/all of us) to calculate every possible permutation of life expectancy and continent. We will instead create 10,000 random permutations to compare against the original <strong>median</strong> difference in life expectancy between Europe and the Americas.</p>
<p>Let’s start with the median difference in life expectancy between Europe and the Americas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>life_exp_diff <span class="ot">=</span> <span class="fu">median</span>(gapminder_2007<span class="sc">$</span>lifeExp[gapminder_2007<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>]) <span class="sc">-</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(gapminder_2007<span class="sc">$</span>lifeExp[gapminder_2007<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>life_exp_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.7095</code></pre>
</div>
</div>
<p>Next, we need to randomly create 10,000 permutations, taking into account that there should be 30 countries allocated to Europe and 25 allocated to the Americas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting seed so that we don't land on an unrepresentative permutation. Be careful about setting seeds, they will still allow random functions like sample to run, but you will get the same output every time.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>life_exp_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  europe_sample <span class="ot">=</span> <span class="fu">sample</span>(gapminder_2007<span class="sc">$</span>lifeExp, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the opposite data for Americas</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  americas_index <span class="ot">=</span> <span class="sc">!</span>(gapminder_2007<span class="sc">$</span>lifeExp <span class="sc">%in%</span> europe_sample)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  americas_sample <span class="ot">=</span> gapminder_2007<span class="sc">$</span>lifeExp[americas_index]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compare the medians</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  life_exp_perms[i] <span class="ot">=</span> <span class="fu">median</span>(europe_sample) <span class="sc">-</span> <span class="fu">median</span>(americas_sample)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(life_exp_perms, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> life_exp_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="permutations_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above histogram summarises the permutation analysis, in which the red line represents the actual difference in medians between Europe and America (a positive score reflecting longer life expectancy in Europe). To calculate the likelihood we would get this difference randomly (and thus its p-value), let’s start with a one-directional hypothesis that life expectancy is higher in Europe, and so the likelihood of getting a value of 5.7095 randomly. This is reflected in how many <strong>random</strong> permutations were greater than or equal to 5.7095:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(life_exp_perms <span class="sc">&gt;</span> life_exp_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>In this analysis there were 0 permutations that showed an equal greater bias in life expectancy in favour of Europe. This suggests the original bias in favour of Europe was extremely unlikely to have occurred by chance (p &lt; .001), and so you have significant evidence that life expectancy in Europe is higher than the Americas.</p>
<p>For completeness, let’s now look at a 2-tailed version of this analysis by comparing the absolute values of the permutations to the actual life expectancy difference:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(life_exp_perms) <span class="sc">&gt;</span> life_exp_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>You could visualise the 2-tailed test as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">abs</span>(life_exp_perms), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> life_exp_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="permutations_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="caveats" class="level1">
<h1>Caveats</h1>
<section id="within-subject-analyses-have-important-restrictions-in-valid-permutations" class="level2">
<h2 class="anchored" data-anchor-id="within-subject-analyses-have-important-restrictions-in-valid-permutations">Within-subject analyses have important restrictions in valid permutations</h2>
<p>The permutations analyses above have been mostly between-subject, whereas within-subject permutations are more restricted. It largely depends on the analysis, so we will try to illustrate some key principles using a paired samples t-test. Let’s imagine that you want to measure how many hours sleep a group of participants had in 2 nights, one in which they had a caffeinated drink at dinner, one in which they had no caffeine at dinner time. We might have data as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sleep_df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">caffeine    =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">6</span>),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">no_caffeine =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">7</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sleep_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> caffeine </th>
   <th style="text-align:right;"> no_caffeine </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>The effect of caffeine on sleep can be captured by a paired-samples t-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_df<span class="sc">$</span>caffeine, sleep_df<span class="sc">$</span>no_caffeine, <span class="at">paired =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  sleep_df$caffeine and sleep_df$no_caffeine
t = -3.1623, df = 5, p-value = 0.02503
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -1.2085929 -0.1247404
sample estimates:
mean difference 
     -0.6666667 </code></pre>
</div>
</div>
<p>So far, so significant, with the there being more sleep in the no caffeine 6.8333333 than caffeine 6.1666667 condition. Whilst it might not be seen as <strong><em>necessary</em></strong> to double check this conclusion with permutation analysis, it can be a useful conceptual replication of the analysis (and is less sensitive to any problems with the assumptions of a normal distribution).</p>
<p>As this is within-subject, we are keeping the permutations <strong>within each subject</strong>. This means that we can swap the amount of sleep for caffeine vs.&nbsp;no-caffeine for each participant, but not between participants. As there are 2 levels for each participant, and 6 participants, we know that there are <span class="math inline">\(2^6 = 64\)</span> permutations possible. Let’s first try to capture all the permutations and then look at a couple of them to visualise what a permutation means.</p>
<p>To capture all the permutations, we will identify for each participant whether the first column of their data (currently “caffeine”) will be allocated to “caffeine” or “no caffeine” for the permutation. By definition, the second column will then be allocated to the opposite condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># each row is a permutation, each column is a participant. The outcome is whether the original "caffeine" response will be treated as "caffeine" in the permutation</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>caffeine_perms  <span class="ot">=</span> RcppAlgos<span class="sc">::</span><span class="fu">permuteGeneral</span>(<span class="fu">c</span>(<span class="st">"caffeine"</span>,<span class="st">"no caffeine"</span>),<span class="dv">6</span>,<span class="at">repetition =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first permutation doesn’t change the original data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>caffeine_perms[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "caffeine" "caffeine" "caffeine" "caffeine" "caffeine" "caffeine"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sleep_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> caffeine </th>
   <th style="text-align:right;"> no_caffeine </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 7 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>But the second permutation swaps the caffeine and no caffeine data for one participant (participant 6):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>caffeine_perms[<span class="dv">2</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "caffeine"    "caffeine"    "caffeine"    "caffeine"    "caffeine"   
[6] "no caffeine"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sleep_df_perm <span class="ot">=</span> sleep_df</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>sleep_df_perm<span class="sc">$</span>caffeine[<span class="dv">6</span>]    <span class="ot">=</span> sleep_df<span class="sc">$</span>no_caffeine[<span class="dv">6</span>]</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>sleep_df_perm<span class="sc">$</span>no_caffeine[<span class="dv">6</span>] <span class="ot">=</span> sleep_df<span class="sc">$</span>caffeine[<span class="dv">6</span>]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sleep_df_perm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> caffeine </th>
   <th style="text-align:right;"> no_caffeine </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Note how the last row’s values swapped in the second permutation compared to the first.</p>
<p>Now let’s actually calculate the t-values for all the permutations to see whether the original t-value was unlikely to happen by chance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preparing vector to store the paired t-test outputs (note that the matrix is 1 row per permutation rather than 1 per column)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>paired_perms <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(caffeine_perms)[<span class="dv">1</span>])</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through all permutations </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(paired_perms)){</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  this_perm <span class="ot">=</span> caffeine_perms[i,]</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  sleep_df_perm <span class="ot">=</span> sleep_df</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(this_perm[j] <span class="sc">==</span> <span class="st">"no caffeine"</span>){</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>      sleep_df_perm<span class="sc">$</span>caffeine[j]    <span class="ot">=</span> sleep_df<span class="sc">$</span>no_caffeine[j]</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      sleep_df_perm<span class="sc">$</span>no_caffeine[j] <span class="ot">=</span> sleep_df<span class="sc">$</span>caffeine[j]</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  paired_perms[i] <span class="ot">=</span> <span class="fu">t.test</span>(sleep_df_perm<span class="sc">$</span>caffeine, sleep_df_perm<span class="sc">$</span>no_caffeine, <span class="at">paired =</span> T)<span class="sc">$</span>statistic</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># order the means from each permutation from most negative to most positive (commented out as it's not very visibly accessible at this size)</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(paired_perms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -3.162278 -3.162278 -3.162278 -3.162278 -1.000000 -1.000000 -1.000000
 [8] -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000
[15] -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000  0.000000
[22]  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
[29]  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
[36]  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
[43]  0.000000  0.000000  1.000000  1.000000  1.000000  1.000000  1.000000
[50]  1.000000  1.000000  1.000000  1.000000  1.000000  1.000000  1.000000
[57]  1.000000  1.000000  1.000000  1.000000  3.162278  3.162278  3.162278
[64]  3.162278</code></pre>
</div>
</div>
<p>So now let’s calculate the one-tailed likelihood of getting a t-value of -3.16 or less (as -3.16 was the t-value from the original t-test)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(paired_perms <span class="sc">&lt;=</span> <span class="fu">t.test</span>(sleep_df<span class="sc">$</span>caffeine, sleep_df<span class="sc">$</span>no_caffeine, <span class="at">paired =</span> T)<span class="sc">$</span>statistic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0625</code></pre>
</div>
</div>
<p>Not as significant as the original t-test (p = .025). Let’s see what the p-value is for a 2-tailed hypothesis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note that we now are looking at greater than as all values are absolute</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(paired_perms) <span class="sc">&gt;=</span> <span class="fu">abs</span>(<span class="fu">t.test</span>(sleep_df<span class="sc">$</span>caffeine, sleep_df<span class="sc">$</span>no_caffeine, <span class="at">paired =</span> T)<span class="sc">$</span>statistic))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.125</code></pre>
</div>
</div>
<p>Unsurprisingly, the p-value doubled (as distributions are symmetric when you are able to complete all possible permutations, but almost never when using Monte Carlo simulations).</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Optional - why not swap between participants?
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you were to swap between participants you would be creating a distribution that includes between-participant variance, and so your permutation analysis would be on more noisy data because variance between participants isn’t relevant.</p>
</div>
</div>
</section>
</section>
<section id="consolidation-questions" class="level1">
<h1>Consolidation Questions</h1>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<p>Permutation analysis can only be used on non-parametric data</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb74" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>viewof permutatations_1_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'True'</span><span class="op">,</span><span class="st">'False'</span>])<span class="op">;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>correct_permutatations_1 <span class="op">=</span> <span class="st">'False'</span><span class="op">;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>permutatations_1_result <span class="op">=</span> {</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(permutatations_1_response <span class="op">==</span> correct_permutatations_1){</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct! Whilst it is useful for analysis of non-parametric data, it is not restricted to use in these contexts. It would be valid to double check the conclusion of your parametric analysis, or for alternative analyses such compare how significant the difference is between two correlations.'</span><span class="op">;</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><strong><span><span id="ojs-element-id-1"></span></span></strong></p>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<p>Permutation analysis can only be done when comparing 2 groups?</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb75" data-startfrom="1" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>viewof permutatations_2_response <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">'True'</span><span class="op">,</span><span class="st">'False'</span>])<span class="op">;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>correct_permutatations_2 <span class="op">=</span> <span class="st">'False'</span><span class="op">;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>permutatations_2_result <span class="op">=</span> {</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(permutatations_2_response <span class="op">==</span> correct_permutatations_2){</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Correct! It can be used on any analysis that generates a single output value (even if that single output value is a combination of other values). F-values from ANOVAs are an example of how you can compare between more than 2 groups. You can also compare between conditions within participants, but you would need to be mindful that you only permute swaps within participants for within-subject factors.'</span><span class="op">;</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Incorrect or incomplete.'</span><span class="op">;</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p><strong><span><span id="ojs-element-id-2"></span></span></strong></p>


<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${permutatations_1_result}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${permutatations_2_result}</span>`", "cellName":"ojs-element-id-2"}
]}
</script>
</section>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof permutatations_1_response = Inputs.radio(['True','False']);\ncorrect_permutatations_1 = 'False';\npermutatations_1_result = {\n  if(permutatations_1_response == correct_permutatations_1){\n    return 'Correct! Whilst it is useful for analysis of non-parametric data, it is not restricted to use in these contexts. It would be valid to double check the conclusion of your parametric analysis, or for alternative analyses such compare how significant the difference is between two correlations.';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"viewof permutatations_2_response = Inputs.radio(['True','False']);\ncorrect_permutatations_2 = 'False';\npermutatations_2_result = {\n  if(permutatations_2_response == correct_permutatations_2){\n    return 'Correct! It can be used on any analysis that generates a single output value (even if that single output value is a combination of other values). F-values from ANOVAs are an example of how you can compare between more than 2 groups. You can also compare between conditions within participants, but you would need to be mindful that you only permute swaps within participants for within-subject factors.';\n  } else {\n    return 'Incorrect or incomplete.';\n  };\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('permutatations_1_response')"},{"methodName":"interpretQuiet","source":"shinyInput('permutatations_2_response')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../permutations";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>